Initial state
Game 1 is
      ((
        foreach i <= N do
        Osetup() :=
        let (the_sk: skey_t, the_pk: pkey_t) = (s <-R keypairseed_t; (skgen(s), pkgen(s))) in
        return(the_pk);
        ((
          foreach iae <= Qeperuser do
          Oaenc(pk_2: pkey_t, m: bitstring, aad_8: bitstring, info_5: bitstring) :=
          let SealAuth_Some(enc_6: kemciph_t, ct_10: bitstring) = (let SetupAuthS_Some(enc_5: kemciph_t, ctx_7: context_t) = (let AuthEncap_tuple(shared_secret_3: kemkey_t, enc_4: kemciph_t) = (pk_1: pkey_t <- pk_2; sk: skey_t <- the_sk; k <-R kemseed_t; AuthEncap_r(k, pk_1, sk)) in let KeySchedule_Some(ctx_6: context_t) = (let concat(key_6: key_t, nonce_6: nonce_t) = (r_3: keys_t <- KeySchedule_auth(shared_secret_3, info_5); concat(get1(r_3), get2(r_3))) in KeySchedule_Some(Context(key_6, nonce_6, nonce_zero)) else KeySchedule_None) in SetupAuthS_Some(enc_4, ctx_6) else SetupAuthS_None else SetupAuthS_None) in let Context_Seal_Some(ct_9: bitstring) = (let Context(key_7: key_t, nonce_7: nonce_t, seq_3: nonce_t) = ctx_7 in ct_8: bitstring <- (nonce_8: nonce_t <- xor(nonce_7, seq_3); Seal_inner(m, aad_8, key_7, nonce_8)); Context_Seal_Some(ct_8) else Context_Seal_None) in SealAuth_Some(enc_5, ct_9) else SealAuth_None else SealAuth_None) in
            insert E(the_pk, pk_2, enc_6, ct_10, aad_8, info_5);
            return(SealAuth_Some(enc_6, ct_10))
          else
            return(SealAuth_None)
        ) | (
          foreach iad <= Qdperuser do
          Oadec(pk_3: pkey_t, enc_7: kemciph_t, c: bitstring, aad_9: bitstring, info_6: bitstring) :=
          return((let SetupAuthR_Some(ctx_9: context_t) = (let AuthDecap_Some(shared_secret_4: kemkey_t) = AuthDecap(enc_7, the_sk, pk_3) in let KeySchedule_Some(ctx_8: context_t) = (let concat(key_8: key_t, nonce_9: nonce_t) = (r_4: keys_t <- KeySchedule_auth(shared_secret_4, info_6); concat(get1(r_4), get2(r_4))) in KeySchedule_Some(Context(key_8, nonce_9, nonce_zero)) else KeySchedule_None) in SetupAuthR_Some(ctx_8) else SetupAuthR_None else SetupAuthR_None) in OpenAuth_Some((let Context(key_9: key_t, nonce_10: nonce_t, seq_4: nonce_t) = ctx_9 in let injbot(pt_6: bitstring) = (nonce_11: nonce_t <- xor(nonce_10, seq_4); Open_inner(c, aad_9, key_9, nonce_11)) in Context_Open_Some(pt_6) else Context_Open_None else Context_Open_None)) else OpenAuth_None))
        ))
      ) | (
        Ochall(pk_S: pkey_t, pk_R: pkey_t, enc_star: kemciph_t, ciph_star: bitstring, aad_star: bitstring, info_star: bitstring) :=
        find i'_1 = i' <= N, i''_1 = i'' <= N suchthat defined(the_pk[i'], the_pk[i''], the_sk[i'], the_sk[i'']) && (the_pk[i'] = pk_S) && (the_pk[i''] = pk_R) then
          get E(=pk_S, =pk_R, =enc_star, =ciph_star, =aad_star, =info_star) in
            return(bottom)
          else
            let OpenAuth_Some(Context_Open_Some(pt_8: bitstring)) = (skR_2: skey_t <- the_sk[i''_1]; let SetupAuthR_Some(ctx_11: context_t) = (let AuthDecap_Some(shared_secret_5: kemkey_t) = AuthDecap(enc_star, skR_2, pk_S) in let KeySchedule_Some(ctx_10: context_t) = (let concat(key_10: key_t, nonce_12: nonce_t) = (r_5: keys_t <- KeySchedule_auth(shared_secret_5, info_star); concat(get1(r_5), get2(r_5))) in KeySchedule_Some(Context(key_10, nonce_12, nonce_zero)) else KeySchedule_None) in SetupAuthR_Some(ctx_10) else SetupAuthR_None else SetupAuthR_None) in OpenAuth_Some((let Context(key_11: key_t, nonce_13: nonce_t, seq_5: nonce_t) = ctx_11 in let injbot(pt_7: bitstring) = (nonce_14: nonce_t <- xor(nonce_13, seq_5); Open_inner(ciph_star, aad_star, key_11, nonce_14)) in Context_Open_Some(pt_7) else Context_Open_None else Context_Open_None)) else OpenAuth_None) in
              event_abort adv_wins
            else
              return(bottom)
        else
          return(bottom)
      ))


Applying expand get, insert and prove unique annotations
  - Expand get/insert for table E
yields

Game 2 is
      ((
        foreach i <= N do
        Osetup() :=
   {5}  let (the_sk: skey_t, the_pk: pkey_t) = (s <-R keypairseed_t; (skgen(s), pkgen(s))) in
        return(the_pk);
        ((
          foreach iae <= Qeperuser do
          Oaenc(pk_2: pkey_t, m: bitstring, aad_8: bitstring, info_5: bitstring) :=
  {23}    let SealAuth_Some(enc_6: kemciph_t, ct_10: bitstring) = {24}(let SetupAuthS_Some(enc_5: kemciph_t, ctx_7: context_t) = (let AuthEncap_tuple(shared_secret_3: kemkey_t, enc_4: kemciph_t) = (pk_1: pkey_t <- pk_2; sk: skey_t <- the_sk; k <-R kemseed_t; AuthEncap_r(k, pk_1, sk)) in {44}let KeySchedule_Some(ctx_6: context_t) = {45}(let concat(key_6: key_t, nonce_6: nonce_t) = (r_3: keys_t <- KeySchedule_auth(shared_secret_3, info_5); concat(get1(r_3), get2(r_3))) in KeySchedule_Some(Context(key_6, nonce_6, nonce_zero)) else KeySchedule_None) in SetupAuthS_Some(enc_4, ctx_6) else SetupAuthS_None else SetupAuthS_None) in {82}let Context_Seal_Some(ct_9: bitstring) = {83}(let Context(key_7: key_t, nonce_7: nonce_t, seq_3: nonce_t) = ctx_7 in ct_8: bitstring <- (nonce_8: nonce_t <- xor(nonce_7, seq_3); Seal_inner(m, aad_8, key_7, nonce_8)); Context_Seal_Some(ct_8) else Context_Seal_None) in SealAuth_Some(enc_5, ct_9) else SealAuth_None else SealAuth_None) in
            E_1: pkey_t <- the_pk;
            E_2: pkey_t <- pk_2;
            E_3: kemciph_t <- enc_6;
            E_4: bitstring <- ct_10;
            E_5: bitstring <- aad_8;
            E_6: bitstring <- info_5;
            return(SealAuth_Some(enc_6, ct_10))
          else
            return(SealAuth_None)
        ) | (
          foreach iad <= Qdperuser do
          Oadec(pk_3: pkey_t, enc_7: kemciph_t, c: bitstring, aad_9: bitstring, info_6: bitstring) :=
          return({172}(let SetupAuthR_Some(ctx_9: context_t) = (let AuthDecap_Some(shared_secret_4: kemkey_t) = AuthDecap(enc_7, the_sk, pk_3) in {183}let KeySchedule_Some(ctx_8: context_t) = {184}(let concat(key_8: key_t, nonce_9: nonce_t) = (r_4: keys_t <- KeySchedule_auth(shared_secret_4, info_6); concat(get1(r_4), get2(r_4))) in KeySchedule_Some(Context(key_8, nonce_9, nonce_zero)) else KeySchedule_None) in SetupAuthR_Some(ctx_8) else SetupAuthR_None else SetupAuthR_None) in OpenAuth_Some({219}(let Context(key_9: key_t, nonce_10: nonce_t, seq_4: nonce_t) = ctx_9 in let injbot(pt_6: bitstring) = (nonce_11: nonce_t <- xor(nonce_10, seq_4); Open_inner(c, aad_9, key_9, nonce_11)) in Context_Open_Some(pt_6) else Context_Open_None else Context_Open_None)) else OpenAuth_None))
        ))
      ) | (
        Ochall(pk_S: pkey_t, pk_R: pkey_t, enc_star: kemciph_t, ciph_star: bitstring, aad_star: bitstring, info_star: bitstring) :=
 {255}  find i'_1 = i' <= N, i''_1 = i'' <= N suchthat defined(the_pk[i'], the_pk[i''], the_sk[i'], the_sk[i'']) && (the_pk[i'] = pk_S) && (the_pk[i''] = pk_R) then
          find u = u_2 <= Qeperuser, u_1 = u_3 <= N suchthat defined(E_1[u_2, u_3], E_2[u_2, u_3], E_3[u_2, u_3], E_4[u_2, u_3], E_5[u_2, u_3], E_6[u_2, u_3]) && (E_1[u_2, u_3] = pk_S) && (E_2[u_2, u_3] = pk_R) && (E_3[u_2, u_3] = enc_star) && (E_4[u_2, u_3] = ciph_star) && (E_5[u_2, u_3] = aad_star) && (E_6[u_2, u_3] = info_star) then
            return(bottom)
          else
 {321}      let OpenAuth_Some(Context_Open_Some(pt_8: bitstring)) = (skR_2: skey_t <- the_sk[i''_1]; {325}let SetupAuthR_Some(ctx_11: context_t) = (let AuthDecap_Some(shared_secret_5: kemkey_t) = AuthDecap(enc_star, skR_2, pk_S) in {331}let KeySchedule_Some(ctx_10: context_t) = {332}(let concat(key_10: key_t, nonce_12: nonce_t) = (r_5: keys_t <- KeySchedule_auth(shared_secret_5, info_star); concat(get1(r_5), get2(r_5))) in KeySchedule_Some(Context(key_10, nonce_12, nonce_zero)) else KeySchedule_None) in SetupAuthR_Some(ctx_10) else SetupAuthR_None else SetupAuthR_None) in OpenAuth_Some({353}(let Context(key_11: key_t, nonce_13: nonce_t, seq_5: nonce_t) = ctx_11 in let injbot(pt_7: bitstring) = (nonce_14: nonce_t <- xor(nonce_13, seq_5); Open_inner(ciph_star, aad_star, key_11, nonce_14)) in Context_Open_Some(pt_7) else Context_Open_None else Context_Open_None)) else OpenAuth_None) in
              event_abort adv_wins
            else
              return(bottom)
        else
          return(bottom)
      ))


Applying expand
  - Expand if/find/let
    - Remove let at 321
    - Remove let at 325
    - Remove let at 321
    - Simplify pattern concat(key_10: key_t, nonce_12: nonce_t) (tuple expanded) at 332
    - Remove else branch of let at 332
    - Simplify pattern KeySchedule_Some(ctx_10: context_t) (tuple expanded) at 331
    - Remove else branch of let at 331
    - Simplify pattern SetupAuthR_Some(ctx_11: context_t) (tuple expanded) at 325
    - Remove else branch of let at 325
    - Simplify pattern Context(key_11: key_t, nonce_13: nonce_t, seq_5: nonce_t) (tuple expanded) at 353
    - Remove else branch of let at 353
    - Simplify pattern OpenAuth_Some(Context_Open_Some(pt_8: bitstring)) (tuple expanded) at 321
    - Remove let at 321
    - Simplify pattern Context_Open_Some(pt_8: bitstring) (tuple expanded), pattern OpenAuth_Some(Context_Open_Some(pt_8: bitstring)) (tuple expanded) at 321
    - Remove else branch of let at 321
    - Replaced defined condition the_pk[i'], the_pk[i''], the_sk[i'], the_sk[i''] with the_sk[i''], the_pk[i''], the_pk[i'] in find at 255
    - Simplify pattern (the_sk: skey_t, the_pk: pkey_t) (tuple expanded) at 5
    - Remove let at 172
    - Simplify pattern concat(key_8: key_t, nonce_9: nonce_t) (tuple expanded) at 184
    - Remove else branch of let at 184
    - Simplify pattern KeySchedule_Some(ctx_8: context_t) (tuple expanded) at 183
    - Remove else branch of let at 183
    - Simplify pattern SetupAuthR_Some(ctx_9: context_t) (tuple expanded) at 172
    - Remove else branch of let at 172
    - Simplify pattern Context(key_9: key_t, nonce_10: nonce_t, seq_4: nonce_t) (tuple expanded) at 219
    - Remove else branch of let at 219
    - Remove let at 23
    - Remove let at 24
    - Remove let at 23
    - Simplify pattern concat(key_6: key_t, nonce_6: nonce_t) (tuple expanded) at 45
    - Remove else branch of let at 45
    - Simplify pattern KeySchedule_Some(ctx_6: context_t) (tuple expanded) at 44
    - Remove else branch of let at 44
    - Simplify pattern SetupAuthS_Some(enc_5: kemciph_t, ctx_7: context_t) (tuple expanded) at 24
    - Remove else branch of let at 24
    - Simplify pattern Context(key_7: key_t, nonce_7: nonce_t, seq_3: nonce_t) (tuple expanded) at 83
    - Remove else branch of let at 83
    - Simplify pattern Context_Seal_Some(ct_9: bitstring) (tuple expanded) at 82
    - Remove else branch of let at 82
    - Simplify pattern SealAuth_Some(enc_6: kemciph_t, ct_10: bitstring) (tuple expanded) at 23
    - Remove else branch of let at 23
yields

Game 3 is
      ((
        foreach i <= N do
        Osetup() :=
        s <-R keypairseed_t;
        the_pk: pkey_t <- pkgen(s);
        the_sk: skey_t <- skgen(s);
        return(the_pk);
        ((
          foreach iae <= Qeperuser do
          Oaenc(pk_2: pkey_t, m: bitstring, aad_8: bitstring, info_5: bitstring) :=
          pk_1: pkey_t <- pk_2;
          sk: skey_t <- the_sk;
          k <-R kemseed_t;
          let AuthEncap_tuple(shared_secret_3: kemkey_t, enc_4: kemciph_t) = AuthEncap_r(k, pk_1, sk) in
            r_3: keys_t <- KeySchedule_auth(shared_secret_3, info_5);
            nonce_6: nonce_t <- get2(r_3);
            key_6: key_t <- get1(r_3);
            ctx_6: context_t <- Context(key_6, nonce_6, nonce_zero);
            ctx_7: context_t <- ctx_6;
            enc_5: kemciph_t <- enc_4;
            seq_3: nonce_t <- nonce_zero;
            nonce_7: nonce_t <- nonce_6;
            key_7: key_t <- key_6;
            nonce_8: nonce_t <- xor(nonce_7, seq_3);
            ct_8: bitstring <- Seal_inner(m, aad_8, key_7, nonce_8);
            ct_9: bitstring <- ct_8;
            ct_10: bitstring <- ct_9;
            enc_6: kemciph_t <- enc_5;
            E_1: pkey_t <- the_pk;
            E_2: pkey_t <- pk_2;
            E_3: kemciph_t <- enc_6;
            E_4: bitstring <- ct_10;
            E_5: bitstring <- aad_8;
            E_6: bitstring <- info_5;
            return(SealAuth_Some(enc_6, ct_10))
          else
            return(SealAuth_None)
        ) | (
          foreach iad <= Qdperuser do
          Oadec(pk_3: pkey_t, enc_7: kemciph_t, c: bitstring, aad_9: bitstring, info_6: bitstring) :=
          let AuthDecap_Some(shared_secret_4: kemkey_t) = AuthDecap(enc_7, the_sk, pk_3) in
            r_4: keys_t <- KeySchedule_auth(shared_secret_4, info_6);
            nonce_9: nonce_t <- get2(r_4);
            key_8: key_t <- get1(r_4);
            ctx_8: context_t <- Context(key_8, nonce_9, nonce_zero);
            ctx_9: context_t <- ctx_8;
            seq_4: nonce_t <- nonce_zero;
            nonce_10: nonce_t <- nonce_9;
            key_9: key_t <- key_8;
            nonce_11: nonce_t <- xor(nonce_10, seq_4);
            let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_9, nonce_11) in
              return(OpenAuth_Some(Context_Open_Some(pt_6)))
            else
              return(OpenAuth_Some(Context_Open_None))
          else
            return(OpenAuth_None)
        ))
      ) | (
        Ochall(pk_S: pkey_t, pk_R: pkey_t, enc_star: kemciph_t, ciph_star: bitstring, aad_star: bitstring, info_star: bitstring) :=
        find i'_1 = i' <= N, i''_1 = i'' <= N suchthat defined(the_sk[i''], the_pk[i''], the_pk[i']) && (the_pk[i'] = pk_S) && (the_pk[i''] = pk_R) then
          find u = u_2 <= Qeperuser, u_1 = u_3 <= N suchthat defined(E_1[u_2, u_3], E_2[u_2, u_3], E_3[u_2, u_3], E_4[u_2, u_3], E_5[u_2, u_3], E_6[u_2, u_3]) && (E_1[u_2, u_3] = pk_S) && (E_2[u_2, u_3] = pk_R) && (E_3[u_2, u_3] = enc_star) && (E_4[u_2, u_3] = ciph_star) && (E_5[u_2, u_3] = aad_star) && (E_6[u_2, u_3] = info_star) then
            return(bottom)
          else
            skR_2: skey_t <- the_sk[i''_1];
            let AuthDecap_Some(shared_secret_5: kemkey_t) = AuthDecap(enc_star, skR_2, pk_S) in
              r_5: keys_t <- KeySchedule_auth(shared_secret_5, info_star);
              nonce_12: nonce_t <- get2(r_5);
              key_10: key_t <- get1(r_5);
              ctx_10: context_t <- Context(key_10, nonce_12, nonce_zero);
              ctx_11: context_t <- ctx_10;
              seq_5: nonce_t <- nonce_zero;
              nonce_13: nonce_t <- nonce_12;
              key_11: key_t <- key_10;
              nonce_14: nonce_t <- xor(nonce_13, seq_5);
              let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_11, nonce_14) in
                pt_8: bitstring <- pt_7;
                event_abort adv_wins
              else
                return(bottom)
            else
              return(bottom)
        else
          return(bottom)
      ))


Applying remove assignments of findcond
  - Remove assignments on skR_2 (definition removed, all usages removed)
  - Remove assignments on ctx_11 (definition removed, all usages removed)
  - Remove assignments on nonce_13 (definition removed, all usages removed)
  - Remove assignments on key_11 (definition removed, all usages removed)
  - Remove assignments on pt_8 (definition removed, all usages removed)
  - Remove assignments on ctx_9 (definition removed, all usages removed)
  - Remove assignments on nonce_10 (definition removed, all usages removed)
  - Remove assignments on key_9 (definition removed, all usages removed)
  - Remove assignments on pk_1 (definition removed, all usages removed)
  - Remove assignments on sk (definition removed, all usages removed)
  - Remove assignments on ctx_7 (definition removed, all usages removed)
  - Remove assignments on enc_5 (definition removed, all usages removed)
  - Remove assignments on nonce_7 (definition removed, all usages removed)
  - Remove assignments on key_7 (definition removed, all usages removed)
  - Remove assignments on ct_9 (definition removed, all usages removed)
  - Remove assignments on ct_10 (definition removed, all usages removed)
  - Remove assignments on enc_6 (definition removed, all usages removed)
  - Remove assignments on E_1 (definition removed, all usages removed)
  - Remove assignments on E_2 (definition removed, all usages removed)
  - Remove assignments on E_3 (definition removed, all usages removed)
  - Remove assignments on E_4 (definition removed, all usages removed)
  - Remove assignments on E_5 (definition removed, all usages removed)
  - Remove assignments on E_6 (definition removed, all usages removed)
  - Remove assignments on ctx_10 (definition removed, all usages removed)
  - Remove assignments on ctx_8 (definition removed, all usages removed)
  - Remove assignments on ctx_6 (definition removed, all usages removed)
yields

Game 4 is
      ((
        foreach i <= N do
        Osetup() :=
        s <-R keypairseed_t;
        the_pk: pkey_t <- pkgen(s);
        the_sk: skey_t <- skgen(s);
        return(the_pk);
        ((
          foreach iae <= Qeperuser do
          Oaenc(pk_2: pkey_t, m: bitstring, aad_8: bitstring, info_5: bitstring) :=
          k <-R kemseed_t;
          let AuthEncap_tuple(shared_secret_3: kemkey_t, enc_4: kemciph_t) = AuthEncap_r(k, pk_2, the_sk) in
            r_3: keys_t <- KeySchedule_auth(shared_secret_3, info_5);
            nonce_6: nonce_t <- get2(r_3);
            key_6: key_t <- get1(r_3);
            seq_3: nonce_t <- nonce_zero;
            nonce_8: nonce_t <- {55}xor(nonce_6, seq_3);
            ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_8);
            return(SealAuth_Some(enc_4, ct_8))
          else
            return(SealAuth_None)
        ) | (
          foreach iad <= Qdperuser do
          Oadec(pk_3: pkey_t, enc_7: kemciph_t, c: bitstring, aad_9: bitstring, info_6: bitstring) :=
          let AuthDecap_Some(shared_secret_4: kemkey_t) = AuthDecap(enc_7, the_sk, pk_3) in
            r_4: keys_t <- KeySchedule_auth(shared_secret_4, info_6);
            nonce_9: nonce_t <- get2(r_4);
            key_8: key_t <- get1(r_4);
            seq_4: nonce_t <- nonce_zero;
            nonce_11: nonce_t <- {131}xor(nonce_9, seq_4);
            let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_11) in
              return(OpenAuth_Some(Context_Open_Some(pt_6)))
            else
              return(OpenAuth_Some(Context_Open_None))
          else
            return(OpenAuth_None)
        ))
      ) | (
        Ochall(pk_S: pkey_t, pk_R: pkey_t, enc_star: kemciph_t, ciph_star: bitstring, aad_star: bitstring, info_star: bitstring) :=
        find i'_1 = i' <= N, i''_1 = i'' <= N suchthat defined(the_sk[i''], the_pk[i''], the_pk[i']) && (the_pk[i'] = pk_S) && (the_pk[i''] = pk_R) then
 {190}    find u = u_2 <= Qeperuser, u_1 = u_3 <= N suchthat defined(the_pk[u_3], pk_2[u_2, u_3], enc_4[u_2, u_3], aad_8[u_2, u_3], info_5[u_2, u_3], ct_8[u_2, u_3]) && {202}((the_pk[u_3] = pk_S) && (pk_2[u_2, u_3] = pk_R) && (enc_4[u_2, u_3] = enc_star) && (ct_8[u_2, u_3] = ciph_star) && (aad_8[u_2, u_3] = aad_star) && (info_5[u_2, u_3] = info_star)) then
            return(bottom)
          else
            let AuthDecap_Some(shared_secret_5: kemkey_t) = AuthDecap(enc_star, the_sk[i''_1], pk_S) in
              r_5: keys_t <- KeySchedule_auth(shared_secret_5, info_star);
              nonce_12: nonce_t <- get2(r_5);
              key_10: key_t <- get1(r_5);
              seq_5: nonce_t <- nonce_zero;
              nonce_14: nonce_t <- {259}xor(nonce_12, seq_5);
              let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_14) in
                event_abort adv_wins
              else
                return(bottom)
            else
              return(bottom)
        else
          return(bottom)
      ))


Applying simplify [probability N^2 * P_pk_coll]
  - Simplification pass
    - Replaced xor(nonce_12, seq_5) with nonce_12 at 259
    - Replaced ((the_pk[u_3] = pk_S) && (pk_2[u_2, u_3] = pk_R) && (enc_4[u_2, u_3] = enc_star) && (ct_8[u_2, u_3] = ciph_star) && (aad_8[u_2, u_3] = aad_star) && (info_5[u_2, u_3] = info_star)) with ((u_3 = i'_1) && (pk_2[u_2, u_3] = pk_R) && (enc_4[u_2, u_3] = enc_star) && (ct_8[u_2, u_3] = ciph_star) && (aad_8[u_2, u_3] = aad_star) && (info_5[u_2, u_3] = info_star)) at 202
    - In branch 1 of find at 190, substituting u_1 with i'_1
    - Replaced defined condition the_pk[u_3], pk_2[u_2, u_3], enc_4[u_2, u_3], aad_8[u_2, u_3], info_5[u_2, u_3], ct_8[u_2, u_3] with info_5[u_2, i'_1], aad_8[u_2, i'_1], ct_8[u_2, i'_1], enc_4[u_2, i'_1], pk_2[u_2, i'_1] in find at 190
    - Replaced xor(nonce_9, seq_4) with nonce_9 at 131
    - Replaced xor(nonce_6, seq_3) with nonce_6 at 55
yields

Game 5 is
      ((
        foreach i <= N do
        Osetup() :=
        s <-R keypairseed_t;
        the_pk: pkey_t <- pkgen(s);
        the_sk: skey_t <- skgen(s);
        return(the_pk);
        ((
          foreach iae <= Qeperuser do
          Oaenc(pk_2: pkey_t, m: bitstring, aad_8: bitstring, info_5: bitstring) :=
          k <-R kemseed_t;
          let AuthEncap_tuple(shared_secret_3: kemkey_t, enc_4: kemciph_t) = AuthEncap_r(k, pk_2, the_sk) in
            r_3: keys_t <- KeySchedule_auth(shared_secret_3, info_5);
            nonce_6: nonce_t <- get2(r_3);
            key_6: key_t <- get1(r_3);
            seq_3: nonce_t <- nonce_zero;
            nonce_8: nonce_t <- nonce_6;
            ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_8);
            return(SealAuth_Some(enc_4, ct_8))
          else
            return(SealAuth_None)
        ) | (
          foreach iad <= Qdperuser do
          Oadec(pk_3: pkey_t, enc_7: kemciph_t, c: bitstring, aad_9: bitstring, info_6: bitstring) :=
          let AuthDecap_Some(shared_secret_4: kemkey_t) = AuthDecap(enc_7, the_sk, pk_3) in
            r_4: keys_t <- KeySchedule_auth(shared_secret_4, info_6);
            nonce_9: nonce_t <- get2(r_4);
            key_8: key_t <- get1(r_4);
            seq_4: nonce_t <- nonce_zero;
            nonce_11: nonce_t <- nonce_9;
            let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_11) in
              return(OpenAuth_Some(Context_Open_Some(pt_6)))
            else
              return(OpenAuth_Some(Context_Open_None))
          else
            return(OpenAuth_None)
        ))
      ) | (
        Ochall(pk_S: pkey_t, pk_R: pkey_t, enc_star: kemciph_t, ciph_star: bitstring, aad_star: bitstring, info_star: bitstring) :=
        find i'_1 = i' <= N, i''_1 = i'' <= N suchthat defined(the_sk[i''], the_pk[i''], the_pk[i']) && (the_pk[i'] = pk_S) && (the_pk[i''] = pk_R) then
          find u = u_2 <= Qeperuser suchthat defined(info_5[u_2, i'_1], aad_8[u_2, i'_1], ct_8[u_2, i'_1], enc_4[u_2, i'_1], pk_2[u_2, i'_1]) && {193}((i'_1 = i'_1) && (pk_2[u_2, i'_1] = pk_R) && (enc_4[u_2, i'_1] = enc_star) && (ct_8[u_2, i'_1] = ciph_star) && (aad_8[u_2, i'_1] = aad_star) && (info_5[u_2, i'_1] = info_star)) then
            u_1 <= N <- i'_1;
            return(bottom)
          else
            let AuthDecap_Some(shared_secret_5: kemkey_t) = AuthDecap(enc_star, the_sk[i''_1], pk_S) in
              r_5: keys_t <- KeySchedule_auth(shared_secret_5, info_star);
              nonce_12: nonce_t <- get2(r_5);
              key_10: key_t <- get1(r_5);
              seq_5: nonce_t <- nonce_zero;
              nonce_14: nonce_t <- nonce_12;
              let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_14) in
                event_abort adv_wins
              else
                return(bottom)
            else
              return(bottom)
        else
          return(bottom)
      ))


Applying simplify
  - Simplification pass
    - Replaced ((i'_1 = i'_1) && (pk_2[u_2, i'_1] = pk_R) && (enc_4[u_2, i'_1] = enc_star) && (ct_8[u_2, i'_1] = ciph_star) && (aad_8[u_2, i'_1] = aad_star) && (info_5[u_2, i'_1] = info_star)) with ((pk_2[u_2, i'_1] = pk_R) && (enc_4[u_2, i'_1] = enc_star) && (ct_8[u_2, i'_1] = ciph_star) && (aad_8[u_2, i'_1] = aad_star) && (info_5[u_2, i'_1] = info_star)) at 193
yields

Game 6 is
      ((
        foreach i <= N do
        Osetup() :=
        s <-R keypairseed_t;
        the_pk: pkey_t <- pkgen(s);
        the_sk: skey_t <- skgen(s);
        return(the_pk);
        ((
          foreach iae <= Qeperuser do
          Oaenc(pk_2: pkey_t, m: bitstring, aad_8: bitstring, info_5: bitstring) :=
          k <-R kemseed_t;
          let AuthEncap_tuple(shared_secret_3: kemkey_t, enc_4: kemciph_t) = AuthEncap_r(k, pk_2, the_sk) in
            r_3: keys_t <- KeySchedule_auth(shared_secret_3, info_5);
            nonce_6: nonce_t <- get2(r_3);
            key_6: key_t <- get1(r_3);
            seq_3: nonce_t <- nonce_zero;
            nonce_8: nonce_t <- nonce_6;
            ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_8);
            return(SealAuth_Some(enc_4, ct_8))
          else
            return(SealAuth_None)
        ) | (
          foreach iad <= Qdperuser do
          Oadec(pk_3: pkey_t, enc_7: kemciph_t, c: bitstring, aad_9: bitstring, info_6: bitstring) :=
          let AuthDecap_Some(shared_secret_4: kemkey_t) = AuthDecap(enc_7, the_sk, pk_3) in
            r_4: keys_t <- KeySchedule_auth(shared_secret_4, info_6);
            nonce_9: nonce_t <- get2(r_4);
            key_8: key_t <- get1(r_4);
            seq_4: nonce_t <- nonce_zero;
            nonce_11: nonce_t <- nonce_9;
            let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_11) in
              return(OpenAuth_Some(Context_Open_Some(pt_6)))
            else
              return(OpenAuth_Some(Context_Open_None))
          else
            return(OpenAuth_None)
        ))
      ) | (
        Ochall(pk_S: pkey_t, pk_R: pkey_t, enc_star: kemciph_t, ciph_star: bitstring, aad_star: bitstring, info_star: bitstring) :=
        find i'_1 = i' <= N, i''_1 = i'' <= N suchthat defined(the_sk[i''], the_pk[i''], the_pk[i']) && (the_pk[i'] = pk_S) && (the_pk[i''] = pk_R) then
          find u = u_2 <= Qeperuser suchthat defined(info_5[u_2, i'_1], aad_8[u_2, i'_1], ct_8[u_2, i'_1], enc_4[u_2, i'_1], pk_2[u_2, i'_1]) && (pk_2[u_2, i'_1] = pk_R) && (enc_4[u_2, i'_1] = enc_star) && (ct_8[u_2, i'_1] = ciph_star) && (aad_8[u_2, i'_1] = aad_star) && (info_5[u_2, i'_1] = info_star) then
            u_1 <= N <- i'_1;
            return(bottom)
          else
            let AuthDecap_Some(shared_secret_5: kemkey_t) = AuthDecap(enc_star, the_sk[i''_1], pk_S) in
              r_5: keys_t <- KeySchedule_auth(shared_secret_5, info_star);
              nonce_12: nonce_t <- get2(r_5);
              key_10: key_t <- get1(r_5);
              seq_5: nonce_t <- nonce_zero;
              nonce_14: nonce_t <- nonce_12;
              let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_14) in
                event_abort adv_wins
              else
                return(bottom)
            else
              return(bottom)
        else
          return(bottom)
      ))


Applying move all binders
  - Move assignment to seq_5
  - Move assignment to seq_4
yields

Game 7 is
      ((
        foreach i <= N do
        Osetup() :=
        s <-R keypairseed_t;
        the_pk: pkey_t <- pkgen(s);
        the_sk: skey_t <- skgen(s);
        return(the_pk);
        ((
          foreach iae <= Qeperuser do
          Oaenc(pk_2: pkey_t, m: bitstring, aad_8: bitstring, info_5: bitstring) :=
          k <-R kemseed_t;
          let AuthEncap_tuple(shared_secret_3: kemkey_t, enc_4: kemciph_t) = AuthEncap_r(k, pk_2, the_sk) in
            r_3: keys_t <- KeySchedule_auth(shared_secret_3, info_5);
            nonce_6: nonce_t <- get2(r_3);
            key_6: key_t <- get1(r_3);
            seq_3: nonce_t <- nonce_zero;
            nonce_8: nonce_t <- nonce_6;
            ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_8);
            return(SealAuth_Some(enc_4, ct_8))
          else
            return(SealAuth_None)
        ) | (
          foreach iad <= Qdperuser do
          Oadec(pk_3: pkey_t, enc_7: kemciph_t, c: bitstring, aad_9: bitstring, info_6: bitstring) :=
          let AuthDecap_Some(shared_secret_4: kemkey_t) = AuthDecap(enc_7, the_sk, pk_3) in
            r_4: keys_t <- KeySchedule_auth(shared_secret_4, info_6);
            nonce_9: nonce_t <- get2(r_4);
            key_8: key_t <- get1(r_4);
            nonce_11: nonce_t <- nonce_9;
            let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_11) in
              return(OpenAuth_Some(Context_Open_Some(pt_6)))
            else
              return(OpenAuth_Some(Context_Open_None))
          else
            return(OpenAuth_None)
        ))
      ) | (
        Ochall(pk_S: pkey_t, pk_R: pkey_t, enc_star: kemciph_t, ciph_star: bitstring, aad_star: bitstring, info_star: bitstring) :=
        find i'_1 = i' <= N, i''_1 = i'' <= N suchthat defined(the_sk[i''], the_pk[i''], the_pk[i']) && (the_pk[i'] = pk_S) && (the_pk[i''] = pk_R) then
          find u = u_2 <= Qeperuser suchthat defined(info_5[u_2, i'_1], aad_8[u_2, i'_1], ct_8[u_2, i'_1], enc_4[u_2, i'_1], pk_2[u_2, i'_1]) && (pk_2[u_2, i'_1] = pk_R) && (enc_4[u_2, i'_1] = enc_star) && (ct_8[u_2, i'_1] = ciph_star) && (aad_8[u_2, i'_1] = aad_star) && (info_5[u_2, i'_1] = info_star) then
            u_1 <= N <- i'_1;
            return(bottom)
          else
            let AuthDecap_Some(shared_secret_5: kemkey_t) = AuthDecap(enc_star, the_sk[i''_1], pk_S) in
              r_5: keys_t <- KeySchedule_auth(shared_secret_5, info_star);
              nonce_12: nonce_t <- get2(r_5);
              key_10: key_t <- get1(r_5);
              nonce_14: nonce_t <- nonce_12;
              let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_14) in
                event_abort adv_wins
              else
                return(bottom)
            else
              return(bottom)
        else
          return(bottom)
      ))


Applying remove assignments of findcond
  - Remove assignments on nonce_14 (definition removed, all usages removed)
  - Remove assignments on u_1 (definition removed, all usages removed)
  - Remove assignments on nonce_11 (definition removed, all usages removed)
  - Remove assignments on seq_3 (definition removed, all usages removed)
  - Remove assignments on nonce_8 (definition removed, all usages removed)
yields

Game 8 is
      ((
        foreach i <= N do
        Osetup() :=
        s <-R keypairseed_t;
        the_pk: pkey_t <- pkgen(s);
        the_sk: skey_t <- skgen(s);
        return(the_pk);
        ((
          foreach iae <= Qeperuser do
          Oaenc(pk_2: pkey_t, m: bitstring, aad_8: bitstring, info_5: bitstring) :=
          k <-R kemseed_t;
          let AuthEncap_tuple(shared_secret_3: kemkey_t, enc_4: kemciph_t) = AuthEncap_r(k, pk_2, the_sk) in
            r_3: keys_t <- KeySchedule_auth(shared_secret_3, info_5);
            nonce_6: nonce_t <- get2(r_3);
            key_6: key_t <- get1(r_3);
            ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
            return(SealAuth_Some(enc_4, ct_8))
          else
            return(SealAuth_None)
        ) | (
          foreach iad <= Qdperuser do
          Oadec(pk_3: pkey_t, enc_7: kemciph_t, c: bitstring, aad_9: bitstring, info_6: bitstring) :=
          let AuthDecap_Some(shared_secret_4: kemkey_t) = AuthDecap(enc_7, the_sk, pk_3) in
            r_4: keys_t <- KeySchedule_auth(shared_secret_4, info_6);
            nonce_9: nonce_t <- get2(r_4);
            key_8: key_t <- get1(r_4);
            let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
              return(OpenAuth_Some(Context_Open_Some(pt_6)))
            else
              return(OpenAuth_Some(Context_Open_None))
          else
            return(OpenAuth_None)
        ))
      ) | (
        Ochall(pk_S: pkey_t, pk_R: pkey_t, enc_star: kemciph_t, ciph_star: bitstring, aad_star: bitstring, info_star: bitstring) :=
        find i'_1 = i' <= N, i''_1 = i'' <= N suchthat defined(the_sk[i''], the_pk[i''], the_pk[i']) && (the_pk[i'] = pk_S) && (the_pk[i''] = pk_R) then
          find u = u_2 <= Qeperuser suchthat defined(info_5[u_2, i'_1], aad_8[u_2, i'_1], ct_8[u_2, i'_1], enc_4[u_2, i'_1], pk_2[u_2, i'_1]) && (pk_2[u_2, i'_1] = pk_R) && (enc_4[u_2, i'_1] = enc_star) && (ct_8[u_2, i'_1] = ciph_star) && (aad_8[u_2, i'_1] = aad_star) && (info_5[u_2, i'_1] = info_star) then
            return(bottom)
          else
            let AuthDecap_Some(shared_secret_5: kemkey_t) = AuthDecap(enc_star, the_sk[i''_1], pk_S) in
              r_5: keys_t <- KeySchedule_auth(shared_secret_5, info_star);
              nonce_12: nonce_t <- get2(r_5);
              key_10: key_t <- get1(r_5);
              let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                event_abort adv_wins
              else
                return(bottom)
            else
              return(bottom)
        else
          return(bottom)
      ))


Applying remove assignments of binder the_sk
  - Remove assignments on the_sk (definition removed, all usages removed)
yields

Game 9 is
      ((
        foreach i <= N do
        Osetup() :=
        s <-R keypairseed_t;
        the_pk: pkey_t <- pkgen(s);
        return(the_pk);
        ((
          foreach iae <= Qeperuser do
          Oaenc(pk_2: pkey_t, m: bitstring, aad_8: bitstring, info_5: bitstring) :=
          k <-R kemseed_t;
          let AuthEncap_tuple(shared_secret_3: kemkey_t, enc_4: kemciph_t) = AuthEncap_r(k, pk_2, skgen(s)) in
            r_3: keys_t <- KeySchedule_auth(shared_secret_3, info_5);
            nonce_6: nonce_t <- get2(r_3);
            key_6: key_t <- get1(r_3);
            ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
            return(SealAuth_Some(enc_4, ct_8))
          else
            return(SealAuth_None)
        ) | (
          foreach iad <= Qdperuser do
          Oadec(pk_3: pkey_t, enc_7: kemciph_t, c: bitstring, aad_9: bitstring, info_6: bitstring) :=
          let AuthDecap_Some(shared_secret_4: kemkey_t) = AuthDecap(enc_7, skgen(s), pk_3) in
            r_4: keys_t <- KeySchedule_auth(shared_secret_4, info_6);
            nonce_9: nonce_t <- get2(r_4);
            key_8: key_t <- get1(r_4);
            let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
              return(OpenAuth_Some(Context_Open_Some(pt_6)))
            else
              return(OpenAuth_Some(Context_Open_None))
          else
            return(OpenAuth_None)
        ))
      ) | (
        Ochall(pk_S: pkey_t, pk_R: pkey_t, enc_star: kemciph_t, ciph_star: bitstring, aad_star: bitstring, info_star: bitstring) :=
        find i'_1 = i' <= N, i''_1 = i'' <= N suchthat defined(s[i''], the_pk[i''], the_pk[i']) && (the_pk[i'] = pk_S) && (the_pk[i''] = pk_R) then
          find u = u_2 <= Qeperuser suchthat defined(info_5[u_2, i'_1], aad_8[u_2, i'_1], ct_8[u_2, i'_1], enc_4[u_2, i'_1], pk_2[u_2, i'_1]) && (pk_2[u_2, i'_1] = pk_R) && (enc_4[u_2, i'_1] = enc_star) && (ct_8[u_2, i'_1] = ciph_star) && (aad_8[u_2, i'_1] = aad_star) && (info_5[u_2, i'_1] = info_star) then
            return(bottom)
          else
            let AuthDecap_Some(shared_secret_5: kemkey_t) = AuthDecap(enc_star, skgen(s[i''_1]), pk_S) in
              r_5: keys_t <- KeySchedule_auth(shared_secret_5, info_star);
              nonce_12: nonce_t <- get2(r_5);
              key_10: key_t <- get1(r_5);
              let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                event_abort adv_wins
              else
                return(bottom)
            else
              return(bottom)
        else
          return(bottom)
      ))


Applying remove assignments of binder the_pk
  - Remove assignments on the_pk (definition removed, all usages removed)
yields

Game 10 is
      ((
        foreach i <= N do
        Osetup() :=
        s <-R keypairseed_t;
        return(pkgen(s));
        ((
          foreach iae <= Qeperuser do
          Oaenc(pk_2: pkey_t, m: bitstring, aad_8: bitstring, info_5: bitstring) :=
          k <-R kemseed_t;
          let AuthEncap_tuple(shared_secret_3: kemkey_t, enc_4: kemciph_t) = AuthEncap_r(k, pk_2, skgen(s)) in
            r_3: keys_t <- KeySchedule_auth(shared_secret_3, info_5);
            nonce_6: nonce_t <- get2(r_3);
            key_6: key_t <- get1(r_3);
            ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
            return(SealAuth_Some(enc_4, ct_8))
          else
            return(SealAuth_None)
        ) | (
          foreach iad <= Qdperuser do
          Oadec(pk_3: pkey_t, enc_7: kemciph_t, c: bitstring, aad_9: bitstring, info_6: bitstring) :=
          let AuthDecap_Some(shared_secret_4: kemkey_t) = AuthDecap(enc_7, skgen(s), pk_3) in
            r_4: keys_t <- KeySchedule_auth(shared_secret_4, info_6);
            nonce_9: nonce_t <- get2(r_4);
            key_8: key_t <- get1(r_4);
            let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
              return(OpenAuth_Some(Context_Open_Some(pt_6)))
            else
              return(OpenAuth_Some(Context_Open_None))
          else
            return(OpenAuth_None)
        ))
      ) | (
        Ochall(pk_S: pkey_t, pk_R: pkey_t, enc_star: kemciph_t, ciph_star: bitstring, aad_star: bitstring, info_star: bitstring) :=
        find i'_1 = i' <= N, i''_1 = i'' <= N suchthat defined(s[i'], s[i'']) && (pkgen(s[i']) = pk_S) && (pkgen(s[i'']) = pk_R) then
          find u = u_2 <= Qeperuser suchthat defined(info_5[u_2, i'_1], aad_8[u_2, i'_1], ct_8[u_2, i'_1], enc_4[u_2, i'_1], pk_2[u_2, i'_1]) && (pk_2[u_2, i'_1] = pk_R) && (enc_4[u_2, i'_1] = enc_star) && (ct_8[u_2, i'_1] = ciph_star) && (aad_8[u_2, i'_1] = aad_star) && (info_5[u_2, i'_1] = info_star) then
            return(bottom)
          else
            let AuthDecap_Some(shared_secret_5: kemkey_t) = AuthDecap(enc_star, skgen(s[i''_1]), pk_S) in
              r_5: keys_t <- KeySchedule_auth(shared_secret_5, info_star);
              nonce_12: nonce_t <- get2(r_5);
              key_10: key_t <- get1(r_5);
              let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                event_abort adv_wins
              else
                return(bottom)
            else
              return(bottom)
        else
          return(bottom)
      ))


Applying equivalence outsider_cca(AuthEncap) with variables: s -> s_1 [probability Adv_Outsider_CCA(time_1, N, #Oaenc, 1 + #Oadec)]
  - Equivalence outsider_cca(AuthEncap) with variables: k -> ks, s -> s_1
yields

Game 11 is
      ((
        foreach i <= N do
        Osetup() :=
        s <-R keypairseed_t;
        return(pkgen(s));
        ((
          foreach iae <= Qeperuser do
          Oaenc(pk_2: pkey_t, m: bitstring, aad_8: bitstring, info_5: bitstring) :=
          k <-R kemseed_t;
          k'_1 <-R kemkey_t;
  {18}    let AuthEncap_tuple(shared_secret_3: kemkey_t, enc_4: kemciph_t) = (pk_R_1: pkey_t <- pk_2; find u_8 = ri_4 <= N suchthat defined(s[ri_4]) && (pk_R_1 = pkgen(s[ri_4])) then let AuthEncap_tuple(k_1: kemkey_t, ce: kemciph_t) = AuthEncap_r(k, pk_R_1, skgen(s)) in k': kemkey_t <- cst_kemkey_t; AuthEncap_tuple(k'_1, ce) else AuthEncap_None else AuthEncap_r(k, pk_R_1, skgen(s))) in
            r_3: keys_t <- KeySchedule_auth(shared_secret_3, info_5);
            nonce_6: nonce_t <- get2(r_3);
            key_6: key_t <- get1(r_3);
            ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
            return(SealAuth_Some(enc_4, ct_8))
          else
            return(SealAuth_None)
        ) | (
          foreach iad <= Qdperuser do
          Oadec(pk_3: pkey_t, enc_7: kemciph_t, c: bitstring, aad_9: bitstring, info_6: bitstring) :=
 {117}    let AuthDecap_Some(shared_secret_4: kemkey_t) = (pk_S_1: pkey_t <- pk_3; cd: kemciph_t <- enc_7; find u_6 = ri_2 <= Qeperuser, u_7 = ri_3 <= N suchthat defined(k'[ri_2, ri_3], s[ri_3], pk_R_1[ri_2, ri_3], k'_1[ri_2, ri_3], ce[ri_2, ri_3]) && (pkgen(s) = pk_R_1[ri_2, ri_3]) && (pkgen(s[ri_3]) = pk_S_1) && (ce[ri_2, ri_3] = cd) then AuthDecap_Some(k'_1[u_6, u_7]) else AuthDecap(cd, skgen(s), pk_S_1)) in
            r_4: keys_t <- KeySchedule_auth(shared_secret_4, info_6);
            nonce_9: nonce_t <- get2(r_4);
            key_8: key_t <- get1(r_4);
            let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
              return(OpenAuth_Some(Context_Open_Some(pt_6)))
            else
              return(OpenAuth_Some(Context_Open_None))
          else
            return(OpenAuth_None)
        ))
      ) | (
        Ochall(pk_S: pkey_t, pk_R: pkey_t, enc_star: kemciph_t, ciph_star: bitstring, aad_star: bitstring, info_star: bitstring) :=
        find i'_1 = i' <= N, i''_1 = i'' <= N suchthat defined(s[i'], s[i'']) && (pkgen(s[i']) = pk_S) && (pkgen(s[i'']) = pk_R) then
          find u = u_2 <= Qeperuser suchthat defined(info_5[u_2, i'_1], aad_8[u_2, i'_1], ct_8[u_2, i'_1], enc_4[u_2, i'_1], pk_2[u_2, i'_1]) && (pk_2[u_2, i'_1] = pk_R) && (enc_4[u_2, i'_1] = enc_star) && (ct_8[u_2, i'_1] = ciph_star) && (aad_8[u_2, i'_1] = aad_star) && (info_5[u_2, i'_1] = info_star) then
            return(bottom)
          else
 {288}      let AuthDecap_Some(shared_secret_5: kemkey_t) = (pk_S_2: pkey_t <- pk_S; cd_1: kemciph_t <- enc_star; find u_4 = ri <= Qeperuser, u_5 = ri_1 <= N suchthat defined(k'[ri, ri_1], s[ri_1], pk_R_1[ri, ri_1], k'_1[ri, ri_1], ce[ri, ri_1]) && (pkgen(s[i''_1]) = pk_R_1[ri, ri_1]) && (pkgen(s[ri_1]) = pk_S_2) && (ce[ri, ri_1] = cd_1) then AuthDecap_Some(k'_1[u_4, u_5]) else AuthDecap(cd_1, skgen(s[i''_1]), pk_S_2)) in
              r_5: keys_t <- KeySchedule_auth(shared_secret_5, info_star);
              nonce_12: nonce_t <- get2(r_5);
              key_10: key_t <- get1(r_5);
              let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                event_abort adv_wins
              else
                return(bottom)
            else
              return(bottom)
        else
          return(bottom)
      ))


Applying expand [probability N^2 * P_pk_coll]
  - Expand if/find/let
    - Simplify pattern AuthDecap_Some(shared_secret_5: kemkey_t) (tuple expanded) at 288
    - Remove else branch of let at 288
    - Simplify pattern AuthDecap_Some(shared_secret_4: kemkey_t) (tuple expanded) at 117
    - Remove else branch of let at 117
    - Simplify pattern AuthEncap_tuple(shared_secret_3: kemkey_t, enc_4: kemciph_t) (tuple expanded) at 18
    - Remove else branch of let at 18
yields

Game 12 is
      ((
        foreach i <= N do
        Osetup() :=
        s <-R keypairseed_t;
        return(pkgen(s));
        ((
          foreach iae <= Qeperuser do
          Oaenc(pk_2: pkey_t, m: bitstring, aad_8: bitstring, info_5: bitstring) :=
          k <-R kemseed_t;
          k'_1 <-R kemkey_t;
          pk_R_1: pkey_t <- pk_2;
          find u_8 = ri_4 <= N suchthat defined(s[ri_4]) && (pk_R_1 = pkgen(s[ri_4])) then
            let AuthEncap_tuple(k_1: kemkey_t, ce: kemciph_t) = AuthEncap_r(k, pk_R_1, skgen(s)) in
              k': kemkey_t <- cst_kemkey_t;
              enc_4: kemciph_t <- ce;
              shared_secret_3: kemkey_t <- k'_1;
              r_3: keys_t <- KeySchedule_auth(shared_secret_3, info_5);
              nonce_6: nonce_t <- get2(r_3);
              key_6: key_t <- get1(r_3);
              ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
              return(SealAuth_Some(enc_4, ct_8))
            else
              let AuthEncap_tuple(shared_secret_3: kemkey_t, enc_4: kemciph_t) = AuthEncap_None in
                r_3: keys_t <- KeySchedule_auth(shared_secret_3, info_5);
                nonce_6: nonce_t <- get2(r_3);
                key_6: key_t <- get1(r_3);
                ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
                return(SealAuth_Some(enc_4, ct_8))
              else
                return(SealAuth_None)
          else
            let AuthEncap_tuple(shared_secret_3: kemkey_t, enc_4: kemciph_t) = AuthEncap_r(k, pk_R_1, skgen(s)) in
              r_3: keys_t <- KeySchedule_auth(shared_secret_3, info_5);
              nonce_6: nonce_t <- get2(r_3);
              key_6: key_t <- get1(r_3);
              ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
              return(SealAuth_Some(enc_4, ct_8))
            else
              return(SealAuth_None)
        ) | (
          foreach iad <= Qdperuser do
          Oadec(pk_3: pkey_t, enc_7: kemciph_t, c: bitstring, aad_9: bitstring, info_6: bitstring) :=
          pk_S_1: pkey_t <- pk_3;
          cd: kemciph_t <- enc_7;
          find u_6 = ri_2 <= Qeperuser, u_7 = ri_3 <= N suchthat defined(k'[ri_2, ri_3], s[ri_3], pk_R_1[ri_2, ri_3], k'_1[ri_2, ri_3], ce[ri_2, ri_3]) && (pkgen(s) = pk_R_1[ri_2, ri_3]) && (pkgen(s[ri_3]) = pk_S_1) && (ce[ri_2, ri_3] = cd) then
            shared_secret_4: kemkey_t <- k'_1[u_6, u_7];
            r_4: keys_t <- KeySchedule_auth(shared_secret_4, info_6);
            nonce_9: nonce_t <- get2(r_4);
            key_8: key_t <- get1(r_4);
            let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
              return(OpenAuth_Some(Context_Open_Some(pt_6)))
            else
              return(OpenAuth_Some(Context_Open_None))
          else
            let AuthDecap_Some(shared_secret_4: kemkey_t) = AuthDecap(cd, skgen(s), pk_S_1) in
              r_4: keys_t <- KeySchedule_auth(shared_secret_4, info_6);
              nonce_9: nonce_t <- get2(r_4);
              key_8: key_t <- get1(r_4);
              let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
            else
              return(OpenAuth_None)
        ))
      ) | (
        Ochall(pk_S: pkey_t, pk_R: pkey_t, enc_star: kemciph_t, ciph_star: bitstring, aad_star: bitstring, info_star: bitstring) :=
        find i'_1 = i' <= N, i''_1 = i'' <= N suchthat defined(s[i'], s[i'']) && (pkgen(s[i']) = pk_S) && (pkgen(s[i'']) = pk_R) then
          find u = u_2 <= Qeperuser suchthat defined(info_5[u_2, i'_1], aad_8[u_2, i'_1], ct_8[u_2, i'_1], enc_4[u_2, i'_1], pk_2[u_2, i'_1]) && (pk_2[u_2, i'_1] = pk_R) && (enc_4[u_2, i'_1] = enc_star) && (ct_8[u_2, i'_1] = ciph_star) && (aad_8[u_2, i'_1] = aad_star) && (info_5[u_2, i'_1] = info_star) then
            return(bottom)
          else
            pk_S_2: pkey_t <- pk_S;
            cd_1: kemciph_t <- enc_star;
            find u_4 = ri <= Qeperuser, u_5 = ri_1 <= N suchthat defined(k'[ri, ri_1], s[ri_1], pk_R_1[ri, ri_1], k'_1[ri, ri_1], ce[ri, ri_1]) && (pkgen(s[i''_1]) = pk_R_1[ri, ri_1]) && (pkgen(s[ri_1]) = pk_S_2) && (ce[ri, ri_1] = cd_1) then
              shared_secret_5: kemkey_t <- k'_1[u_4, u_5];
              r_5: keys_t <- KeySchedule_auth(shared_secret_5, info_star);
              nonce_12: nonce_t <- get2(r_5);
              key_10: key_t <- get1(r_5);
              let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                event_abort adv_wins
              else
                return(bottom)
            else
              let AuthDecap_Some(shared_secret_5: kemkey_t) = AuthDecap(cd_1, skgen(s[i''_1]), pk_S_2) in
                r_5: keys_t <- KeySchedule_auth(shared_secret_5, info_star);
                nonce_12: nonce_t <- get2(r_5);
                key_10: key_t <- get1(r_5);
                let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                  event_abort adv_wins
                else
                  return(bottom)
              else
                return(bottom)
        else
          return(bottom)
      ))


Applying remove assignments of findcond
  - Remove assignments on pk_S_2 (definition removed, all usages removed)
  - Remove assignments on cd_1 (definition removed, all usages removed)
  - Remove assignments on shared_secret_5 (definition removed, all usages removed)
  - Remove assignments on pk_S_1 (definition removed, all usages removed)
  - Remove assignments on cd (definition removed, all usages removed)
  - Remove assignments on shared_secret_4 (definition removed, all usages removed)
  - Remove assignments on pk_R_1 (definition removed, all usages removed)
  - Remove assignments on shared_secret_3 (definition removed, all usages removed)
  - Remove assignments on enc_4 (definition kept, array references kept)
yields

Game 13 is
      ((
        foreach i <= N do
        Osetup() :=
        s <-R keypairseed_t;
        return(pkgen(s));
        ((
          foreach iae <= Qeperuser do
          Oaenc(pk_2: pkey_t, m: bitstring, aad_8: bitstring, info_5: bitstring) :=
          k <-R kemseed_t;
          k'_1 <-R kemkey_t;
          find u_8 = ri_4 <= N suchthat defined(s[ri_4]) && (pk_2 = pkgen(s[ri_4])) then
            let AuthEncap_tuple(k_1: kemkey_t, ce: kemciph_t) = AuthEncap_r(k, pk_2, skgen(s)) in
              k': kemkey_t <- cst_kemkey_t;
              enc_4: kemciph_t <- ce;
              r_3: keys_t <- KeySchedule_auth(k'_1, info_5);
              nonce_6: nonce_t <- get2(r_3);
              key_6: key_t <- get1(r_3);
              ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
              return(SealAuth_Some(ce, ct_8))
            else
              let AuthEncap_tuple(shared_secret_3: kemkey_t, enc_4: kemciph_t) = AuthEncap_None in
                r_3: keys_t <- KeySchedule_auth(shared_secret_3, info_5);
                nonce_6: nonce_t <- get2(r_3);
                key_6: key_t <- get1(r_3);
                ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
                return(SealAuth_Some(enc_4, ct_8))
              else
                return(SealAuth_None)
          else
            let AuthEncap_tuple(shared_secret_3: kemkey_t, enc_4: kemciph_t) = AuthEncap_r(k, pk_2, skgen(s)) in
              r_3: keys_t <- KeySchedule_auth(shared_secret_3, info_5);
              nonce_6: nonce_t <- get2(r_3);
              key_6: key_t <- get1(r_3);
              ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
              return(SealAuth_Some(enc_4, ct_8))
            else
              return(SealAuth_None)
        ) | (
          foreach iad <= Qdperuser do
          Oadec(pk_3: pkey_t, enc_7: kemciph_t, c: bitstring, aad_9: bitstring, info_6: bitstring) :=
 {209}    find u_6 = ri_2 <= Qeperuser, u_7 = ri_3 <= N suchthat defined(pk_2[ri_2, ri_3], k'[ri_2, ri_3], s[ri_3], k'_1[ri_2, ri_3], ce[ri_2, ri_3]) && {219}((pkgen(s) = pk_2[ri_2, ri_3]) && (pkgen(s[ri_3]) = pk_3) && (ce[ri_2, ri_3] = enc_7)) then
            r_4: keys_t <- KeySchedule_auth(k'_1[u_6, u_7], info_6);
            nonce_9: nonce_t <- get2(r_4);
            key_8: key_t <- get1(r_4);
            let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
              return(OpenAuth_Some(Context_Open_Some(pt_6)))
            else
              return(OpenAuth_Some(Context_Open_None))
          else
            let AuthDecap_Some(shared_secret_4: kemkey_t) = AuthDecap(enc_7, skgen(s), pk_3) in
              r_4: keys_t <- KeySchedule_auth(shared_secret_4, info_6);
              nonce_9: nonce_t <- get2(r_4);
              key_8: key_t <- get1(r_4);
              let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
            else
              return(OpenAuth_None)
        ))
      ) | (
        Ochall(pk_S: pkey_t, pk_R: pkey_t, enc_star: kemciph_t, ciph_star: bitstring, aad_star: bitstring, info_star: bitstring) :=
        find i'_1 = i' <= N, i''_1 = i'' <= N suchthat defined(s[i'], s[i'']) && (pkgen(s[i']) = pk_S) && (pkgen(s[i'']) = pk_R) then
          find u = u_2 <= Qeperuser suchthat defined(info_5[u_2, i'_1], aad_8[u_2, i'_1], ct_8[u_2, i'_1], enc_4[u_2, i'_1], pk_2[u_2, i'_1]) && (pk_2[u_2, i'_1] = pk_R) && (enc_4[u_2, i'_1] = enc_star) && (ct_8[u_2, i'_1] = ciph_star) && (aad_8[u_2, i'_1] = aad_star) && (info_5[u_2, i'_1] = info_star) then
            return(bottom)
          else
 {416}      find u_4 = ri <= Qeperuser, u_5 = ri_1 <= N suchthat defined(pk_2[ri, ri_1], k'[ri, ri_1], s[ri_1], k'_1[ri, ri_1], ce[ri, ri_1]) && {426}((pkgen(s[i''_1]) = pk_2[ri, ri_1]) && (pkgen(s[ri_1]) = pk_S) && (ce[ri, ri_1] = enc_star)) then
              r_5: keys_t <- KeySchedule_auth(k'_1[u_4, u_5], info_star);
              nonce_12: nonce_t <- get2(r_5);
              key_10: key_t <- get1(r_5);
              let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                event_abort adv_wins
              else
                return(bottom)
            else
              let AuthDecap_Some(shared_secret_5: kemkey_t) = AuthDecap(enc_star, skgen(s[i''_1]), pk_S) in
                r_5: keys_t <- KeySchedule_auth(shared_secret_5, info_star);
                nonce_12: nonce_t <- get2(r_5);
                key_10: key_t <- get1(r_5);
                let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                  event_abort adv_wins
                else
                  return(bottom)
              else
                return(bottom)
        else
          return(bottom)
      ))


Applying simplify [probability N^2 * P_pk_coll]
  - Simplification pass
    - Replaced ((pkgen(s[i''_1]) = pk_2[ri, ri_1]) && (pkgen(s[ri_1]) = pk_S) && (ce[ri, ri_1] = enc_star)) with ((i''_1 = u_8[ri, ri_1]) && (ri_1 = i'_1) && (ce[ri, ri_1] = enc_star)) at 426
    - In branch 1 of find at 416, substituting u_5 with i'_1
    - Replaced defined condition pk_2[ri, ri_1], k'[ri, ri_1], s[ri_1], k'_1[ri, ri_1], ce[ri, ri_1] with k'[ri, i'_1], k'_1[ri, i'_1], ce[ri, i'_1], u_8[ri, i'_1] in find at 416
    - Replaced ((pkgen(s) = pk_2[ri_2, ri_3]) && (pkgen(s[ri_3]) = pk_3) && (ce[ri_2, ri_3] = enc_7)) with ((i = u_8[ri_2, ri_3]) && (pkgen(s[ri_3]) = pk_3) && (ce[ri_2, ri_3] = enc_7)) at 219
    - Replaced defined condition pk_2[ri_2, ri_3], k'[ri_2, ri_3], s[ri_3], k'_1[ri_2, ri_3], ce[ri_2, ri_3] with k'[ri_2, ri_3], k'_1[ri_2, ri_3], ce[ri_2, ri_3], s[ri_3], u_8[ri_2, ri_3] in find at 209
yields

Game 14 is
      ((
        foreach i <= N do
        Osetup() :=
        s <-R keypairseed_t;
        return(pkgen(s));
        ((
          foreach iae <= Qeperuser do
          Oaenc(pk_2: pkey_t, m: bitstring, aad_8: bitstring, info_5: bitstring) :=
          k <-R kemseed_t;
          k'_1 <-R kemkey_t;
          find u_8 = ri_4 <= N suchthat defined(s[ri_4]) && (pk_2 = pkgen(s[ri_4])) then
            let AuthEncap_tuple(k_1: kemkey_t, ce: kemciph_t) = AuthEncap_r(k, pk_2, skgen(s)) in
              k': kemkey_t <- cst_kemkey_t;
              enc_4: kemciph_t <- ce;
              r_3: keys_t <- KeySchedule_auth(k'_1, info_5);
              nonce_6: nonce_t <- get2(r_3);
              key_6: key_t <- get1(r_3);
              ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
              return(SealAuth_Some(ce, ct_8))
            else
              let AuthEncap_tuple(shared_secret_3: kemkey_t, enc_4: kemciph_t) = AuthEncap_None in
                r_3: keys_t <- KeySchedule_auth(shared_secret_3, info_5);
                nonce_6: nonce_t <- get2(r_3);
                key_6: key_t <- get1(r_3);
                ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
                return(SealAuth_Some(enc_4, ct_8))
              else
                return(SealAuth_None)
          else
            let AuthEncap_tuple(shared_secret_3: kemkey_t, enc_4: kemciph_t) = AuthEncap_r(k, pk_2, skgen(s)) in
              r_3: keys_t <- KeySchedule_auth(shared_secret_3, info_5);
              nonce_6: nonce_t <- get2(r_3);
              key_6: key_t <- get1(r_3);
              ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
              return(SealAuth_Some(enc_4, ct_8))
            else
              return(SealAuth_None)
        ) | (
          foreach iad <= Qdperuser do
          Oadec(pk_3: pkey_t, enc_7: kemciph_t, c: bitstring, aad_9: bitstring, info_6: bitstring) :=
          find u_6 = ri_2 <= Qeperuser, u_7 = ri_3 <= N suchthat defined(k'[ri_2, ri_3], k'_1[ri_2, ri_3], ce[ri_2, ri_3], s[ri_3], u_8[ri_2, ri_3]) && (i = u_8[ri_2, ri_3]) && (pkgen(s[ri_3]) = pk_3) && (ce[ri_2, ri_3] = enc_7) then
            r_4: keys_t <- KeySchedule_auth(k'_1[u_6, u_7], info_6);
            nonce_9: nonce_t <- get2(r_4);
            key_8: key_t <- get1(r_4);
            let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
              return(OpenAuth_Some(Context_Open_Some(pt_6)))
            else
              return(OpenAuth_Some(Context_Open_None))
          else
            let AuthDecap_Some(shared_secret_4: kemkey_t) = AuthDecap(enc_7, skgen(s), pk_3) in
              r_4: keys_t <- KeySchedule_auth(shared_secret_4, info_6);
              nonce_9: nonce_t <- get2(r_4);
              key_8: key_t <- get1(r_4);
              let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
            else
              return(OpenAuth_None)
        ))
      ) | (
        Ochall(pk_S: pkey_t, pk_R: pkey_t, enc_star: kemciph_t, ciph_star: bitstring, aad_star: bitstring, info_star: bitstring) :=
        find i'_1 = i' <= N, i''_1 = i'' <= N suchthat defined(s[i'], s[i'']) && (pkgen(s[i']) = pk_S) && (pkgen(s[i'']) = pk_R) then
          find u = u_2 <= Qeperuser suchthat defined(info_5[u_2, i'_1], aad_8[u_2, i'_1], ct_8[u_2, i'_1], enc_4[u_2, i'_1], pk_2[u_2, i'_1]) && (pk_2[u_2, i'_1] = pk_R) && (enc_4[u_2, i'_1] = enc_star) && (ct_8[u_2, i'_1] = ciph_star) && (aad_8[u_2, i'_1] = aad_star) && (info_5[u_2, i'_1] = info_star) then
            return(bottom)
          else
            find u_4 = ri <= Qeperuser suchthat defined(k'[ri, i'_1], k'_1[ri, i'_1], ce[ri, i'_1], u_8[ri, i'_1]) && {423}((i''_1 = u_8[ri, i'_1]) && (i'_1 = i'_1) && (ce[ri, i'_1] = enc_star)) then
              u_5 <= N <- i'_1;
              r_5: keys_t <- KeySchedule_auth(k'_1[u_4, i'_1], info_star);
              nonce_12: nonce_t <- get2(r_5);
              key_10: key_t <- get1(r_5);
              let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                event_abort adv_wins
              else
                return(bottom)
            else
              let AuthDecap_Some(shared_secret_5: kemkey_t) = AuthDecap(enc_star, skgen(s[i''_1]), pk_S) in
                r_5: keys_t <- KeySchedule_auth(shared_secret_5, info_star);
                nonce_12: nonce_t <- get2(r_5);
                key_10: key_t <- get1(r_5);
                let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                  event_abort adv_wins
                else
                  return(bottom)
              else
                return(bottom)
        else
          return(bottom)
      ))


Applying simplify
  - Simplification pass
    - Replaced ((i''_1 = u_8[ri, i'_1]) && (i'_1 = i'_1) && (ce[ri, i'_1] = enc_star)) with ((i''_1 = u_8[ri, i'_1]) && (ce[ri, i'_1] = enc_star)) at 423
yields

Game 15 is
      ((
        foreach i <= N do
        Osetup() :=
        s <-R keypairseed_t;
        return(pkgen(s));
        ((
          foreach iae <= Qeperuser do
          Oaenc(pk_2: pkey_t, m: bitstring, aad_8: bitstring, info_5: bitstring) :=
          k <-R kemseed_t;
          k'_1 <-R kemkey_t;
          find u_8 = ri_4 <= N suchthat defined(s[ri_4]) && (pk_2 = pkgen(s[ri_4])) then
            let AuthEncap_tuple(k_1: kemkey_t, ce: kemciph_t) = AuthEncap_r(k, pk_2, skgen(s)) in
              k': kemkey_t <- cst_kemkey_t;
              enc_4: kemciph_t <- ce;
              r_3: keys_t <- KeySchedule_auth(k'_1, info_5);
              nonce_6: nonce_t <- get2(r_3);
              key_6: key_t <- get1(r_3);
              ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
              return(SealAuth_Some(ce, ct_8))
            else
              let AuthEncap_tuple(shared_secret_3: kemkey_t, enc_4: kemciph_t) = AuthEncap_None in
                r_3: keys_t <- KeySchedule_auth(shared_secret_3, info_5);
                nonce_6: nonce_t <- get2(r_3);
                key_6: key_t <- get1(r_3);
                ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
                return(SealAuth_Some(enc_4, ct_8))
              else
                return(SealAuth_None)
          else
            let AuthEncap_tuple(shared_secret_3: kemkey_t, enc_4: kemciph_t) = AuthEncap_r(k, pk_2, skgen(s)) in
              r_3: keys_t <- KeySchedule_auth(shared_secret_3, info_5);
              nonce_6: nonce_t <- get2(r_3);
              key_6: key_t <- get1(r_3);
              ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
              return(SealAuth_Some(enc_4, ct_8))
            else
              return(SealAuth_None)
        ) | (
          foreach iad <= Qdperuser do
          Oadec(pk_3: pkey_t, enc_7: kemciph_t, c: bitstring, aad_9: bitstring, info_6: bitstring) :=
          find u_6 = ri_2 <= Qeperuser, u_7 = ri_3 <= N suchthat defined(k'[ri_2, ri_3], k'_1[ri_2, ri_3], ce[ri_2, ri_3], s[ri_3], u_8[ri_2, ri_3]) && (i = u_8[ri_2, ri_3]) && (pkgen(s[ri_3]) = pk_3) && (ce[ri_2, ri_3] = enc_7) then
            r_4: keys_t <- KeySchedule_auth(k'_1[u_6, u_7], info_6);
            nonce_9: nonce_t <- get2(r_4);
            key_8: key_t <- get1(r_4);
            let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
              return(OpenAuth_Some(Context_Open_Some(pt_6)))
            else
              return(OpenAuth_Some(Context_Open_None))
          else
            let AuthDecap_Some(shared_secret_4: kemkey_t) = AuthDecap(enc_7, skgen(s), pk_3) in
              r_4: keys_t <- KeySchedule_auth(shared_secret_4, info_6);
              nonce_9: nonce_t <- get2(r_4);
              key_8: key_t <- get1(r_4);
              let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
            else
              return(OpenAuth_None)
        ))
      ) | (
        Ochall(pk_S: pkey_t, pk_R: pkey_t, enc_star: kemciph_t, ciph_star: bitstring, aad_star: bitstring, info_star: bitstring) :=
        find i'_1 = i' <= N, i''_1 = i'' <= N suchthat defined(s[i'], s[i'']) && (pkgen(s[i']) = pk_S) && (pkgen(s[i'']) = pk_R) then
          find u = u_2 <= Qeperuser suchthat defined(info_5[u_2, i'_1], aad_8[u_2, i'_1], ct_8[u_2, i'_1], enc_4[u_2, i'_1], pk_2[u_2, i'_1]) && (pk_2[u_2, i'_1] = pk_R) && (enc_4[u_2, i'_1] = enc_star) && (ct_8[u_2, i'_1] = ciph_star) && (aad_8[u_2, i'_1] = aad_star) && (info_5[u_2, i'_1] = info_star) then
            return(bottom)
          else
            find u_4 = ri <= Qeperuser suchthat defined(k'[ri, i'_1], k'_1[ri, i'_1], ce[ri, i'_1], u_8[ri, i'_1]) && (i''_1 = u_8[ri, i'_1]) && (ce[ri, i'_1] = enc_star) then
              u_5 <= N <- i'_1;
              r_5: keys_t <- KeySchedule_auth(k'_1[u_4, i'_1], info_star);
              nonce_12: nonce_t <- get2(r_5);
              key_10: key_t <- get1(r_5);
              let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                event_abort adv_wins
              else
                return(bottom)
            else
              let AuthDecap_Some(shared_secret_5: kemkey_t) = AuthDecap(enc_star, skgen(s[i''_1]), pk_S) in
                r_5: keys_t <- KeySchedule_auth(shared_secret_5, info_star);
                nonce_12: nonce_t <- get2(r_5);
                key_10: key_t <- get1(r_5);
                let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                  event_abort adv_wins
                else
                  return(bottom)
              else
                return(bottom)
        else
          return(bottom)
      ))


Applying move all binders
  - Move random number generation k'_1
  - Move random number generation k
yields

Game 16 is
      ((
        foreach i <= N do
        Osetup() :=
        s <-R keypairseed_t;
        return(pkgen(s));
        ((
          foreach iae <= Qeperuser do
          Oaenc(pk_2: pkey_t, m: bitstring, aad_8: bitstring, info_5: bitstring) :=
          find u_8 = ri_4 <= N suchthat defined(s[ri_4]) && (pk_2 = pkgen(s[ri_4])) then
            k <-R kemseed_t;
            let AuthEncap_tuple(k_1: kemkey_t, ce: kemciph_t) = AuthEncap_r(k, pk_2, skgen(s)) in
              k': kemkey_t <- cst_kemkey_t;
              enc_4: kemciph_t <- ce;
              k'_1 <-R kemkey_t;
              r_3: keys_t <- KeySchedule_auth(k'_1, info_5);
              nonce_6: nonce_t <- get2(r_3);
              key_6: key_t <- get1(r_3);
              ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
              return(SealAuth_Some(ce, ct_8))
            else
              let AuthEncap_tuple(shared_secret_3: kemkey_t, enc_4: kemciph_t) = AuthEncap_None in
                r_3: keys_t <- KeySchedule_auth(shared_secret_3, info_5);
                nonce_6: nonce_t <- get2(r_3);
                key_6: key_t <- get1(r_3);
                ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
                k'_1 <-R kemkey_t;
                return(SealAuth_Some(enc_4, ct_8))
              else
                k'_1 <-R kemkey_t;
                return(SealAuth_None)
          else
            k <-R kemseed_t;
            let AuthEncap_tuple(shared_secret_3: kemkey_t, enc_4: kemciph_t) = AuthEncap_r(k, pk_2, skgen(s)) in
              r_3: keys_t <- KeySchedule_auth(shared_secret_3, info_5);
              nonce_6: nonce_t <- get2(r_3);
              key_6: key_t <- get1(r_3);
              ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
              k'_1 <-R kemkey_t;
              return(SealAuth_Some(enc_4, ct_8))
            else
              k'_1 <-R kemkey_t;
              return(SealAuth_None)
        ) | (
          foreach iad <= Qdperuser do
          Oadec(pk_3: pkey_t, enc_7: kemciph_t, c: bitstring, aad_9: bitstring, info_6: bitstring) :=
          find u_6 = ri_2 <= Qeperuser, u_7 = ri_3 <= N suchthat defined(k'[ri_2, ri_3], k'_1[ri_2, ri_3], ce[ri_2, ri_3], s[ri_3], u_8[ri_2, ri_3]) && (i = u_8[ri_2, ri_3]) && (pkgen(s[ri_3]) = pk_3) && (ce[ri_2, ri_3] = enc_7) then
            r_4: keys_t <- KeySchedule_auth(k'_1[u_6, u_7], info_6);
            nonce_9: nonce_t <- get2(r_4);
            key_8: key_t <- get1(r_4);
            let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
              return(OpenAuth_Some(Context_Open_Some(pt_6)))
            else
              return(OpenAuth_Some(Context_Open_None))
          else
            let AuthDecap_Some(shared_secret_4: kemkey_t) = AuthDecap(enc_7, skgen(s), pk_3) in
              r_4: keys_t <- KeySchedule_auth(shared_secret_4, info_6);
              nonce_9: nonce_t <- get2(r_4);
              key_8: key_t <- get1(r_4);
              let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
            else
              return(OpenAuth_None)
        ))
      ) | (
        Ochall(pk_S: pkey_t, pk_R: pkey_t, enc_star: kemciph_t, ciph_star: bitstring, aad_star: bitstring, info_star: bitstring) :=
        find i'_1 = i' <= N, i''_1 = i'' <= N suchthat defined(s[i'], s[i'']) && (pkgen(s[i']) = pk_S) && (pkgen(s[i'']) = pk_R) then
          find u = u_2 <= Qeperuser suchthat defined(info_5[u_2, i'_1], aad_8[u_2, i'_1], ct_8[u_2, i'_1], enc_4[u_2, i'_1], pk_2[u_2, i'_1]) && (pk_2[u_2, i'_1] = pk_R) && (enc_4[u_2, i'_1] = enc_star) && (ct_8[u_2, i'_1] = ciph_star) && (aad_8[u_2, i'_1] = aad_star) && (info_5[u_2, i'_1] = info_star) then
            return(bottom)
          else
            find u_4 = ri <= Qeperuser suchthat defined(k'[ri, i'_1], k'_1[ri, i'_1], ce[ri, i'_1], u_8[ri, i'_1]) && (i''_1 = u_8[ri, i'_1]) && (ce[ri, i'_1] = enc_star) then
              u_5 <= N <- i'_1;
              r_5: keys_t <- KeySchedule_auth(k'_1[u_4, i'_1], info_star);
              nonce_12: nonce_t <- get2(r_5);
              key_10: key_t <- get1(r_5);
              let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                event_abort adv_wins
              else
                return(bottom)
            else
              let AuthDecap_Some(shared_secret_5: kemkey_t) = AuthDecap(enc_star, skgen(s[i''_1]), pk_S) in
                r_5: keys_t <- KeySchedule_auth(shared_secret_5, info_star);
                nonce_12: nonce_t <- get2(r_5);
                key_10: key_t <- get1(r_5);
                let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                  event_abort adv_wins
                else
                  return(bottom)
              else
                return(bottom)
        else
          return(bottom)
      ))


Applying remove assignments of findcond
  - Remove assignments on u_5 (definition removed, all usages removed)
  - Rename variable k into k_3, k_2
yields

Game 17 is
      ((
        foreach i <= N do
        Osetup() :=
        s <-R keypairseed_t;
        return(pkgen(s));
        ((
          foreach iae <= Qeperuser do
          Oaenc(pk_2: pkey_t, m: bitstring, aad_8: bitstring, info_5: bitstring) :=
          find u_8 = ri_4 <= N suchthat defined(s[ri_4]) && (pk_2 = pkgen(s[ri_4])) then
            k_3 <-R kemseed_t;
            let AuthEncap_tuple(k_1: kemkey_t, ce: kemciph_t) = AuthEncap_r(k_3, pk_2, skgen(s)) in
              k': kemkey_t <- cst_kemkey_t;
              enc_4: kemciph_t <- ce;
              k'_1 <-R kemkey_t;
              r_3: keys_t <- KeySchedule_auth(k'_1, info_5);
              nonce_6: nonce_t <- get2(r_3);
              key_6: key_t <- get1(r_3);
              ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
              return(SealAuth_Some(ce, ct_8))
            else
              let AuthEncap_tuple(shared_secret_3: kemkey_t, enc_4: kemciph_t) = AuthEncap_None in
                r_3: keys_t <- KeySchedule_auth(shared_secret_3, info_5);
                nonce_6: nonce_t <- get2(r_3);
                key_6: key_t <- get1(r_3);
                ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
                k'_1 <-R kemkey_t;
                return(SealAuth_Some(enc_4, ct_8))
              else
                k'_1 <-R kemkey_t;
                return(SealAuth_None)
          else
            k_2 <-R kemseed_t;
            let AuthEncap_tuple(shared_secret_3: kemkey_t, enc_4: kemciph_t) = AuthEncap_r(k_2, pk_2, skgen(s)) in
              r_3: keys_t <- KeySchedule_auth(shared_secret_3, info_5);
              nonce_6: nonce_t <- get2(r_3);
              key_6: key_t <- get1(r_3);
              ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
              k'_1 <-R kemkey_t;
              return(SealAuth_Some(enc_4, ct_8))
            else
              k'_1 <-R kemkey_t;
              return(SealAuth_None)
        ) | (
          foreach iad <= Qdperuser do
          Oadec(pk_3: pkey_t, enc_7: kemciph_t, c: bitstring, aad_9: bitstring, info_6: bitstring) :=
          find u_6 = ri_2 <= Qeperuser, u_7 = ri_3 <= N suchthat defined(k'[ri_2, ri_3], k'_1[ri_2, ri_3], ce[ri_2, ri_3], s[ri_3], u_8[ri_2, ri_3]) && (i = u_8[ri_2, ri_3]) && (pkgen(s[ri_3]) = pk_3) && (ce[ri_2, ri_3] = enc_7) then
            r_4: keys_t <- KeySchedule_auth(k'_1[u_6, u_7], info_6);
            nonce_9: nonce_t <- get2(r_4);
            key_8: key_t <- get1(r_4);
            let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
              return(OpenAuth_Some(Context_Open_Some(pt_6)))
            else
              return(OpenAuth_Some(Context_Open_None))
          else
            let AuthDecap_Some(shared_secret_4: kemkey_t) = AuthDecap(enc_7, skgen(s), pk_3) in
              r_4: keys_t <- KeySchedule_auth(shared_secret_4, info_6);
              nonce_9: nonce_t <- get2(r_4);
              key_8: key_t <- get1(r_4);
              let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
            else
              return(OpenAuth_None)
        ))
      ) | (
        Ochall(pk_S: pkey_t, pk_R: pkey_t, enc_star: kemciph_t, ciph_star: bitstring, aad_star: bitstring, info_star: bitstring) :=
        find i'_1 = i' <= N, i''_1 = i'' <= N suchthat defined(s[i'], s[i'']) && (pkgen(s[i']) = pk_S) && (pkgen(s[i'']) = pk_R) then
          find u = u_2 <= Qeperuser suchthat defined(info_5[u_2, i'_1], aad_8[u_2, i'_1], ct_8[u_2, i'_1], enc_4[u_2, i'_1], pk_2[u_2, i'_1]) && (pk_2[u_2, i'_1] = pk_R) && (enc_4[u_2, i'_1] = enc_star) && (ct_8[u_2, i'_1] = ciph_star) && (aad_8[u_2, i'_1] = aad_star) && (info_5[u_2, i'_1] = info_star) then
            return(bottom)
          else
            find u_4 = ri <= Qeperuser suchthat defined(k'[ri, i'_1], k'_1[ri, i'_1], ce[ri, i'_1], u_8[ri, i'_1]) && (i''_1 = u_8[ri, i'_1]) && (ce[ri, i'_1] = enc_star) then
              r_5: keys_t <- KeySchedule_auth(k'_1[u_4, i'_1], info_star);
              nonce_12: nonce_t <- get2(r_5);
              key_10: key_t <- get1(r_5);
              let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                event_abort adv_wins
              else
                return(bottom)
            else
              let AuthDecap_Some(shared_secret_5: kemkey_t) = AuthDecap(enc_star, skgen(s[i''_1]), pk_S) in
                r_5: keys_t <- KeySchedule_auth(shared_secret_5, info_star);
                nonce_12: nonce_t <- get2(r_5);
                key_10: key_t <- get1(r_5);
                let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                  event_abort adv_wins
                else
                  return(bottom)
              else
                return(bottom)
        else
          return(bottom)
      ))


Applying equivalence outsider_auth(AuthEncap) with variables: s -> s_1 [probability Adv_Outsider_Auth(time_2, N, #Oaenc, 1 + #Oadec)]
  - Equivalence outsider_auth(AuthEncap) with variables: k_3 -> ks, k_2 -> ks, s -> s_1
yields

Game 18 is
      ((
        foreach i <= N do
        Osetup() :=
        s <-R keypairseed_t;
        return(pkgen(s));
        ((
          foreach iae <= Qeperuser do
          Oaenc(pk_2: pkey_t, m: bitstring, aad_8: bitstring, info_5: bitstring) :=
          find u_8 = ri_4 <= N suchthat defined(s[ri_4]) && (pk_2 = pkgen(s[ri_4])) then
            k_3 <-R kemseed_t;
  {26}      let AuthEncap_tuple(k_1: kemkey_t, ce: kemciph_t) = (pk_R_3: pkey_t <- pk_2; let AuthEncap_tuple(k_6: kemkey_t, ce_2: kemciph_t) = AuthEncap_r(k_3, pk_R_3, skgen(s)) in AuthEncap_tuple(k_6, ce_2) else AuthEncap_None) in
              k': kemkey_t <- cst_kemkey_t;
              enc_4: kemciph_t <- ce;
              k'_1 <-R kemkey_t;
              r_3: keys_t <- KeySchedule_auth(k'_1, info_5);
              nonce_6: nonce_t <- get2(r_3);
              key_6: key_t <- get1(r_3);
              ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
              return(SealAuth_Some(ce, ct_8))
            else
              let AuthEncap_tuple(shared_secret_3: kemkey_t, enc_4: kemciph_t) = AuthEncap_None in
                r_3: keys_t <- KeySchedule_auth(shared_secret_3, info_5);
                nonce_6: nonce_t <- get2(r_3);
                key_6: key_t <- get1(r_3);
                ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
                k'_1 <-R kemkey_t;
                return(SealAuth_Some(enc_4, ct_8))
              else
                k'_1 <-R kemkey_t;
                return(SealAuth_None)
          else
            k_2 <-R kemseed_t;
 {160}      let AuthEncap_tuple(shared_secret_3: kemkey_t, enc_4: kemciph_t) = (pk_R_2: pkey_t <- pk_2; let AuthEncap_tuple(k_5: kemkey_t, ce_1: kemciph_t) = AuthEncap_r(k_2, pk_R_2, skgen(s)) in AuthEncap_tuple(k_5, ce_1) else AuthEncap_None) in
              r_3: keys_t <- KeySchedule_auth(shared_secret_3, info_5);
              nonce_6: nonce_t <- get2(r_3);
              key_6: key_t <- get1(r_3);
              ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
              k'_1 <-R kemkey_t;
              return(SealAuth_Some(enc_4, ct_8))
            else
              k'_1 <-R kemkey_t;
              return(SealAuth_None)
        ) | (
          foreach iad <= Qdperuser do
          Oadec(pk_3: pkey_t, enc_7: kemciph_t, c: bitstring, aad_9: bitstring, info_6: bitstring) :=
          find u_6 = ri_2 <= Qeperuser, u_7 = ri_3 <= N suchthat defined(k'_1[ri_2, ri_3], ce[ri_2, ri_3], s[ri_3], u_8[ri_2, ri_3]) && (i = u_8[ri_2, ri_3]) && (pkgen(s[ri_3]) = pk_3) && (ce[ri_2, ri_3] = enc_7) then
            r_4: keys_t <- KeySchedule_auth(k'_1[u_6, u_7], info_6);
            nonce_9: nonce_t <- get2(r_4);
            key_8: key_t <- get1(r_4);
            let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
              return(OpenAuth_Some(Context_Open_Some(pt_6)))
            else
              return(OpenAuth_Some(Context_Open_None))
          else
 {321}      let AuthDecap_Some(shared_secret_4: kemkey_t) = (pk_S_3: pkey_t <- pk_3; cd_2: kemciph_t <- enc_7; {330}find u_20 = ri_16 <= Qdperuser, u_21 = ri_17 <= N suchthat defined(s[ri_17], pk_S_3[ri_16, ri_17], k'_2[ri_16, ri_17], cd_2[ri_16, ri_17]) && (pkgen(s) = pkgen(s[ri_17])) && (pk_S_3[ri_16, ri_17] = pk_S_3) && (cd_2[ri_16, ri_17] = cd_2) then AuthDecap_Some(k'_2[u_20, u_21]) orfind  suchthat defined(s[i''_1], pk_S_4, k'_3, cd_3) && (pkgen(s) = pkgen(s[i''_1])) && (pk_S_4 = pk_S_3) && (cd_3 = cd_2) then AuthDecap_Some(k'_3) orfind u_18 = ri_14 <= Qeperuser, u_19 = ri_15 <= N suchthat defined(s[ri_15], pk_R_2[ri_14, ri_15], k_5[ri_14, ri_15], ce_1[ri_14, ri_15]) && (pkgen(s) = pk_R_2[ri_14, ri_15]) && (pkgen(s[ri_15]) = pk_S_3) && (ce_1[ri_14, ri_15] = cd_2) then AuthDecap_Some(k_5[u_18, u_19]) orfind u_16 = ri_12 <= Qeperuser, u_17 = ri_13 <= N suchthat defined(s[ri_13], pk_R_3[ri_12, ri_13], k_6[ri_12, ri_13], ce_2[ri_12, ri_13]) && (pkgen(s) = pk_R_3[ri_12, ri_13]) && (pkgen(s[ri_13]) = pk_S_3) && (ce_2[ri_12, ri_13] = cd_2) then AuthDecap_Some(k_6[u_16, u_17]) else find u_22 = ri_18 <= N suchthat defined(s[ri_18]) && (pk_S_3 = pkgen(s[ri_18])) then let AuthDecap_Some(k0: kemkey_t) = AuthDecap(cd_2, skgen(s), pk_S_3) in k'_2 <-R kemkey_t; AuthDecap_Some(k'_2) else AuthDecap_None else AuthDecap(cd_2, skgen(s), pk_S_3)) in
              r_4: keys_t <- KeySchedule_auth(shared_secret_4, info_6);
              nonce_9: nonce_t <- get2(r_4);
              key_8: key_t <- get1(r_4);
              let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
            else
              return(OpenAuth_None)
        ))
      ) | (
        Ochall(pk_S: pkey_t, pk_R: pkey_t, enc_star: kemciph_t, ciph_star: bitstring, aad_star: bitstring, info_star: bitstring) :=
        find i'_1 = i' <= N, i''_1 = i'' <= N suchthat defined(s[i'], s[i'']) && (pkgen(s[i']) = pk_S) && (pkgen(s[i'']) = pk_R) then
          find u = u_2 <= Qeperuser suchthat defined(info_5[u_2, i'_1], aad_8[u_2, i'_1], ct_8[u_2, i'_1], enc_4[u_2, i'_1], pk_2[u_2, i'_1]) && (pk_2[u_2, i'_1] = pk_R) && (enc_4[u_2, i'_1] = enc_star) && (ct_8[u_2, i'_1] = ciph_star) && (aad_8[u_2, i'_1] = aad_star) && (info_5[u_2, i'_1] = info_star) then
            return(bottom)
          else
            find u_4 = ri <= Qeperuser suchthat defined(k'_1[ri, i'_1], ce[ri, i'_1], u_8[ri, i'_1]) && (i''_1 = u_8[ri, i'_1]) && (ce[ri, i'_1] = enc_star) then
              r_5: keys_t <- KeySchedule_auth(k'_1[u_4, i'_1], info_star);
              nonce_12: nonce_t <- get2(r_5);
              key_10: key_t <- get1(r_5);
              let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                event_abort adv_wins
              else
                return(bottom)
            else
 {658}        let AuthDecap_Some(shared_secret_5: kemkey_t) = (pk_S_4: pkey_t <- pk_S; cd_3: kemciph_t <- enc_star; {663}find u_13 = ri_9 <= Qdperuser, u_14 = ri_10 <= N suchthat defined(s[ri_10], pk_S_3[ri_9, ri_10], k'_2[ri_9, ri_10], cd_2[ri_9, ri_10]) && (pkgen(s[i''_1]) = pkgen(s[ri_10])) && (pk_S_3[ri_9, ri_10] = pk_S_4) && (cd_2[ri_9, ri_10] = cd_3) then AuthDecap_Some(k'_2[u_13, u_14]) orfind u_11 = ri_7 <= Qeperuser, u_12 = ri_8 <= N suchthat defined(s[ri_8], pk_R_2[ri_7, ri_8], k_5[ri_7, ri_8], ce_1[ri_7, ri_8]) && (pkgen(s[i''_1]) = pk_R_2[ri_7, ri_8]) && (pkgen(s[ri_8]) = pk_S_4) && (ce_1[ri_7, ri_8] = cd_3) then AuthDecap_Some(k_5[u_11, u_12]) orfind u_9 = ri_5 <= Qeperuser, u_10 = ri_6 <= N suchthat defined(s[ri_6], pk_R_3[ri_5, ri_6], k_6[ri_5, ri_6], ce_2[ri_5, ri_6]) && (pkgen(s[i''_1]) = pk_R_3[ri_5, ri_6]) && (pkgen(s[ri_6]) = pk_S_4) && (ce_2[ri_5, ri_6] = cd_3) then AuthDecap_Some(k_6[u_9, u_10]) else {754}find u_15 = ri_11 <= N suchthat defined(s[ri_11]) && (pk_S_4 = pkgen(s[ri_11])) then let AuthDecap_Some(k0_1: kemkey_t) = AuthDecap(cd_3, skgen(s[i''_1]), pk_S_4) in k'_3 <-R kemkey_t; AuthDecap_Some(k'_3) else AuthDecap_None else AuthDecap(cd_3, skgen(s[i''_1]), pk_S_4)) in
                r_5: keys_t <- KeySchedule_auth(shared_secret_5, info_star);
                nonce_12: nonce_t <- get2(r_5);
                key_10: key_t <- get1(r_5);
                let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                  event_abort adv_wins
                else
                  return(bottom)
              else
                return(bottom)
        else
          return(bottom)
      ))


Applying expand [probability (#Oaenc * N + N^2) * P_pk_coll]
  - Expand if/find/let
    - Remove else branch of find at 754
    - Remove let at 658
    - Simplify pattern AuthDecap_Some(shared_secret_5: kemkey_t) (tuple expanded) at 658
    - Remove else branch of let at 658
    - A single branch always succeeds in find at 754
    - Simplify pattern AuthDecap_Some(shared_secret_5: kemkey_t) (tuple expanded) at 658
    - Remove else branch of let at 658
    - Remove branch 2 in find at 663
    - Simplify pattern AuthDecap_Some(shared_secret_5: kemkey_t) (tuple expanded) at 658
    - Remove else branch of let at 658
    - Remove let at 321
    - Simplify pattern AuthDecap_Some(shared_secret_4: kemkey_t) (tuple expanded) at 321
    - Remove else branch of let at 321
    - Simplify pattern AuthDecap_Some(shared_secret_4: kemkey_t) (tuple expanded) at 321
    - Remove else branch of let at 321
    - Remove branch 3 in find at 330
    - Simplify pattern AuthDecap_Some(shared_secret_4: kemkey_t) (tuple expanded) at 321
    - Remove else branch of let at 321
    - Simplify pattern AuthDecap_Some(shared_secret_4: kemkey_t) (tuple expanded) at 321
    - Remove else branch of let at 321
    - Simplify pattern AuthEncap_tuple(shared_secret_3: kemkey_t, enc_4: kemciph_t) (tuple expanded) at 160
    - Remove else branch of let at 160
    - Simplify pattern AuthEncap_tuple(k_1: kemkey_t, ce: kemciph_t) (tuple expanded) at 26
    - Remove else branch of let at 26
yields

Game 19 is
      ((
        foreach i <= N do
        Osetup() :=
        s <-R keypairseed_t;
        return(pkgen(s));
        ((
          foreach iae <= Qeperuser do
          Oaenc(pk_2: pkey_t, m: bitstring, aad_8: bitstring, info_5: bitstring) :=
          find u_8 = ri_4 <= N suchthat defined(s[ri_4]) && (pk_2 = pkgen(s[ri_4])) then
            k_3 <-R kemseed_t;
            pk_R_3: pkey_t <- pk_2;
            let AuthEncap_tuple(k_6: kemkey_t, ce_2: kemciph_t) = AuthEncap_r(k_3, pk_R_3, skgen(s)) in
              ce: kemciph_t <- ce_2;
              k_1: kemkey_t <- k_6;
              k': kemkey_t <- cst_kemkey_t;
              enc_4: kemciph_t <- ce;
              k'_1 <-R kemkey_t;
              r_3: keys_t <- KeySchedule_auth(k'_1, info_5);
              nonce_6: nonce_t <- get2(r_3);
              key_6: key_t <- get1(r_3);
              ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
              return(SealAuth_Some(ce, ct_8))
            else
              let AuthEncap_tuple(k_1: kemkey_t, ce: kemciph_t) = AuthEncap_None in
                k': kemkey_t <- cst_kemkey_t;
                enc_4: kemciph_t <- ce;
                k'_1 <-R kemkey_t;
                r_3: keys_t <- KeySchedule_auth(k'_1, info_5);
                nonce_6: nonce_t <- get2(r_3);
                key_6: key_t <- get1(r_3);
                ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
                return(SealAuth_Some(ce, ct_8))
              else
                let AuthEncap_tuple(shared_secret_3: kemkey_t, enc_4: kemciph_t) = AuthEncap_None in
                  r_3: keys_t <- KeySchedule_auth(shared_secret_3, info_5);
                  nonce_6: nonce_t <- get2(r_3);
                  key_6: key_t <- get1(r_3);
                  ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
                  k'_1 <-R kemkey_t;
                  return(SealAuth_Some(enc_4, ct_8))
                else
                  k'_1 <-R kemkey_t;
                  return(SealAuth_None)
          else
            k_2 <-R kemseed_t;
            pk_R_2: pkey_t <- pk_2;
            let AuthEncap_tuple(k_5: kemkey_t, ce_1: kemciph_t) = AuthEncap_r(k_2, pk_R_2, skgen(s)) in
              enc_4: kemciph_t <- ce_1;
              shared_secret_3: kemkey_t <- k_5;
              r_3: keys_t <- KeySchedule_auth(shared_secret_3, info_5);
              nonce_6: nonce_t <- get2(r_3);
              key_6: key_t <- get1(r_3);
              ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
              k'_1 <-R kemkey_t;
              return(SealAuth_Some(enc_4, ct_8))
            else
              let AuthEncap_tuple(shared_secret_3: kemkey_t, enc_4: kemciph_t) = AuthEncap_None in
                r_3: keys_t <- KeySchedule_auth(shared_secret_3, info_5);
                nonce_6: nonce_t <- get2(r_3);
                key_6: key_t <- get1(r_3);
                ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
                k'_1 <-R kemkey_t;
                return(SealAuth_Some(enc_4, ct_8))
              else
                k'_1 <-R kemkey_t;
                return(SealAuth_None)
        ) | (
          foreach iad <= Qdperuser do
          Oadec(pk_3: pkey_t, enc_7: kemciph_t, c: bitstring, aad_9: bitstring, info_6: bitstring) :=
          find u_6 = ri_2 <= Qeperuser, u_7 = ri_3 <= N suchthat defined(k'_1[ri_2, ri_3], ce[ri_2, ri_3], s[ri_3], u_8[ri_2, ri_3]) && (i = u_8[ri_2, ri_3]) && (pkgen(s[ri_3]) = pk_3) && (ce[ri_2, ri_3] = enc_7) then
            r_4: keys_t <- KeySchedule_auth(k'_1[u_6, u_7], info_6);
            nonce_9: nonce_t <- get2(r_4);
            key_8: key_t <- get1(r_4);
            let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
              return(OpenAuth_Some(Context_Open_Some(pt_6)))
            else
              return(OpenAuth_Some(Context_Open_None))
          else
            pk_S_3: pkey_t <- pk_3;
            cd_2: kemciph_t <- enc_7;
            find u_20 = ri_16 <= Qdperuser, u_21 = ri_17 <= N suchthat defined(s[ri_17], pk_S_3[ri_16, ri_17], k'_2[ri_16, ri_17], cd_2[ri_16, ri_17]) && (pkgen(s) = pkgen(s[ri_17])) && (pk_S_3[ri_16, ri_17] = pk_S_3) && (cd_2[ri_16, ri_17] = cd_2) then
              shared_secret_4: kemkey_t <- k'_2[u_20, u_21];
              r_4: keys_t <- KeySchedule_auth(shared_secret_4, info_6);
              nonce_9: nonce_t <- get2(r_4);
              key_8: key_t <- get1(r_4);
              let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
            orfind  suchthat defined(s[i''_1], pk_S_4, k'_3, cd_3) && (pkgen(s) = pkgen(s[i''_1])) && (pk_S_4 = pk_S_3) && (cd_3 = cd_2) then
              shared_secret_4: kemkey_t <- k'_3;
              r_4: keys_t <- KeySchedule_auth(shared_secret_4, info_6);
              nonce_9: nonce_t <- get2(r_4);
              key_8: key_t <- get1(r_4);
              let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
            orfind u_16 = ri_12 <= Qeperuser, u_17 = ri_13 <= N suchthat defined(s[ri_13], pk_R_3[ri_12, ri_13], k_6[ri_12, ri_13], ce_2[ri_12, ri_13]) && (pkgen(s) = pk_R_3[ri_12, ri_13]) && (pkgen(s[ri_13]) = pk_S_3) && (ce_2[ri_12, ri_13] = cd_2) then
              shared_secret_4: kemkey_t <- k_6[u_16, u_17];
              r_4: keys_t <- KeySchedule_auth(shared_secret_4, info_6);
              nonce_9: nonce_t <- get2(r_4);
              key_8: key_t <- get1(r_4);
              let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
            else
              find u_22 = ri_18 <= N suchthat defined(s[ri_18]) && (pk_S_3 = pkgen(s[ri_18])) then
                let AuthDecap_Some(k0: kemkey_t) = AuthDecap(cd_2, skgen(s), pk_S_3) in
                  k'_2 <-R kemkey_t;
                  shared_secret_4: kemkey_t <- k'_2;
                  r_4: keys_t <- KeySchedule_auth(shared_secret_4, info_6);
                  nonce_9: nonce_t <- get2(r_4);
                  key_8: key_t <- get1(r_4);
                  let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                    return(OpenAuth_Some(Context_Open_Some(pt_6)))
                  else
                    return(OpenAuth_Some(Context_Open_None))
                else
                  return(OpenAuth_None)
              else
                let AuthDecap_Some(shared_secret_4: kemkey_t) = AuthDecap(cd_2, skgen(s), pk_S_3) in
                  r_4: keys_t <- KeySchedule_auth(shared_secret_4, info_6);
                  nonce_9: nonce_t <- get2(r_4);
                  key_8: key_t <- get1(r_4);
                  let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                    return(OpenAuth_Some(Context_Open_Some(pt_6)))
                  else
                    return(OpenAuth_Some(Context_Open_None))
                else
                  return(OpenAuth_None)
        ))
      ) | (
        Ochall(pk_S: pkey_t, pk_R: pkey_t, enc_star: kemciph_t, ciph_star: bitstring, aad_star: bitstring, info_star: bitstring) :=
        find i'_1 = i' <= N, i''_1 = i'' <= N suchthat defined(s[i'], s[i'']) && (pkgen(s[i']) = pk_S) && (pkgen(s[i'']) = pk_R) then
          find u = u_2 <= Qeperuser suchthat defined(info_5[u_2, i'_1], aad_8[u_2, i'_1], ct_8[u_2, i'_1], enc_4[u_2, i'_1], pk_2[u_2, i'_1]) && (pk_2[u_2, i'_1] = pk_R) && (enc_4[u_2, i'_1] = enc_star) && (ct_8[u_2, i'_1] = ciph_star) && (aad_8[u_2, i'_1] = aad_star) && (info_5[u_2, i'_1] = info_star) then
            return(bottom)
          else
            find u_4 = ri <= Qeperuser suchthat defined(k'_1[ri, i'_1], ce[ri, i'_1], u_8[ri, i'_1]) && (i''_1 = u_8[ri, i'_1]) && (ce[ri, i'_1] = enc_star) then
              r_5: keys_t <- KeySchedule_auth(k'_1[u_4, i'_1], info_star);
              nonce_12: nonce_t <- get2(r_5);
              key_10: key_t <- get1(r_5);
              let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                event_abort adv_wins
              else
                return(bottom)
            else
              pk_S_4: pkey_t <- pk_S;
              cd_3: kemciph_t <- enc_star;
              find u_13 = ri_9 <= Qdperuser, u_14 = ri_10 <= N suchthat defined(s[ri_10], pk_S_3[ri_9, ri_10], k'_2[ri_9, ri_10], cd_2[ri_9, ri_10]) && (pkgen(s[i''_1]) = pkgen(s[ri_10])) && (pk_S_3[ri_9, ri_10] = pk_S_4) && (cd_2[ri_9, ri_10] = cd_3) then
                shared_secret_5: kemkey_t <- k'_2[u_13, u_14];
                r_5: keys_t <- KeySchedule_auth(shared_secret_5, info_star);
                nonce_12: nonce_t <- get2(r_5);
                key_10: key_t <- get1(r_5);
                let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                  event_abort adv_wins
                else
                  return(bottom)
              orfind u_9 = ri_5 <= Qeperuser, u_10 = ri_6 <= N suchthat defined(s[ri_6], pk_R_3[ri_5, ri_6], k_6[ri_5, ri_6], ce_2[ri_5, ri_6]) && (pkgen(s[i''_1]) = pk_R_3[ri_5, ri_6]) && (pkgen(s[ri_6]) = pk_S_4) && (ce_2[ri_5, ri_6] = cd_3) then
                shared_secret_5: kemkey_t <- k_6[u_9, u_10];
                r_5: keys_t <- KeySchedule_auth(shared_secret_5, info_star);
                nonce_12: nonce_t <- get2(r_5);
                key_10: key_t <- get1(r_5);
                let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                  event_abort adv_wins
                else
                  return(bottom)
              else
                let AuthDecap_Some(k0_1: kemkey_t) = AuthDecap(cd_3, skgen(s[i''_1]), pk_S_4) in
                  k'_3 <-R kemkey_t;
                  shared_secret_5: kemkey_t <- k'_3;
                  r_5: keys_t <- KeySchedule_auth(shared_secret_5, info_star);
                  nonce_12: nonce_t <- get2(r_5);
                  key_10: key_t <- get1(r_5);
                  let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                    event_abort adv_wins
                  else
                    return(bottom)
                else
                  return(bottom)
        else
          return(bottom)
      ))


Applying remove assignments of findcond
  - Remove assignments on pk_S_4 (definition point kept, all usages removed)
  - Remove assignments on cd_3 (definition removed, all usages removed)
  - Remove assignments on shared_secret_5 (definition removed, all usages removed)
  - Remove assignments on shared_secret_5 (definition removed, all usages removed)
  - Remove assignments on shared_secret_5 (definition removed, all usages removed)
  - Remove assignments on pk_S_3 (definition point kept, all usages removed)
  - Remove assignments on cd_2 (definition removed, all usages removed)
  - Remove assignments on shared_secret_4 (definition removed, all usages removed)
  - Remove assignments on shared_secret_4 (definition removed, all usages removed)
  - Remove assignments on shared_secret_4 (definition removed, all usages removed)
  - Remove assignments on shared_secret_4 (definition removed, all usages removed)
  - Remove assignments on pk_R_2 (definition removed, all usages removed)
  - Remove assignments on shared_secret_3 (definition removed, all usages removed)
  - Remove assignments on enc_4 (definition kept, array references kept)
  - Remove assignments on pk_R_3 (definition removed, all usages removed)
  - Remove assignments on k' (definition removed, all usages removed)
  - Remove assignments on k_1 (definition removed, all usages removed)
  - Remove assignments on k' (definition removed, all usages removed)
  - Remove assignments on ce (definition kept, array references kept)
yields

Game 20 is
      ((
        foreach i <= N do
        Osetup() :=
        s <-R keypairseed_t;
        return(pkgen(s));
        ((
          foreach iae <= Qeperuser do
          Oaenc(pk_2: pkey_t, m: bitstring, aad_8: bitstring, info_5: bitstring) :=
          find u_8 = ri_4 <= N suchthat defined(s[ri_4]) && (pk_2 = pkgen(s[ri_4])) then
            k_3 <-R kemseed_t;
            let AuthEncap_tuple(k_6: kemkey_t, ce_2: kemciph_t) = AuthEncap_r(k_3, pk_2, skgen(s)) in
              ce: kemciph_t <- ce_2;
              enc_4: kemciph_t <- ce_2;
              k'_1 <-R kemkey_t;
              r_3: keys_t <- KeySchedule_auth(k'_1, info_5);
              nonce_6: nonce_t <- get2(r_3);
              key_6: key_t <- get1(r_3);
              ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
              return(SealAuth_Some(ce_2, ct_8))
            else
              let AuthEncap_tuple(k_1: kemkey_t, ce: kemciph_t) = AuthEncap_None in
                enc_4: kemciph_t <- ce;
                k'_1 <-R kemkey_t;
                r_3: keys_t <- KeySchedule_auth(k'_1, info_5);
                nonce_6: nonce_t <- get2(r_3);
                key_6: key_t <- get1(r_3);
                ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
                return(SealAuth_Some(ce, ct_8))
              else
                let AuthEncap_tuple(shared_secret_3: kemkey_t, enc_4: kemciph_t) = AuthEncap_None in
                  r_3: keys_t <- KeySchedule_auth(shared_secret_3, info_5);
                  nonce_6: nonce_t <- get2(r_3);
                  key_6: key_t <- get1(r_3);
                  ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
                  k'_1 <-R kemkey_t;
                  return(SealAuth_Some(enc_4, ct_8))
                else
                  k'_1 <-R kemkey_t;
                  return(SealAuth_None)
          else
            k_2 <-R kemseed_t;
            let AuthEncap_tuple(k_5: kemkey_t, ce_1: kemciph_t) = AuthEncap_r(k_2, pk_2, skgen(s)) in
              enc_4: kemciph_t <- ce_1;
              r_3: keys_t <- KeySchedule_auth(k_5, info_5);
              nonce_6: nonce_t <- get2(r_3);
              key_6: key_t <- get1(r_3);
              ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
              k'_1 <-R kemkey_t;
              return(SealAuth_Some(ce_1, ct_8))
            else
              let AuthEncap_tuple(shared_secret_3: kemkey_t, enc_4: kemciph_t) = AuthEncap_None in
                r_3: keys_t <- KeySchedule_auth(shared_secret_3, info_5);
                nonce_6: nonce_t <- get2(r_3);
                key_6: key_t <- get1(r_3);
                ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
                k'_1 <-R kemkey_t;
                return(SealAuth_Some(enc_4, ct_8))
              else
                k'_1 <-R kemkey_t;
                return(SealAuth_None)
        ) | (
          foreach iad <= Qdperuser do
          Oadec(pk_3: pkey_t, enc_7: kemciph_t, c: bitstring, aad_9: bitstring, info_6: bitstring) :=
          find u_6 = ri_2 <= Qeperuser, u_7 = ri_3 <= N suchthat defined(k'_1[ri_2, ri_3], ce[ri_2, ri_3], s[ri_3], u_8[ri_2, ri_3]) && (i = u_8[ri_2, ri_3]) && (pkgen(s[ri_3]) = pk_3) && (ce[ri_2, ri_3] = enc_7) then
            r_4: keys_t <- KeySchedule_auth(k'_1[u_6, u_7], info_6);
            nonce_9: nonce_t <- get2(r_4);
            key_8: key_t <- get1(r_4);
            let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
              return(OpenAuth_Some(Context_Open_Some(pt_6)))
            else
              return(OpenAuth_Some(Context_Open_None))
          else
            pk_S_3: pkey_t <- cst_pkey_t;
 {407}      find u_20 = ri_16 <= Qdperuser, u_21 = ri_17 <= N suchthat defined(pk_3[ri_16, ri_17], enc_7[ri_16, ri_17], pk_S_3[ri_16, ri_17], s[ri_17], k'_2[ri_16, ri_17]) && {417}((pkgen(s) = pkgen(s[ri_17])) && (pk_3[ri_16, ri_17] = pk_3) && (enc_7[ri_16, ri_17] = enc_7)) then
              r_4: keys_t <- KeySchedule_auth(k'_2[u_20, u_21], info_6);
              nonce_9: nonce_t <- get2(r_4);
              key_8: key_t <- get1(r_4);
              let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
            orfind  suchthat defined(pk_S, enc_star, pk_S_4, s[i''_1], k'_3) && {493}((pkgen(s) = pkgen(s[i''_1])) && (pk_S = pk_3) && (enc_star = enc_7)) then
              r_4: keys_t <- KeySchedule_auth(k'_3, info_6);
              nonce_9: nonce_t <- get2(r_4);
              key_8: key_t <- get1(r_4);
              let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
            orfind u_16 = ri_12 <= Qeperuser, u_17 = ri_13 <= N suchthat defined(pk_2[ri_12, ri_13], k_3[ri_12, ri_13], s[ri_13], k_6[ri_12, ri_13], ce_2[ri_12, ri_13]) && {567}((pkgen(s) = pk_2[ri_12, ri_13]) && (pkgen(s[ri_13]) = pk_3) && (ce_2[ri_12, ri_13] = enc_7)) then
              r_4: keys_t <- KeySchedule_auth(k_6[u_16, u_17], info_6);
              nonce_9: nonce_t <- get2(r_4);
              key_8: key_t <- get1(r_4);
              let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
            else
              find u_22 = ri_18 <= N suchthat defined(s[ri_18]) && (pk_3 = pkgen(s[ri_18])) then
                let AuthDecap_Some(k0: kemkey_t) = AuthDecap(enc_7, skgen(s), pk_3) in
                  k'_2 <-R kemkey_t;
                  r_4: keys_t <- KeySchedule_auth(k'_2, info_6);
                  nonce_9: nonce_t <- get2(r_4);
                  key_8: key_t <- get1(r_4);
                  let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                    return(OpenAuth_Some(Context_Open_Some(pt_6)))
                  else
                    return(OpenAuth_Some(Context_Open_None))
                else
                  return(OpenAuth_None)
              else
                let AuthDecap_Some(shared_secret_4: kemkey_t) = AuthDecap(enc_7, skgen(s), pk_3) in
                  r_4: keys_t <- KeySchedule_auth(shared_secret_4, info_6);
                  nonce_9: nonce_t <- get2(r_4);
                  key_8: key_t <- get1(r_4);
                  let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                    return(OpenAuth_Some(Context_Open_Some(pt_6)))
                  else
                    return(OpenAuth_Some(Context_Open_None))
                else
                  return(OpenAuth_None)
        ))
      ) | (
        Ochall(pk_S: pkey_t, pk_R: pkey_t, enc_star: kemciph_t, ciph_star: bitstring, aad_star: bitstring, info_star: bitstring) :=
        find i'_1 = i' <= N, i''_1 = i'' <= N suchthat defined(s[i'], s[i'']) && (pkgen(s[i']) = pk_S) && (pkgen(s[i'']) = pk_R) then
          find u = u_2 <= Qeperuser suchthat defined(info_5[u_2, i'_1], aad_8[u_2, i'_1], ct_8[u_2, i'_1], enc_4[u_2, i'_1], pk_2[u_2, i'_1]) && (pk_2[u_2, i'_1] = pk_R) && (enc_4[u_2, i'_1] = enc_star) && (ct_8[u_2, i'_1] = ciph_star) && (aad_8[u_2, i'_1] = aad_star) && (info_5[u_2, i'_1] = info_star) then
            return(bottom)
          else
            find u_4 = ri <= Qeperuser suchthat defined(k'_1[ri, i'_1], ce[ri, i'_1], u_8[ri, i'_1]) && (i''_1 = u_8[ri, i'_1]) && (ce[ri, i'_1] = enc_star) then
              r_5: keys_t <- KeySchedule_auth(k'_1[u_4, i'_1], info_star);
              nonce_12: nonce_t <- get2(r_5);
              key_10: key_t <- get1(r_5);
              let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                event_abort adv_wins
              else
                return(bottom)
            else
              pk_S_4: pkey_t <- cst_pkey_t;
 {884}        find u_13 = ri_9 <= Qdperuser, u_14 = ri_10 <= N suchthat defined(pk_3[ri_9, ri_10], enc_7[ri_9, ri_10], pk_S_3[ri_9, ri_10], s[ri_10], k'_2[ri_9, ri_10]) && {894}((pkgen(s[i''_1]) = pkgen(s[ri_10])) && (pk_3[ri_9, ri_10] = pk_S) && (enc_7[ri_9, ri_10] = enc_star)) then
                r_5: keys_t <- KeySchedule_auth(k'_2[u_13, u_14], info_star);
                nonce_12: nonce_t <- get2(r_5);
                key_10: key_t <- get1(r_5);
                let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                  event_abort adv_wins
                else
                  return(bottom)
              orfind u_9 = ri_5 <= Qeperuser, u_10 = ri_6 <= N suchthat defined(pk_2[ri_5, ri_6], k_3[ri_5, ri_6], s[ri_6], k_6[ri_5, ri_6], ce_2[ri_5, ri_6]) && {948}((pkgen(s[i''_1]) = pk_2[ri_5, ri_6]) && (pkgen(s[ri_6]) = pk_S) && (ce_2[ri_5, ri_6] = enc_star)) then
                r_5: keys_t <- KeySchedule_auth(k_6[u_9, u_10], info_star);
                nonce_12: nonce_t <- get2(r_5);
                key_10: key_t <- get1(r_5);
                let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                  event_abort adv_wins
                else
                  return(bottom)
              else
                let AuthDecap_Some(k0_1: kemkey_t) = AuthDecap(enc_star, skgen(s[i''_1]), pk_S) in
                  k'_3 <-R kemkey_t;
                  r_5: keys_t <- KeySchedule_auth(k'_3, info_star);
                  nonce_12: nonce_t <- get2(r_5);
                  key_10: key_t <- get1(r_5);
                  let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                    event_abort adv_wins
                  else
                    return(bottom)
                else
                  return(bottom)
        else
          return(bottom)
      ))


Applying simplify [probability N^2 * P_pk_coll]
  - Simplification pass
    - Replaced ((pkgen(s[i''_1]) = pk_2[ri_5, ri_6]) && (pkgen(s[ri_6]) = pk_S) && (ce_2[ri_5, ri_6] = enc_star)) with ((i''_1 = u_8[ri_5, ri_6]) && (ri_6 = i'_1) && (ce_2[ri_5, ri_6] = enc_star)) at 948
    - Remove branch 2 in find at 884
    - Replaced ((pkgen(s[i''_1]) = pkgen(s[ri_10])) && (pk_3[ri_9, ri_10] = pk_S) && (enc_7[ri_9, ri_10] = enc_star)) with ((i''_1 = ri_10) && (u_22[ri_9, ri_10] = i'_1) && (enc_7[ri_9, ri_10] = enc_star)) at 894
    - In branch 1 of find at 884, substituting u_14 with i''_1
    - Replaced defined condition pk_3[ri_9, ri_10], enc_7[ri_9, ri_10], pk_S_3[ri_9, ri_10], s[ri_10], k'_2[ri_9, ri_10] with k'_2[ri_9, i''_1], enc_7[ri_9, i''_1], u_22[ri_9, i''_1] in find at 884
    - Replaced ((pkgen(s) = pk_2[ri_12, ri_13]) && (pkgen(s[ri_13]) = pk_3) && (ce_2[ri_12, ri_13] = enc_7)) with ((i = u_8[ri_12, ri_13]) && (pkgen(s[ri_13]) = pk_3) && (ce_2[ri_12, ri_13] = enc_7)) at 567
    - Remove branch 3 in find at 407
    - Replaced ((pkgen(s) = pkgen(s[i''_1])) && (pk_S = pk_3) && (enc_star = enc_7)) with ((i = i''_1) && (pk_S = pk_3) && (enc_star = enc_7)) at 493
    - Replaced defined condition pk_S, enc_star, pk_S_4, s[i''_1], k'_3 with k'_3, enc_star, pk_S, i''_1 in find at 407
    - Replaced ((pkgen(s) = pkgen(s[ri_17])) && (pk_3[ri_16, ri_17] = pk_3) && (enc_7[ri_16, ri_17] = enc_7)) with ((i = ri_17) && (pk_3[ri_16, ri_17] = pk_3) && (enc_7[ri_16, ri_17] = enc_7)) at 417
    - In branch 1 of find at 407, substituting u_21 with i
    - Replaced defined condition pk_3[ri_16, ri_17], enc_7[ri_16, ri_17], pk_S_3[ri_16, ri_17], s[ri_17], k'_2[ri_16, ri_17] with k'_2[ri_16], enc_7[ri_16], pk_3[ri_16] in find at 407
yields

Game 21 is
      ((
        foreach i <= N do
        Osetup() :=
        s <-R keypairseed_t;
        return(pkgen(s));
        ((
          foreach iae <= Qeperuser do
          Oaenc(pk_2: pkey_t, m: bitstring, aad_8: bitstring, info_5: bitstring) :=
          find u_8 = ri_4 <= N suchthat defined(s[ri_4]) && (pk_2 = pkgen(s[ri_4])) then
            k_3 <-R kemseed_t;
            let AuthEncap_tuple(k_6: kemkey_t, ce_2: kemciph_t) = AuthEncap_r(k_3, pk_2, skgen(s)) in
              ce: kemciph_t <- ce_2;
              enc_4: kemciph_t <- ce_2;
              k'_1 <-R kemkey_t;
              r_3: keys_t <- KeySchedule_auth(k'_1, info_5);
              nonce_6: nonce_t <- get2(r_3);
              key_6: key_t <- get1(r_3);
              ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
              return(SealAuth_Some(ce_2, ct_8))
            else
              let AuthEncap_tuple(k_1: kemkey_t, ce: kemciph_t) = AuthEncap_None in
                enc_4: kemciph_t <- ce;
                k'_1 <-R kemkey_t;
                r_3: keys_t <- KeySchedule_auth(k'_1, info_5);
                nonce_6: nonce_t <- get2(r_3);
                key_6: key_t <- get1(r_3);
                ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
                return(SealAuth_Some(ce, ct_8))
              else
                let AuthEncap_tuple(shared_secret_3: kemkey_t, enc_4: kemciph_t) = AuthEncap_None in
                  r_3: keys_t <- KeySchedule_auth(shared_secret_3, info_5);
                  nonce_6: nonce_t <- get2(r_3);
                  key_6: key_t <- get1(r_3);
                  ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
                  k'_1 <-R kemkey_t;
                  return(SealAuth_Some(enc_4, ct_8))
                else
                  k'_1 <-R kemkey_t;
                  return(SealAuth_None)
          else
            k_2 <-R kemseed_t;
            let AuthEncap_tuple(k_5: kemkey_t, ce_1: kemciph_t) = AuthEncap_r(k_2, pk_2, skgen(s)) in
              enc_4: kemciph_t <- ce_1;
              r_3: keys_t <- KeySchedule_auth(k_5, info_5);
              nonce_6: nonce_t <- get2(r_3);
              key_6: key_t <- get1(r_3);
              ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
              k'_1 <-R kemkey_t;
              return(SealAuth_Some(ce_1, ct_8))
            else
              let AuthEncap_tuple(shared_secret_3: kemkey_t, enc_4: kemciph_t) = AuthEncap_None in
                r_3: keys_t <- KeySchedule_auth(shared_secret_3, info_5);
                nonce_6: nonce_t <- get2(r_3);
                key_6: key_t <- get1(r_3);
                ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
                k'_1 <-R kemkey_t;
                return(SealAuth_Some(enc_4, ct_8))
              else
                k'_1 <-R kemkey_t;
                return(SealAuth_None)
        ) | (
          foreach iad <= Qdperuser do
          Oadec(pk_3: pkey_t, enc_7: kemciph_t, c: bitstring, aad_9: bitstring, info_6: bitstring) :=
          find u_6 = ri_2 <= Qeperuser, u_7 = ri_3 <= N suchthat defined(k'_1[ri_2, ri_3], ce[ri_2, ri_3], s[ri_3], u_8[ri_2, ri_3]) && (i = u_8[ri_2, ri_3]) && (pkgen(s[ri_3]) = pk_3) && (ce[ri_2, ri_3] = enc_7) then
            r_4: keys_t <- KeySchedule_auth(k'_1[u_6, u_7], info_6);
            nonce_9: nonce_t <- get2(r_4);
            key_8: key_t <- get1(r_4);
            let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
              return(OpenAuth_Some(Context_Open_Some(pt_6)))
            else
              return(OpenAuth_Some(Context_Open_None))
          else
            pk_S_3: pkey_t <- cst_pkey_t;
            find u_20 = ri_16 <= Qdperuser suchthat defined(k'_2[ri_16], enc_7[ri_16], pk_3[ri_16]) && {414}((i = i) && (pk_3[ri_16] = pk_3) && (enc_7[ri_16] = enc_7)) then
              u_21 <= N <- i;
              r_4: keys_t <- KeySchedule_auth(k'_2[u_20], info_6);
              nonce_9: nonce_t <- get2(r_4);
              key_8: key_t <- get1(r_4);
              let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
            orfind  suchthat defined(k'_3, enc_star, pk_S, i''_1) && (i = i''_1) && (pk_S = pk_3) && (enc_star = enc_7) then
              r_4: keys_t <- KeySchedule_auth(k'_3, info_6);
              nonce_9: nonce_t <- get2(r_4);
              key_8: key_t <- get1(r_4);
              let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
            else
              find u_22 = ri_18 <= N suchthat defined(s[ri_18]) && (pk_3 = pkgen(s[ri_18])) then
                let AuthDecap_Some(k0: kemkey_t) = AuthDecap(enc_7, skgen(s), pk_3) in
                  k'_2 <-R kemkey_t;
                  r_4: keys_t <- KeySchedule_auth(k'_2, info_6);
                  nonce_9: nonce_t <- get2(r_4);
                  key_8: key_t <- get1(r_4);
                  let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                    return(OpenAuth_Some(Context_Open_Some(pt_6)))
                  else
                    return(OpenAuth_Some(Context_Open_None))
                else
                  return(OpenAuth_None)
              else
                let AuthDecap_Some(shared_secret_4: kemkey_t) = AuthDecap(enc_7, skgen(s), pk_3) in
                  r_4: keys_t <- KeySchedule_auth(shared_secret_4, info_6);
                  nonce_9: nonce_t <- get2(r_4);
                  key_8: key_t <- get1(r_4);
                  let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                    return(OpenAuth_Some(Context_Open_Some(pt_6)))
                  else
                    return(OpenAuth_Some(Context_Open_None))
                else
                  return(OpenAuth_None)
        ))
      ) | (
        Ochall(pk_S: pkey_t, pk_R: pkey_t, enc_star: kemciph_t, ciph_star: bitstring, aad_star: bitstring, info_star: bitstring) :=
        find i'_1 = i' <= N, i''_1 = i'' <= N suchthat defined(s[i'], s[i'']) && (pkgen(s[i']) = pk_S) && (pkgen(s[i'']) = pk_R) then
          find u = u_2 <= Qeperuser suchthat defined(info_5[u_2, i'_1], aad_8[u_2, i'_1], ct_8[u_2, i'_1], enc_4[u_2, i'_1], pk_2[u_2, i'_1]) && (pk_2[u_2, i'_1] = pk_R) && (enc_4[u_2, i'_1] = enc_star) && (ct_8[u_2, i'_1] = ciph_star) && (aad_8[u_2, i'_1] = aad_star) && (info_5[u_2, i'_1] = info_star) then
            return(bottom)
          else
            find u_4 = ri <= Qeperuser suchthat defined(k'_1[ri, i'_1], ce[ri, i'_1], u_8[ri, i'_1]) && (i''_1 = u_8[ri, i'_1]) && (ce[ri, i'_1] = enc_star) then
              r_5: keys_t <- KeySchedule_auth(k'_1[u_4, i'_1], info_star);
              nonce_12: nonce_t <- get2(r_5);
              key_10: key_t <- get1(r_5);
              let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                event_abort adv_wins
              else
                return(bottom)
            else
              pk_S_4: pkey_t <- cst_pkey_t;
              find u_13 = ri_9 <= Qdperuser suchthat defined(k'_2[ri_9, i''_1], enc_7[ri_9, i''_1], u_22[ri_9, i''_1]) && {796}((i''_1 = i''_1) && (u_22[ri_9, i''_1] = i'_1) && (enc_7[ri_9, i''_1] = enc_star)) then
                u_14 <= N <- i''_1;
                r_5: keys_t <- KeySchedule_auth(k'_2[u_13, i''_1], info_star);
                nonce_12: nonce_t <- get2(r_5);
                key_10: key_t <- get1(r_5);
                let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                  event_abort adv_wins
                else
                  return(bottom)
              else
                let AuthDecap_Some(k0_1: kemkey_t) = AuthDecap(enc_star, skgen(s[i''_1]), pk_S) in
                  k'_3 <-R kemkey_t;
                  r_5: keys_t <- KeySchedule_auth(k'_3, info_star);
                  nonce_12: nonce_t <- get2(r_5);
                  key_10: key_t <- get1(r_5);
                  let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                    event_abort adv_wins
                  else
                    return(bottom)
                else
                  return(bottom)
        else
          return(bottom)
      ))


Applying simplify
  - Simplification pass
    - Replaced ((i''_1 = i''_1) && (u_22[ri_9, i''_1] = i'_1) && (enc_7[ri_9, i''_1] = enc_star)) with ((u_22[ri_9, i''_1] = i'_1) && (enc_7[ri_9, i''_1] = enc_star)) at 796
    - Replaced ((i = i) && (pk_3[ri_16] = pk_3) && (enc_7[ri_16] = enc_7)) with ((pk_3[ri_16] = pk_3) && (enc_7[ri_16] = enc_7)) at 414
yields

Game 22 is
      ((
        foreach i <= N do
        Osetup() :=
        s <-R keypairseed_t;
        return(pkgen(s));
        ((
          foreach iae <= Qeperuser do
          Oaenc(pk_2: pkey_t, m: bitstring, aad_8: bitstring, info_5: bitstring) :=
          find u_8 = ri_4 <= N suchthat defined(s[ri_4]) && (pk_2 = pkgen(s[ri_4])) then
            k_3 <-R kemseed_t;
            let AuthEncap_tuple(k_6: kemkey_t, ce_2: kemciph_t) = AuthEncap_r(k_3, pk_2, skgen(s)) in
              ce: kemciph_t <- ce_2;
              enc_4: kemciph_t <- ce_2;
              k'_1 <-R kemkey_t;
              r_3: keys_t <- KeySchedule_auth(k'_1, info_5);
              nonce_6: nonce_t <- get2(r_3);
              key_6: key_t <- get1(r_3);
              ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
              return(SealAuth_Some(ce_2, ct_8))
            else
              let AuthEncap_tuple(k_1: kemkey_t, ce: kemciph_t) = AuthEncap_None in
                enc_4: kemciph_t <- ce;
                k'_1 <-R kemkey_t;
                r_3: keys_t <- KeySchedule_auth(k'_1, info_5);
                nonce_6: nonce_t <- get2(r_3);
                key_6: key_t <- get1(r_3);
                ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
                return(SealAuth_Some(ce, ct_8))
              else
                let AuthEncap_tuple(shared_secret_3: kemkey_t, enc_4: kemciph_t) = AuthEncap_None in
                  r_3: keys_t <- KeySchedule_auth(shared_secret_3, info_5);
                  nonce_6: nonce_t <- get2(r_3);
                  key_6: key_t <- get1(r_3);
                  ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
                  k'_1 <-R kemkey_t;
                  return(SealAuth_Some(enc_4, ct_8))
                else
                  k'_1 <-R kemkey_t;
                  return(SealAuth_None)
          else
            k_2 <-R kemseed_t;
            let AuthEncap_tuple(k_5: kemkey_t, ce_1: kemciph_t) = AuthEncap_r(k_2, pk_2, skgen(s)) in
              enc_4: kemciph_t <- ce_1;
              r_3: keys_t <- KeySchedule_auth(k_5, info_5);
              nonce_6: nonce_t <- get2(r_3);
              key_6: key_t <- get1(r_3);
              ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
              k'_1 <-R kemkey_t;
              return(SealAuth_Some(ce_1, ct_8))
            else
              let AuthEncap_tuple(shared_secret_3: kemkey_t, enc_4: kemciph_t) = AuthEncap_None in
                r_3: keys_t <- KeySchedule_auth(shared_secret_3, info_5);
                nonce_6: nonce_t <- get2(r_3);
                key_6: key_t <- get1(r_3);
                ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
                k'_1 <-R kemkey_t;
                return(SealAuth_Some(enc_4, ct_8))
              else
                k'_1 <-R kemkey_t;
                return(SealAuth_None)
        ) | (
          foreach iad <= Qdperuser do
          Oadec(pk_3: pkey_t, enc_7: kemciph_t, c: bitstring, aad_9: bitstring, info_6: bitstring) :=
          find u_6 = ri_2 <= Qeperuser, u_7 = ri_3 <= N suchthat defined(k'_1[ri_2, ri_3], ce[ri_2, ri_3], s[ri_3], u_8[ri_2, ri_3]) && (i = u_8[ri_2, ri_3]) && (pkgen(s[ri_3]) = pk_3) && (ce[ri_2, ri_3] = enc_7) then
            r_4: keys_t <- KeySchedule_auth(k'_1[u_6, u_7], info_6);
            nonce_9: nonce_t <- get2(r_4);
            key_8: key_t <- get1(r_4);
            let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
              return(OpenAuth_Some(Context_Open_Some(pt_6)))
            else
              return(OpenAuth_Some(Context_Open_None))
          else
            pk_S_3: pkey_t <- cst_pkey_t;
            find u_20 = ri_16 <= Qdperuser suchthat defined(k'_2[ri_16], enc_7[ri_16], pk_3[ri_16]) && (pk_3[ri_16] = pk_3) && (enc_7[ri_16] = enc_7) then
              u_21 <= N <- i;
              r_4: keys_t <- KeySchedule_auth(k'_2[u_20], info_6);
              nonce_9: nonce_t <- get2(r_4);
              key_8: key_t <- get1(r_4);
              let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
            orfind  suchthat defined(k'_3, enc_star, pk_S, i''_1) && (i = i''_1) && (pk_S = pk_3) && (enc_star = enc_7) then
              r_4: keys_t <- KeySchedule_auth(k'_3, info_6);
              nonce_9: nonce_t <- get2(r_4);
              key_8: key_t <- get1(r_4);
              let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
            else
              find u_22 = ri_18 <= N suchthat defined(s[ri_18]) && (pk_3 = pkgen(s[ri_18])) then
                let AuthDecap_Some(k0: kemkey_t) = AuthDecap(enc_7, skgen(s), pk_3) in
                  k'_2 <-R kemkey_t;
                  r_4: keys_t <- KeySchedule_auth(k'_2, info_6);
                  nonce_9: nonce_t <- get2(r_4);
                  key_8: key_t <- get1(r_4);
                  let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                    return(OpenAuth_Some(Context_Open_Some(pt_6)))
                  else
                    return(OpenAuth_Some(Context_Open_None))
                else
                  return(OpenAuth_None)
              else
                let AuthDecap_Some(shared_secret_4: kemkey_t) = AuthDecap(enc_7, skgen(s), pk_3) in
                  r_4: keys_t <- KeySchedule_auth(shared_secret_4, info_6);
                  nonce_9: nonce_t <- get2(r_4);
                  key_8: key_t <- get1(r_4);
                  let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                    return(OpenAuth_Some(Context_Open_Some(pt_6)))
                  else
                    return(OpenAuth_Some(Context_Open_None))
                else
                  return(OpenAuth_None)
        ))
      ) | (
        Ochall(pk_S: pkey_t, pk_R: pkey_t, enc_star: kemciph_t, ciph_star: bitstring, aad_star: bitstring, info_star: bitstring) :=
        find i'_1 = i' <= N, i''_1 = i'' <= N suchthat defined(s[i'], s[i'']) && (pkgen(s[i']) = pk_S) && (pkgen(s[i'']) = pk_R) then
          find u = u_2 <= Qeperuser suchthat defined(info_5[u_2, i'_1], aad_8[u_2, i'_1], ct_8[u_2, i'_1], enc_4[u_2, i'_1], pk_2[u_2, i'_1]) && (pk_2[u_2, i'_1] = pk_R) && (enc_4[u_2, i'_1] = enc_star) && (ct_8[u_2, i'_1] = ciph_star) && (aad_8[u_2, i'_1] = aad_star) && (info_5[u_2, i'_1] = info_star) then
            return(bottom)
          else
            find u_4 = ri <= Qeperuser suchthat defined(k'_1[ri, i'_1], ce[ri, i'_1], u_8[ri, i'_1]) && (i''_1 = u_8[ri, i'_1]) && (ce[ri, i'_1] = enc_star) then
              r_5: keys_t <- KeySchedule_auth(k'_1[u_4, i'_1], info_star);
              nonce_12: nonce_t <- get2(r_5);
              key_10: key_t <- get1(r_5);
              let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                event_abort adv_wins
              else
                return(bottom)
            else
              pk_S_4: pkey_t <- cst_pkey_t;
              find u_13 = ri_9 <= Qdperuser suchthat defined(k'_2[ri_9, i''_1], enc_7[ri_9, i''_1], u_22[ri_9, i''_1]) && (u_22[ri_9, i''_1] = i'_1) && (enc_7[ri_9, i''_1] = enc_star) then
                u_14 <= N <- i''_1;
                r_5: keys_t <- KeySchedule_auth(k'_2[u_13, i''_1], info_star);
                nonce_12: nonce_t <- get2(r_5);
                key_10: key_t <- get1(r_5);
                let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                  event_abort adv_wins
                else
                  return(bottom)
              else
                let AuthDecap_Some(k0_1: kemkey_t) = AuthDecap(enc_star, skgen(s[i''_1]), pk_S) in
                  k'_3 <-R kemkey_t;
                  r_5: keys_t <- KeySchedule_auth(k'_3, info_star);
                  nonce_12: nonce_t <- get2(r_5);
                  key_10: key_t <- get1(r_5);
                  let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                    event_abort adv_wins
                  else
                    return(bottom)
                else
                  return(bottom)
        else
          return(bottom)
      ))


Applying move all binders
  - Move assignment to pk_S_4
  - Move assignment to pk_S_3
yields

Game 23 is
      ((
        foreach i <= N do
        Osetup() :=
        s <-R keypairseed_t;
        return(pkgen(s));
        ((
          foreach iae <= Qeperuser do
          Oaenc(pk_2: pkey_t, m: bitstring, aad_8: bitstring, info_5: bitstring) :=
          find u_8 = ri_4 <= N suchthat defined(s[ri_4]) && (pk_2 = pkgen(s[ri_4])) then
            k_3 <-R kemseed_t;
            let AuthEncap_tuple(k_6: kemkey_t, ce_2: kemciph_t) = AuthEncap_r(k_3, pk_2, skgen(s)) in
              ce: kemciph_t <- ce_2;
              enc_4: kemciph_t <- ce_2;
              k'_1 <-R kemkey_t;
              r_3: keys_t <- KeySchedule_auth(k'_1, info_5);
              nonce_6: nonce_t <- get2(r_3);
              key_6: key_t <- get1(r_3);
              ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
              return(SealAuth_Some(ce_2, ct_8))
            else
              let AuthEncap_tuple(k_1: kemkey_t, ce: kemciph_t) = AuthEncap_None in
                enc_4: kemciph_t <- ce;
                k'_1 <-R kemkey_t;
                r_3: keys_t <- KeySchedule_auth(k'_1, info_5);
                nonce_6: nonce_t <- get2(r_3);
                key_6: key_t <- get1(r_3);
                ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
                return(SealAuth_Some(ce, ct_8))
              else
                let AuthEncap_tuple(shared_secret_3: kemkey_t, enc_4: kemciph_t) = AuthEncap_None in
                  r_3: keys_t <- KeySchedule_auth(shared_secret_3, info_5);
                  nonce_6: nonce_t <- get2(r_3);
                  key_6: key_t <- get1(r_3);
                  ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
                  k'_1 <-R kemkey_t;
                  return(SealAuth_Some(enc_4, ct_8))
                else
                  k'_1 <-R kemkey_t;
                  return(SealAuth_None)
          else
            k_2 <-R kemseed_t;
            let AuthEncap_tuple(k_5: kemkey_t, ce_1: kemciph_t) = AuthEncap_r(k_2, pk_2, skgen(s)) in
              enc_4: kemciph_t <- ce_1;
              r_3: keys_t <- KeySchedule_auth(k_5, info_5);
              nonce_6: nonce_t <- get2(r_3);
              key_6: key_t <- get1(r_3);
              ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
              k'_1 <-R kemkey_t;
              return(SealAuth_Some(ce_1, ct_8))
            else
              let AuthEncap_tuple(shared_secret_3: kemkey_t, enc_4: kemciph_t) = AuthEncap_None in
                r_3: keys_t <- KeySchedule_auth(shared_secret_3, info_5);
                nonce_6: nonce_t <- get2(r_3);
                key_6: key_t <- get1(r_3);
                ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
                k'_1 <-R kemkey_t;
                return(SealAuth_Some(enc_4, ct_8))
              else
                k'_1 <-R kemkey_t;
                return(SealAuth_None)
        ) | (
          foreach iad <= Qdperuser do
          Oadec(pk_3: pkey_t, enc_7: kemciph_t, c: bitstring, aad_9: bitstring, info_6: bitstring) :=
          find u_6 = ri_2 <= Qeperuser, u_7 = ri_3 <= N suchthat defined(k'_1[ri_2, ri_3], ce[ri_2, ri_3], s[ri_3], u_8[ri_2, ri_3]) && (i = u_8[ri_2, ri_3]) && (pkgen(s[ri_3]) = pk_3) && (ce[ri_2, ri_3] = enc_7) then
            r_4: keys_t <- KeySchedule_auth(k'_1[u_6, u_7], info_6);
            nonce_9: nonce_t <- get2(r_4);
            key_8: key_t <- get1(r_4);
            let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
              return(OpenAuth_Some(Context_Open_Some(pt_6)))
            else
              return(OpenAuth_Some(Context_Open_None))
          else
            find u_20 = ri_16 <= Qdperuser suchthat defined(k'_2[ri_16], enc_7[ri_16], pk_3[ri_16]) && (pk_3[ri_16] = pk_3) && (enc_7[ri_16] = enc_7) then
              u_21 <= N <- i;
              r_4: keys_t <- KeySchedule_auth(k'_2[u_20], info_6);
              nonce_9: nonce_t <- get2(r_4);
              key_8: key_t <- get1(r_4);
              let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
            orfind  suchthat defined(k'_3, enc_star, pk_S, i''_1) && (i = i''_1) && (pk_S = pk_3) && (enc_star = enc_7) then
              r_4: keys_t <- KeySchedule_auth(k'_3, info_6);
              nonce_9: nonce_t <- get2(r_4);
              key_8: key_t <- get1(r_4);
              let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
            else
              find u_22 = ri_18 <= N suchthat defined(s[ri_18]) && (pk_3 = pkgen(s[ri_18])) then
                let AuthDecap_Some(k0: kemkey_t) = AuthDecap(enc_7, skgen(s), pk_3) in
                  k'_2 <-R kemkey_t;
                  r_4: keys_t <- KeySchedule_auth(k'_2, info_6);
                  nonce_9: nonce_t <- get2(r_4);
                  key_8: key_t <- get1(r_4);
                  let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                    return(OpenAuth_Some(Context_Open_Some(pt_6)))
                  else
                    return(OpenAuth_Some(Context_Open_None))
                else
                  return(OpenAuth_None)
              else
                let AuthDecap_Some(shared_secret_4: kemkey_t) = AuthDecap(enc_7, skgen(s), pk_3) in
                  r_4: keys_t <- KeySchedule_auth(shared_secret_4, info_6);
                  nonce_9: nonce_t <- get2(r_4);
                  key_8: key_t <- get1(r_4);
                  let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                    return(OpenAuth_Some(Context_Open_Some(pt_6)))
                  else
                    return(OpenAuth_Some(Context_Open_None))
                else
                  return(OpenAuth_None)
        ))
      ) | (
        Ochall(pk_S: pkey_t, pk_R: pkey_t, enc_star: kemciph_t, ciph_star: bitstring, aad_star: bitstring, info_star: bitstring) :=
        find i'_1 = i' <= N, i''_1 = i'' <= N suchthat defined(s[i'], s[i'']) && (pkgen(s[i']) = pk_S) && (pkgen(s[i'']) = pk_R) then
          find u = u_2 <= Qeperuser suchthat defined(info_5[u_2, i'_1], aad_8[u_2, i'_1], ct_8[u_2, i'_1], enc_4[u_2, i'_1], pk_2[u_2, i'_1]) && (pk_2[u_2, i'_1] = pk_R) && (enc_4[u_2, i'_1] = enc_star) && (ct_8[u_2, i'_1] = ciph_star) && (aad_8[u_2, i'_1] = aad_star) && (info_5[u_2, i'_1] = info_star) then
            return(bottom)
          else
            find u_4 = ri <= Qeperuser suchthat defined(k'_1[ri, i'_1], ce[ri, i'_1], u_8[ri, i'_1]) && (i''_1 = u_8[ri, i'_1]) && (ce[ri, i'_1] = enc_star) then
              r_5: keys_t <- KeySchedule_auth(k'_1[u_4, i'_1], info_star);
              nonce_12: nonce_t <- get2(r_5);
              key_10: key_t <- get1(r_5);
              let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                event_abort adv_wins
              else
                return(bottom)
            else
              find u_13 = ri_9 <= Qdperuser suchthat defined(k'_2[ri_9, i''_1], enc_7[ri_9, i''_1], u_22[ri_9, i''_1]) && (u_22[ri_9, i''_1] = i'_1) && (enc_7[ri_9, i''_1] = enc_star) then
                u_14 <= N <- i''_1;
                r_5: keys_t <- KeySchedule_auth(k'_2[u_13, i''_1], info_star);
                nonce_12: nonce_t <- get2(r_5);
                key_10: key_t <- get1(r_5);
                let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                  event_abort adv_wins
                else
                  return(bottom)
              else
                let AuthDecap_Some(k0_1: kemkey_t) = AuthDecap(enc_star, skgen(s[i''_1]), pk_S) in
                  k'_3 <-R kemkey_t;
                  r_5: keys_t <- KeySchedule_auth(k'_3, info_star);
                  nonce_12: nonce_t <- get2(r_5);
                  key_10: key_t <- get1(r_5);
                  let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                    event_abort adv_wins
                  else
                    return(bottom)
                else
                  return(bottom)
        else
          return(bottom)
      ))


Applying remove assignments of findcond
  - Remove assignments on u_14 (definition removed, all usages removed)
  - Remove assignments on u_21 (definition removed, all usages removed)
yields

Game 24 is
      ((
        foreach i <= N do
        Osetup() :=
        s <-R keypairseed_t;
        return(pkgen(s));
        ((
          foreach iae <= Qeperuser do
          Oaenc(pk_2: pkey_t, m: bitstring, aad_8: bitstring, info_5: bitstring) :=
          find u_8 = ri_4 <= N suchthat defined(s[ri_4]) && (pk_2 = pkgen(s[ri_4])) then
            k_3 <-R kemseed_t;
            let AuthEncap_tuple(k_6: kemkey_t, ce_2: kemciph_t) = AuthEncap_r(k_3, pk_2, skgen(s)) in
              ce: kemciph_t <- ce_2;
              enc_4: kemciph_t <- ce_2;
              k'_1 <-R kemkey_t;
              r_3: keys_t <- KeySchedule_auth(k'_1, info_5);
              nonce_6: nonce_t <- get2(r_3);
              key_6: key_t <- get1(r_3);
              ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
              return(SealAuth_Some(ce_2, ct_8))
            else
              let AuthEncap_tuple(k_1: kemkey_t, ce: kemciph_t) = AuthEncap_None in
                enc_4: kemciph_t <- ce;
                k'_1 <-R kemkey_t;
                r_3: keys_t <- KeySchedule_auth(k'_1, info_5);
                nonce_6: nonce_t <- get2(r_3);
                key_6: key_t <- get1(r_3);
                ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
                return(SealAuth_Some(ce, ct_8))
              else
                let AuthEncap_tuple(shared_secret_3: kemkey_t, enc_4: kemciph_t) = AuthEncap_None in
                  r_3: keys_t <- KeySchedule_auth(shared_secret_3, info_5);
                  nonce_6: nonce_t <- get2(r_3);
                  key_6: key_t <- get1(r_3);
                  ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
                  k'_1 <-R kemkey_t;
                  return(SealAuth_Some(enc_4, ct_8))
                else
                  k'_1 <-R kemkey_t;
                  return(SealAuth_None)
          else
            k_2 <-R kemseed_t;
            let AuthEncap_tuple(k_5: kemkey_t, ce_1: kemciph_t) = AuthEncap_r(k_2, pk_2, skgen(s)) in
              enc_4: kemciph_t <- ce_1;
              r_3: keys_t <- KeySchedule_auth(k_5, info_5);
              nonce_6: nonce_t <- get2(r_3);
              key_6: key_t <- get1(r_3);
              ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
              k'_1 <-R kemkey_t;
              return(SealAuth_Some(ce_1, ct_8))
            else
              let AuthEncap_tuple(shared_secret_3: kemkey_t, enc_4: kemciph_t) = AuthEncap_None in
                r_3: keys_t <- KeySchedule_auth(shared_secret_3, info_5);
                nonce_6: nonce_t <- get2(r_3);
                key_6: key_t <- get1(r_3);
                ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
                k'_1 <-R kemkey_t;
                return(SealAuth_Some(enc_4, ct_8))
              else
                k'_1 <-R kemkey_t;
                return(SealAuth_None)
        ) | (
          foreach iad <= Qdperuser do
          Oadec(pk_3: pkey_t, enc_7: kemciph_t, c: bitstring, aad_9: bitstring, info_6: bitstring) :=
          find u_6 = ri_2 <= Qeperuser, u_7 = ri_3 <= N suchthat defined(k'_1[ri_2, ri_3], ce[ri_2, ri_3], s[ri_3], u_8[ri_2, ri_3]) && (i = u_8[ri_2, ri_3]) && (pkgen(s[ri_3]) = pk_3) && (ce[ri_2, ri_3] = enc_7) then
            r_4: keys_t <- KeySchedule_auth(k'_1[u_6, u_7], info_6);
            nonce_9: nonce_t <- get2(r_4);
            key_8: key_t <- get1(r_4);
            let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
              return(OpenAuth_Some(Context_Open_Some(pt_6)))
            else
              return(OpenAuth_Some(Context_Open_None))
          else
            find u_20 = ri_16 <= Qdperuser suchthat defined(k'_2[ri_16], enc_7[ri_16], pk_3[ri_16]) && (pk_3[ri_16] = pk_3) && (enc_7[ri_16] = enc_7) then
              r_4: keys_t <- KeySchedule_auth(k'_2[u_20], info_6);
              nonce_9: nonce_t <- get2(r_4);
              key_8: key_t <- get1(r_4);
              let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
            orfind  suchthat defined(k'_3, enc_star, pk_S, i''_1) && (i = i''_1) && (pk_S = pk_3) && (enc_star = enc_7) then
              r_4: keys_t <- KeySchedule_auth(k'_3, info_6);
              nonce_9: nonce_t <- get2(r_4);
              key_8: key_t <- get1(r_4);
              let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
            else
              find u_22 = ri_18 <= N suchthat defined(s[ri_18]) && (pk_3 = pkgen(s[ri_18])) then
                let AuthDecap_Some(k0: kemkey_t) = AuthDecap(enc_7, skgen(s), pk_3) in
                  k'_2 <-R kemkey_t;
                  r_4: keys_t <- KeySchedule_auth(k'_2, info_6);
                  nonce_9: nonce_t <- get2(r_4);
                  key_8: key_t <- get1(r_4);
                  let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                    return(OpenAuth_Some(Context_Open_Some(pt_6)))
                  else
                    return(OpenAuth_Some(Context_Open_None))
                else
                  return(OpenAuth_None)
              else
                let AuthDecap_Some(shared_secret_4: kemkey_t) = AuthDecap(enc_7, skgen(s), pk_3) in
                  r_4: keys_t <- KeySchedule_auth(shared_secret_4, info_6);
                  nonce_9: nonce_t <- get2(r_4);
                  key_8: key_t <- get1(r_4);
                  let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                    return(OpenAuth_Some(Context_Open_Some(pt_6)))
                  else
                    return(OpenAuth_Some(Context_Open_None))
                else
                  return(OpenAuth_None)
        ))
      ) | (
        Ochall(pk_S: pkey_t, pk_R: pkey_t, enc_star: kemciph_t, ciph_star: bitstring, aad_star: bitstring, info_star: bitstring) :=
        find i'_1 = i' <= N, i''_1 = i'' <= N suchthat defined(s[i'], s[i'']) && (pkgen(s[i']) = pk_S) && (pkgen(s[i'']) = pk_R) then
          find u = u_2 <= Qeperuser suchthat defined(info_5[u_2, i'_1], aad_8[u_2, i'_1], ct_8[u_2, i'_1], enc_4[u_2, i'_1], pk_2[u_2, i'_1]) && (pk_2[u_2, i'_1] = pk_R) && (enc_4[u_2, i'_1] = enc_star) && (ct_8[u_2, i'_1] = ciph_star) && (aad_8[u_2, i'_1] = aad_star) && (info_5[u_2, i'_1] = info_star) then
            return(bottom)
          else
            find u_4 = ri <= Qeperuser suchthat defined(k'_1[ri, i'_1], ce[ri, i'_1], u_8[ri, i'_1]) && (i''_1 = u_8[ri, i'_1]) && (ce[ri, i'_1] = enc_star) then
              r_5: keys_t <- KeySchedule_auth(k'_1[u_4, i'_1], info_star);
              nonce_12: nonce_t <- get2(r_5);
              key_10: key_t <- get1(r_5);
              let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                event_abort adv_wins
              else
                return(bottom)
            else
              find u_13 = ri_9 <= Qdperuser suchthat defined(k'_2[ri_9, i''_1], enc_7[ri_9, i''_1], u_22[ri_9, i''_1]) && (u_22[ri_9, i''_1] = i'_1) && (enc_7[ri_9, i''_1] = enc_star) then
                r_5: keys_t <- KeySchedule_auth(k'_2[u_13, i''_1], info_star);
                nonce_12: nonce_t <- get2(r_5);
                key_10: key_t <- get1(r_5);
                let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                  event_abort adv_wins
                else
                  return(bottom)
              else
                let AuthDecap_Some(k0_1: kemkey_t) = AuthDecap(enc_star, skgen(s[i''_1]), pk_S) in
                  k'_3 <-R kemkey_t;
                  r_5: keys_t <- KeySchedule_auth(k'_3, info_star);
                  nonce_12: nonce_t <- get2(r_5);
                  key_10: key_t <- get1(r_5);
                  let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                    event_abort adv_wins
                  else
                    return(bottom)
                else
                  return(bottom)
        else
          return(bottom)
      ))


Applying equivalence eliminate_failing(AuthEncap)
  - Equivalence eliminate_failing(AuthEncap)
yields

Game 25 is
      ((
        foreach i <= N do
        Osetup() :=
        s <-R keypairseed_t;
        return(pkgen(s));
        ((
          foreach iae <= Qeperuser do
          Oaenc(pk_2: pkey_t, m: bitstring, aad_8: bitstring, info_5: bitstring) :=
          find u_8 = ri_4 <= N suchthat defined(s[ri_4]) && (pk_2 = pkgen(s[ri_4])) then
            k_3 <-R kemseed_t;
  {26}      let AuthEncap_tuple(k_6: kemkey_t, ce_2: kemciph_t) = (k_8: kemseed_t <- k_3; pk_5: pkey_t <- pk_2; sk_2: skey_t <- skgen(s); AuthEncap_tuple(AuthEncap_key_r(k_8, pk_5, sk_2), AuthEncap_enc_r(k_8, pk_5, sk_2))) in
              ce: kemciph_t <- ce_2;
              enc_4: kemciph_t <- ce_2;
              k'_1 <-R kemkey_t;
              r_3: keys_t <- KeySchedule_auth(k'_1, info_5);
              nonce_6: nonce_t <- get2(r_3);
              key_6: key_t <- get1(r_3);
              ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
              return(SealAuth_Some(ce_2, ct_8))
            else
              let AuthEncap_tuple(k_1: kemkey_t, ce: kemciph_t) = AuthEncap_None in
                enc_4: kemciph_t <- ce;
                k'_1 <-R kemkey_t;
                r_3: keys_t <- KeySchedule_auth(k'_1, info_5);
                nonce_6: nonce_t <- get2(r_3);
                key_6: key_t <- get1(r_3);
                ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
                return(SealAuth_Some(ce, ct_8))
              else
                let AuthEncap_tuple(shared_secret_3: kemkey_t, enc_4: kemciph_t) = AuthEncap_None in
                  r_3: keys_t <- KeySchedule_auth(shared_secret_3, info_5);
                  nonce_6: nonce_t <- get2(r_3);
                  key_6: key_t <- get1(r_3);
                  ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
                  k'_1 <-R kemkey_t;
                  return(SealAuth_Some(enc_4, ct_8))
                else
                  k'_1 <-R kemkey_t;
                  return(SealAuth_None)
          else
            k_2 <-R kemseed_t;
 {226}      let AuthEncap_tuple(k_5: kemkey_t, ce_1: kemciph_t) = (k_7: kemseed_t <- k_2; pk_4: pkey_t <- pk_2; sk_1: skey_t <- skgen(s); AuthEncap_tuple(AuthEncap_key_r(k_7, pk_4, sk_1), AuthEncap_enc_r(k_7, pk_4, sk_1))) in
              enc_4: kemciph_t <- ce_1;
              r_3: keys_t <- KeySchedule_auth(k_5, info_5);
              nonce_6: nonce_t <- get2(r_3);
              key_6: key_t <- get1(r_3);
              ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
              k'_1 <-R kemkey_t;
              return(SealAuth_Some(ce_1, ct_8))
            else
              let AuthEncap_tuple(shared_secret_3: kemkey_t, enc_4: kemciph_t) = AuthEncap_None in
                r_3: keys_t <- KeySchedule_auth(shared_secret_3, info_5);
                nonce_6: nonce_t <- get2(r_3);
                key_6: key_t <- get1(r_3);
                ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
                k'_1 <-R kemkey_t;
                return(SealAuth_Some(enc_4, ct_8))
              else
                k'_1 <-R kemkey_t;
                return(SealAuth_None)
        ) | (
          foreach iad <= Qdperuser do
          Oadec(pk_3: pkey_t, enc_7: kemciph_t, c: bitstring, aad_9: bitstring, info_6: bitstring) :=
          find u_6 = ri_2 <= Qeperuser, u_7 = ri_3 <= N suchthat defined(k'_1[ri_2, ri_3], ce[ri_2, ri_3], s[ri_3], u_8[ri_2, ri_3]) && (i = u_8[ri_2, ri_3]) && (pkgen(s[ri_3]) = pk_3) && (ce[ri_2, ri_3] = enc_7) then
            r_4: keys_t <- KeySchedule_auth(k'_1[u_6, u_7], info_6);
            nonce_9: nonce_t <- get2(r_4);
            key_8: key_t <- get1(r_4);
            let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
              return(OpenAuth_Some(Context_Open_Some(pt_6)))
            else
              return(OpenAuth_Some(Context_Open_None))
          else
            find u_20 = ri_16 <= Qdperuser suchthat defined(k'_2[ri_16], enc_7[ri_16], pk_3[ri_16]) && (pk_3[ri_16] = pk_3) && (enc_7[ri_16] = enc_7) then
              r_4: keys_t <- KeySchedule_auth(k'_2[u_20], info_6);
              nonce_9: nonce_t <- get2(r_4);
              key_8: key_t <- get1(r_4);
              let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
            orfind  suchthat defined(k'_3, enc_star, pk_S, i''_1) && (i = i''_1) && (pk_S = pk_3) && (enc_star = enc_7) then
              r_4: keys_t <- KeySchedule_auth(k'_3, info_6);
              nonce_9: nonce_t <- get2(r_4);
              key_8: key_t <- get1(r_4);
              let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
            else
              find u_22 = ri_18 <= N suchthat defined(s[ri_18]) && (pk_3 = pkgen(s[ri_18])) then
                let AuthDecap_Some(k0: kemkey_t) = AuthDecap(enc_7, skgen(s), pk_3) in
                  k'_2 <-R kemkey_t;
                  r_4: keys_t <- KeySchedule_auth(k'_2, info_6);
                  nonce_9: nonce_t <- get2(r_4);
                  key_8: key_t <- get1(r_4);
                  let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                    return(OpenAuth_Some(Context_Open_Some(pt_6)))
                  else
                    return(OpenAuth_Some(Context_Open_None))
                else
                  return(OpenAuth_None)
              else
                let AuthDecap_Some(shared_secret_4: kemkey_t) = AuthDecap(enc_7, skgen(s), pk_3) in
                  r_4: keys_t <- KeySchedule_auth(shared_secret_4, info_6);
                  nonce_9: nonce_t <- get2(r_4);
                  key_8: key_t <- get1(r_4);
                  let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                    return(OpenAuth_Some(Context_Open_Some(pt_6)))
                  else
                    return(OpenAuth_Some(Context_Open_None))
                else
                  return(OpenAuth_None)
        ))
      ) | (
        Ochall(pk_S: pkey_t, pk_R: pkey_t, enc_star: kemciph_t, ciph_star: bitstring, aad_star: bitstring, info_star: bitstring) :=
        find i'_1 = i' <= N, i''_1 = i'' <= N suchthat defined(s[i'], s[i'']) && (pkgen(s[i']) = pk_S) && (pkgen(s[i'']) = pk_R) then
          find u = u_2 <= Qeperuser suchthat defined(info_5[u_2, i'_1], aad_8[u_2, i'_1], ct_8[u_2, i'_1], enc_4[u_2, i'_1], pk_2[u_2, i'_1]) && (pk_2[u_2, i'_1] = pk_R) && (enc_4[u_2, i'_1] = enc_star) && (ct_8[u_2, i'_1] = ciph_star) && (aad_8[u_2, i'_1] = aad_star) && (info_5[u_2, i'_1] = info_star) then
            return(bottom)
          else
            find u_4 = ri <= Qeperuser suchthat defined(k'_1[ri, i'_1], ce[ri, i'_1], u_8[ri, i'_1]) && (i''_1 = u_8[ri, i'_1]) && (ce[ri, i'_1] = enc_star) then
              r_5: keys_t <- KeySchedule_auth(k'_1[u_4, i'_1], info_star);
              nonce_12: nonce_t <- get2(r_5);
              key_10: key_t <- get1(r_5);
              let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                event_abort adv_wins
              else
                return(bottom)
            else
              find u_13 = ri_9 <= Qdperuser suchthat defined(k'_2[ri_9, i''_1], enc_7[ri_9, i''_1], u_22[ri_9, i''_1]) && (u_22[ri_9, i''_1] = i'_1) && (enc_7[ri_9, i''_1] = enc_star) then
                r_5: keys_t <- KeySchedule_auth(k'_2[u_13, i''_1], info_star);
                nonce_12: nonce_t <- get2(r_5);
                key_10: key_t <- get1(r_5);
                let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                  event_abort adv_wins
                else
                  return(bottom)
              else
                let AuthDecap_Some(k0_1: kemkey_t) = AuthDecap(enc_star, skgen(s[i''_1]), pk_S) in
                  k'_3 <-R kemkey_t;
                  r_5: keys_t <- KeySchedule_auth(k'_3, info_star);
                  nonce_12: nonce_t <- get2(r_5);
                  key_10: key_t <- get1(r_5);
                  let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                    event_abort adv_wins
                  else
                    return(bottom)
                else
                  return(bottom)
        else
          return(bottom)
      ))


Applying expand
  - Expand if/find/let
    - Simplify pattern AuthEncap_tuple(k_5: kemkey_t, ce_1: kemciph_t) (tuple expanded) at 226
    - Remove else branch of let at 226
    - Simplify pattern AuthEncap_tuple(k_6: kemkey_t, ce_2: kemciph_t) (tuple expanded) at 26
    - Remove else branch of let at 26
yields

Game 26 is
      ((
        foreach i <= N do
        Osetup() :=
        s <-R keypairseed_t;
        return(pkgen(s));
        ((
          foreach iae <= Qeperuser do
          Oaenc(pk_2: pkey_t, m: bitstring, aad_8: bitstring, info_5: bitstring) :=
          find u_8 = ri_4 <= N suchthat defined(s[ri_4]) && (pk_2 = pkgen(s[ri_4])) then
            k_3 <-R kemseed_t;
            k_8: kemseed_t <- k_3;
            pk_5: pkey_t <- pk_2;
            sk_2: skey_t <- skgen(s);
            ce_2: kemciph_t <- AuthEncap_enc_r(k_8, pk_5, sk_2);
            k_6: kemkey_t <- AuthEncap_key_r(k_8, pk_5, sk_2);
            ce: kemciph_t <- ce_2;
            enc_4: kemciph_t <- ce_2;
            k'_1 <-R kemkey_t;
            r_3: keys_t <- KeySchedule_auth(k'_1, info_5);
            nonce_6: nonce_t <- get2(r_3);
            key_6: key_t <- get1(r_3);
            ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
            return(SealAuth_Some(ce_2, ct_8))
          else
            k_2 <-R kemseed_t;
            k_7: kemseed_t <- k_2;
            pk_4: pkey_t <- pk_2;
            sk_1: skey_t <- skgen(s);
            ce_1: kemciph_t <- AuthEncap_enc_r(k_7, pk_4, sk_1);
            k_5: kemkey_t <- AuthEncap_key_r(k_7, pk_4, sk_1);
            enc_4: kemciph_t <- ce_1;
            r_3: keys_t <- KeySchedule_auth(k_5, info_5);
            nonce_6: nonce_t <- get2(r_3);
            key_6: key_t <- get1(r_3);
            ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
            k'_1 <-R kemkey_t;
            return(SealAuth_Some(ce_1, ct_8))
        ) | (
          foreach iad <= Qdperuser do
          Oadec(pk_3: pkey_t, enc_7: kemciph_t, c: bitstring, aad_9: bitstring, info_6: bitstring) :=
          find u_6 = ri_2 <= Qeperuser, u_7 = ri_3 <= N suchthat defined(k'_1[ri_2, ri_3], ce[ri_2, ri_3], s[ri_3], u_8[ri_2, ri_3]) && (i = u_8[ri_2, ri_3]) && (pkgen(s[ri_3]) = pk_3) && (ce[ri_2, ri_3] = enc_7) then
            r_4: keys_t <- KeySchedule_auth(k'_1[u_6, u_7], info_6);
            nonce_9: nonce_t <- get2(r_4);
            key_8: key_t <- get1(r_4);
            let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
              return(OpenAuth_Some(Context_Open_Some(pt_6)))
            else
              return(OpenAuth_Some(Context_Open_None))
          else
            find u_20 = ri_16 <= Qdperuser suchthat defined(k'_2[ri_16], enc_7[ri_16], pk_3[ri_16]) && (pk_3[ri_16] = pk_3) && (enc_7[ri_16] = enc_7) then
              r_4: keys_t <- KeySchedule_auth(k'_2[u_20], info_6);
              nonce_9: nonce_t <- get2(r_4);
              key_8: key_t <- get1(r_4);
              let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
            orfind  suchthat defined(k'_3, enc_star, pk_S, i''_1) && (i = i''_1) && (pk_S = pk_3) && (enc_star = enc_7) then
              r_4: keys_t <- KeySchedule_auth(k'_3, info_6);
              nonce_9: nonce_t <- get2(r_4);
              key_8: key_t <- get1(r_4);
              let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
            else
              find u_22 = ri_18 <= N suchthat defined(s[ri_18]) && (pk_3 = pkgen(s[ri_18])) then
                let AuthDecap_Some(k0: kemkey_t) = AuthDecap(enc_7, skgen(s), pk_3) in
                  k'_2 <-R kemkey_t;
                  r_4: keys_t <- KeySchedule_auth(k'_2, info_6);
                  nonce_9: nonce_t <- get2(r_4);
                  key_8: key_t <- get1(r_4);
                  let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                    return(OpenAuth_Some(Context_Open_Some(pt_6)))
                  else
                    return(OpenAuth_Some(Context_Open_None))
                else
                  return(OpenAuth_None)
              else
                let AuthDecap_Some(shared_secret_4: kemkey_t) = AuthDecap(enc_7, skgen(s), pk_3) in
                  r_4: keys_t <- KeySchedule_auth(shared_secret_4, info_6);
                  nonce_9: nonce_t <- get2(r_4);
                  key_8: key_t <- get1(r_4);
                  let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                    return(OpenAuth_Some(Context_Open_Some(pt_6)))
                  else
                    return(OpenAuth_Some(Context_Open_None))
                else
                  return(OpenAuth_None)
        ))
      ) | (
        Ochall(pk_S: pkey_t, pk_R: pkey_t, enc_star: kemciph_t, ciph_star: bitstring, aad_star: bitstring, info_star: bitstring) :=
        find i'_1 = i' <= N, i''_1 = i'' <= N suchthat defined(s[i'], s[i'']) && (pkgen(s[i']) = pk_S) && (pkgen(s[i'']) = pk_R) then
          find u = u_2 <= Qeperuser suchthat defined(info_5[u_2, i'_1], aad_8[u_2, i'_1], ct_8[u_2, i'_1], enc_4[u_2, i'_1], pk_2[u_2, i'_1]) && (pk_2[u_2, i'_1] = pk_R) && (enc_4[u_2, i'_1] = enc_star) && (ct_8[u_2, i'_1] = ciph_star) && (aad_8[u_2, i'_1] = aad_star) && (info_5[u_2, i'_1] = info_star) then
            return(bottom)
          else
            find u_4 = ri <= Qeperuser suchthat defined(k'_1[ri, i'_1], ce[ri, i'_1], u_8[ri, i'_1]) && (i''_1 = u_8[ri, i'_1]) && (ce[ri, i'_1] = enc_star) then
              r_5: keys_t <- KeySchedule_auth(k'_1[u_4, i'_1], info_star);
              nonce_12: nonce_t <- get2(r_5);
              key_10: key_t <- get1(r_5);
              let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                event_abort adv_wins
              else
                return(bottom)
            else
              find u_13 = ri_9 <= Qdperuser suchthat defined(k'_2[ri_9, i''_1], enc_7[ri_9, i''_1], u_22[ri_9, i''_1]) && (u_22[ri_9, i''_1] = i'_1) && (enc_7[ri_9, i''_1] = enc_star) then
                r_5: keys_t <- KeySchedule_auth(k'_2[u_13, i''_1], info_star);
                nonce_12: nonce_t <- get2(r_5);
                key_10: key_t <- get1(r_5);
                let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                  event_abort adv_wins
                else
                  return(bottom)
              else
                let AuthDecap_Some(k0_1: kemkey_t) = AuthDecap(enc_star, skgen(s[i''_1]), pk_S) in
                  k'_3 <-R kemkey_t;
                  r_5: keys_t <- KeySchedule_auth(k'_3, info_star);
                  nonce_12: nonce_t <- get2(r_5);
                  key_10: key_t <- get1(r_5);
                  let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                    event_abort adv_wins
                  else
                    return(bottom)
                else
                  return(bottom)
        else
          return(bottom)
      ))


Applying remove assignments of findcond
  - Remove assignments on k_7 (definition removed, all usages removed)
  - Remove assignments on pk_4 (definition removed, all usages removed)
  - Remove assignments on k_8 (definition removed, all usages removed)
  - Remove assignments on pk_5 (definition removed, all usages removed)
  - Remove assignments on k_6 (definition removed, all usages removed)
  - Remove assignments on ce (definition removed, all usages removed)
yields

Game 27 is
      ((
        foreach i <= N do
        Osetup() :=
        s <-R keypairseed_t;
        return(pkgen(s));
        ((
          foreach iae <= Qeperuser do
          Oaenc(pk_2: pkey_t, m: bitstring, aad_8: bitstring, info_5: bitstring) :=
          find u_8 = ri_4 <= N suchthat defined(s[ri_4]) && (pk_2 = pkgen(s[ri_4])) then
            k_3 <-R kemseed_t;
            sk_2: skey_t <- skgen(s);
            ce_2: kemciph_t <- AuthEncap_enc_r(k_3, pk_2, sk_2);
            enc_4: kemciph_t <- ce_2;
            k'_1 <-R kemkey_t;
            r_3: keys_t <- KeySchedule_auth(k'_1, info_5);
            nonce_6: nonce_t <- get2(r_3);
            key_6: key_t <- get1(r_3);
            ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
            return(SealAuth_Some(ce_2, ct_8))
          else
            k_2 <-R kemseed_t;
            sk_1: skey_t <- skgen(s);
            ce_1: kemciph_t <- AuthEncap_enc_r(k_2, pk_2, sk_1);
            k_5: kemkey_t <- AuthEncap_key_r(k_2, pk_2, sk_1);
            enc_4: kemciph_t <- ce_1;
            r_3: keys_t <- KeySchedule_auth(k_5, info_5);
            nonce_6: nonce_t <- get2(r_3);
            key_6: key_t <- get1(r_3);
            ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
            k'_1 <-R kemkey_t;
            return(SealAuth_Some(ce_1, ct_8))
        ) | (
          foreach iad <= Qdperuser do
          Oadec(pk_3: pkey_t, enc_7: kemciph_t, c: bitstring, aad_9: bitstring, info_6: bitstring) :=
          find u_6 = ri_2 <= Qeperuser, u_7 = ri_3 <= N suchthat defined(ce_2[ri_2, ri_3], k'_1[ri_2, ri_3], s[ri_3], u_8[ri_2, ri_3]) && (i = u_8[ri_2, ri_3]) && (pkgen(s[ri_3]) = pk_3) && (ce_2[ri_2, ri_3] = enc_7) then
            r_4: keys_t <- KeySchedule_auth(k'_1[u_6, u_7], info_6);
            nonce_9: nonce_t <- get2(r_4);
            key_8: key_t <- get1(r_4);
            let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
              return(OpenAuth_Some(Context_Open_Some(pt_6)))
            else
              return(OpenAuth_Some(Context_Open_None))
          else
            find u_20 = ri_16 <= Qdperuser suchthat defined(k'_2[ri_16], enc_7[ri_16], pk_3[ri_16]) && (pk_3[ri_16] = pk_3) && (enc_7[ri_16] = enc_7) then
              r_4: keys_t <- KeySchedule_auth(k'_2[u_20], info_6);
              nonce_9: nonce_t <- get2(r_4);
              key_8: key_t <- get1(r_4);
              let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
            orfind  suchthat defined(k'_3, enc_star, pk_S, i''_1) && (i = i''_1) && (pk_S = pk_3) && (enc_star = enc_7) then
              r_4: keys_t <- KeySchedule_auth(k'_3, info_6);
              nonce_9: nonce_t <- get2(r_4);
              key_8: key_t <- get1(r_4);
              let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
            else
              find u_22 = ri_18 <= N suchthat defined(s[ri_18]) && (pk_3 = pkgen(s[ri_18])) then
                let AuthDecap_Some(k0: kemkey_t) = AuthDecap(enc_7, skgen(s), pk_3) in
                  k'_2 <-R kemkey_t;
                  r_4: keys_t <- KeySchedule_auth(k'_2, info_6);
                  nonce_9: nonce_t <- get2(r_4);
                  key_8: key_t <- get1(r_4);
                  let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                    return(OpenAuth_Some(Context_Open_Some(pt_6)))
                  else
                    return(OpenAuth_Some(Context_Open_None))
                else
                  return(OpenAuth_None)
              else
                let AuthDecap_Some(shared_secret_4: kemkey_t) = AuthDecap(enc_7, skgen(s), pk_3) in
                  r_4: keys_t <- KeySchedule_auth(shared_secret_4, info_6);
                  nonce_9: nonce_t <- get2(r_4);
                  key_8: key_t <- get1(r_4);
                  let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                    return(OpenAuth_Some(Context_Open_Some(pt_6)))
                  else
                    return(OpenAuth_Some(Context_Open_None))
                else
                  return(OpenAuth_None)
        ))
      ) | (
        Ochall(pk_S: pkey_t, pk_R: pkey_t, enc_star: kemciph_t, ciph_star: bitstring, aad_star: bitstring, info_star: bitstring) :=
        find i'_1 = i' <= N, i''_1 = i'' <= N suchthat defined(s[i'], s[i'']) && (pkgen(s[i']) = pk_S) && (pkgen(s[i'']) = pk_R) then
          find u = u_2 <= Qeperuser suchthat defined(info_5[u_2, i'_1], aad_8[u_2, i'_1], ct_8[u_2, i'_1], enc_4[u_2, i'_1], pk_2[u_2, i'_1]) && (pk_2[u_2, i'_1] = pk_R) && (enc_4[u_2, i'_1] = enc_star) && (ct_8[u_2, i'_1] = ciph_star) && (aad_8[u_2, i'_1] = aad_star) && (info_5[u_2, i'_1] = info_star) then
            return(bottom)
          else
            find u_4 = ri <= Qeperuser suchthat defined(ce_2[ri, i'_1], k'_1[ri, i'_1], u_8[ri, i'_1]) && (i''_1 = u_8[ri, i'_1]) && (ce_2[ri, i'_1] = enc_star) then
              r_5: keys_t <- KeySchedule_auth(k'_1[u_4, i'_1], info_star);
              nonce_12: nonce_t <- get2(r_5);
              key_10: key_t <- get1(r_5);
              let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                event_abort adv_wins
              else
                return(bottom)
            else
              find u_13 = ri_9 <= Qdperuser suchthat defined(k'_2[ri_9, i''_1], enc_7[ri_9, i''_1], u_22[ri_9, i''_1]) && (u_22[ri_9, i''_1] = i'_1) && (enc_7[ri_9, i''_1] = enc_star) then
                r_5: keys_t <- KeySchedule_auth(k'_2[u_13, i''_1], info_star);
                nonce_12: nonce_t <- get2(r_5);
                key_10: key_t <- get1(r_5);
                let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                  event_abort adv_wins
                else
                  return(bottom)
              else
                let AuthDecap_Some(k0_1: kemkey_t) = AuthDecap(enc_star, skgen(s[i''_1]), pk_S) in
                  k'_3 <-R kemkey_t;
                  r_5: keys_t <- KeySchedule_auth(k'_3, info_star);
                  nonce_12: nonce_t <- get2(r_5);
                  key_10: key_t <- get1(r_5);
                  let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                    event_abort adv_wins
                  else
                    return(bottom)
                else
                  return(bottom)
        else
          return(bottom)
      ))


Applying equivalence prf(KeySchedule_auth) with k'_3, k'_2, k'_1 [probability Adv_PRF_KeySchedule(time_3, 1 + #Oadec + #Oaenc, 1 + Qdperuser + #Oadec + #Oaenc)]
  - Equivalence prf(KeySchedule_auth) with variables: k'_1 -> k_1, k'_2 -> k_1, k'_3 -> k_1
yields

Game 28 is
      ((
        foreach i <= N do
        Osetup() :=
        s <-R keypairseed_t;
        return(pkgen(s));
        ((
          foreach iae <= Qeperuser do
          Oaenc(pk_2: pkey_t, m: bitstring, aad_8: bitstring, info_5: bitstring) :=
          find u_8 = ri_4 <= N suchthat defined(s[ri_4]) && (pk_2 = pkgen(s[ri_4])) then
            k_3 <-R kemseed_t;
            sk_2: skey_t <- skgen(s);
            ce_2: kemciph_t <- AuthEncap_enc_r(k_3, pk_2, sk_2);
            enc_4: kemciph_t <- ce_2;
            k'_1: kemkey_t <- cst_kemkey_t;
            r_3: keys_t <- (x: bitstring <- info_5; {52}find [unique] u_37 = ri_43 <= Qdperuser, u_38 = ri_44 <= N suchthat defined(u_7[ri_43, ri_44], u_6[ri_43, ri_44], x_4[ri_43, ri_44], r_10[ri_43, ri_44]) && {61}((u_6[ri_43, ri_44] = iae) && (u_7[ri_43, ri_44] = i) && (x = x_4[ri_43, ri_44])) then r_10[u_37, u_38] orfind  suchthat defined(i'_1, u_4, x_7, r_13) && {87}((u_4 = iae) && (i'_1 = i) && (x = x_7)) then r_13 else r_6 <-R keys_t; r_6);
            nonce_6: nonce_t <- get2(r_3);
            key_6: key_t <- get1(r_3);
            ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
            return(SealAuth_Some(ce_2, ct_8))
          else
            k_2 <-R kemseed_t;
            sk_1: skey_t <- skgen(s);
            ce_1: kemciph_t <- AuthEncap_enc_r(k_2, pk_2, sk_1);
            k_5: kemkey_t <- AuthEncap_key_r(k_2, pk_2, sk_1);
            enc_4: kemciph_t <- ce_1;
            r_3: keys_t <- KeySchedule_auth(k_5, info_5);
            nonce_6: nonce_t <- get2(r_3);
            key_6: key_t <- get1(r_3);
            ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
            k'_1: kemkey_t <- cst_kemkey_t;
            return(SealAuth_Some(ce_1, ct_8))
        ) | (
          foreach iad <= Qdperuser do
          Oadec(pk_3: pkey_t, enc_7: kemciph_t, c: bitstring, aad_9: bitstring, info_6: bitstring) :=
          find u_6 = ri_2 <= Qeperuser, u_7 = ri_3 <= N suchthat defined(ce_2[ri_2, ri_3], k'_1[ri_2, ri_3], s[ri_3], u_8[ri_2, ri_3]) && (i = u_8[ri_2, ri_3]) && (pkgen(s[ri_3]) = pk_3) && (ce_2[ri_2, ri_3] = enc_7) then
            r_4: keys_t <- (x_4: bitstring <- info_6; find [unique]  suchthat defined(x[u_6, u_7], r_6[u_6, u_7]) && (x_4 = x[u_6, u_7]) then r_6[u_6, u_7] orfind u_35 = ri_39 <= Qdperuser, u_36 = ri_40 <= N suchthat defined(r_10[ri_39, ri_40], x_4[ri_39, ri_40], u_7[ri_39, ri_40], u_6[ri_39, ri_40]) && (u_6[ri_39, ri_40] = u_6) && (u_7[ri_39, ri_40] = u_7) && (x_4 = x_4[ri_39, ri_40]) then r_10[u_35, u_36] orfind  suchthat defined(r_13, x_7, i'_1, u_4) && (u_4 = u_6) && (i'_1 = u_7) && (x_4 = x_7) then r_13 else r_10 <-R keys_t; r_10);
            nonce_9: nonce_t <- get2(r_4);
            key_8: key_t <- get1(r_4);
            let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
              return(OpenAuth_Some(Context_Open_Some(pt_6)))
            else
              return(OpenAuth_Some(Context_Open_None))
          else
            find u_20 = ri_16 <= Qdperuser suchthat defined(k'_2[ri_16], enc_7[ri_16], pk_3[ri_16]) && (pk_3[ri_16] = pk_3) && (enc_7[ri_16] = enc_7) then
              r_4: keys_t <- (x_2: bitstring <- info_6; find [unique]  suchthat defined(x_1[u_20], r_7[u_20]) && (x_2 = x_1[u_20]) then r_7[u_20] orfind u_31 = ri_33 <= Qdperuser, u_32 = ri_34 <= N suchthat defined(r_8[ri_33, ri_34], x_2[ri_33, ri_34], u_20[ri_33, ri_34]) && (u_20[ri_33, ri_34] = u_20) && (ri_34 = i) && (x_2 = x_2[ri_33, ri_34]) then r_8[u_31, u_32] orfind  suchthat defined(r_12, x_6, i''_1, u_13) && (u_13 = u_20) && (i''_1 = i) && (x_2 = x_6) then r_12 else r_8 <-R keys_t; r_8);
              nonce_9: nonce_t <- get2(r_4);
              key_8: key_t <- get1(r_4);
              let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
            orfind  suchthat defined(k'_3, enc_star, pk_S, i''_1) && (i = i''_1) && (pk_S = pk_3) && (enc_star = enc_7) then
              r_4: keys_t <- (x_3: bitstring <- info_6; find [unique] u_33 = ri_37 <= Qdperuser, u_34 = ri_38 <= N suchthat defined(x_3[ri_37, ri_38], r_9[ri_37, ri_38]) && (x_3 = x_3[ri_37, ri_38]) then r_9[u_33, u_34] orfind  suchthat defined(x_5, r_11) && (x_3 = x_5) then r_11 else r_9 <-R keys_t; r_9);
              nonce_9: nonce_t <- get2(r_4);
              key_8: key_t <- get1(r_4);
              let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
            else
              find u_22 = ri_18 <= N suchthat defined(s[ri_18]) && (pk_3 = pkgen(s[ri_18])) then
                let AuthDecap_Some(k0: kemkey_t) = AuthDecap(enc_7, skgen(s), pk_3) in
                  k'_2: kemkey_t <- cst_kemkey_t;
                  r_4: keys_t <- (x_1: bitstring <- info_6; {658}find [unique] u_29 = ri_29 <= Qdperuser, u_30 = ri_30 <= N suchthat defined(u_20[ri_29, ri_30], x_2[ri_29, ri_30], r_8[ri_29, ri_30]) && {665}((u_20[ri_29, ri_30] = iad) && (ri_30 = i) && (x_1 = x_2[ri_29, ri_30])) then r_8[u_29, u_30] orfind  suchthat defined(i''_1, u_13, x_6, r_12) && {689}((u_13 = iad) && (i''_1 = i) && (x_1 = x_6)) then r_12 else r_7 <-R keys_t; r_7);
                  nonce_9: nonce_t <- get2(r_4);
                  key_8: key_t <- get1(r_4);
                  let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                    return(OpenAuth_Some(Context_Open_Some(pt_6)))
                  else
                    return(OpenAuth_Some(Context_Open_None))
                else
                  return(OpenAuth_None)
              else
                let AuthDecap_Some(shared_secret_4: kemkey_t) = AuthDecap(enc_7, skgen(s), pk_3) in
                  r_4: keys_t <- KeySchedule_auth(shared_secret_4, info_6);
                  nonce_9: nonce_t <- get2(r_4);
                  key_8: key_t <- get1(r_4);
                  let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                    return(OpenAuth_Some(Context_Open_Some(pt_6)))
                  else
                    return(OpenAuth_Some(Context_Open_None))
                else
                  return(OpenAuth_None)
        ))
      ) | (
        Ochall(pk_S: pkey_t, pk_R: pkey_t, enc_star: kemciph_t, ciph_star: bitstring, aad_star: bitstring, info_star: bitstring) :=
        find i'_1 = i' <= N, i''_1 = i'' <= N suchthat defined(s[i'], s[i'']) && (pkgen(s[i']) = pk_S) && (pkgen(s[i'']) = pk_R) then
          find u = u_2 <= Qeperuser suchthat defined(info_5[u_2, i'_1], aad_8[u_2, i'_1], ct_8[u_2, i'_1], enc_4[u_2, i'_1], pk_2[u_2, i'_1]) && (pk_2[u_2, i'_1] = pk_R) && (enc_4[u_2, i'_1] = enc_star) && (ct_8[u_2, i'_1] = ciph_star) && (aad_8[u_2, i'_1] = aad_star) && (info_5[u_2, i'_1] = info_star) then
            return(bottom)
          else
            find u_4 = ri <= Qeperuser suchthat defined(ce_2[ri, i'_1], k'_1[ri, i'_1], u_8[ri, i'_1]) && (i''_1 = u_8[ri, i'_1]) && (ce_2[ri, i'_1] = enc_star) then
              r_5: keys_t <- (x_7: bitstring <- info_star; find [unique]  suchthat defined(x[u_4, i'_1], r_6[u_4, i'_1]) && (x_7 = x[u_4, i'_1]) then r_6[u_4, i'_1] orfind u_27 = ri_25 <= Qdperuser, u_28 = ri_26 <= N suchthat defined(r_10[ri_25, ri_26], x_4[ri_25, ri_26], u_7[ri_25, ri_26], u_6[ri_25, ri_26]) && (u_6[ri_25, ri_26] = u_4) && (u_7[ri_25, ri_26] = i'_1) && (x_7 = x_4[ri_25, ri_26]) then r_10[u_27, u_28] else r_13 <-R keys_t; r_13);
              nonce_12: nonce_t <- get2(r_5);
              key_10: key_t <- get1(r_5);
              let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                event_abort adv_wins
              else
                return(bottom)
            else
              find u_13 = ri_9 <= Qdperuser suchthat defined(k'_2[ri_9, i''_1], enc_7[ri_9, i''_1], u_22[ri_9, i''_1]) && (u_22[ri_9, i''_1] = i'_1) && (enc_7[ri_9, i''_1] = enc_star) then
                r_5: keys_t <- (x_6: bitstring <- info_star; find [unique]  suchthat defined(x_1[u_13, i''_1], r_7[u_13, i''_1]) && (x_6 = x_1[u_13, i''_1]) then r_7[u_13, i''_1] orfind u_25 = ri_21 <= Qdperuser, u_26 = ri_22 <= N suchthat defined(r_8[ri_21, ri_22], x_2[ri_21, ri_22], u_20[ri_21, ri_22]) && (u_20[ri_21, ri_22] = u_13) && (ri_22 = i''_1) && (x_6 = x_2[ri_21, ri_22]) then r_8[u_25, u_26] else r_12 <-R keys_t; r_12);
                nonce_12: nonce_t <- get2(r_5);
                key_10: key_t <- get1(r_5);
                let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                  event_abort adv_wins
                else
                  return(bottom)
              else
                let AuthDecap_Some(k0_1: kemkey_t) = AuthDecap(enc_star, skgen(s[i''_1]), pk_S) in
                  k'_3: kemkey_t <- cst_kemkey_t;
                  r_5: keys_t <- (x_5: bitstring <- info_star; {1050}find [unique]  else r_11 <-R keys_t; r_11);
                  nonce_12: nonce_t <- get2(r_5);
                  key_10: key_t <- get1(r_5);
                  let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                    event_abort adv_wins
                  else
                    return(bottom)
                else
                  return(bottom)
        else
          return(bottom)
      ))


Applying simplify (non-expanded game) [probability N^2 * P_pk_coll]
  - Simplification pass
    - Replaced ((u_4 = iae) && (i'_1 = i) && (x = x_7)) with false at 87
    - Remove branch 2 in find at 52
    - Replaced ((u_6[ri_43, ri_44] = iae) && (u_7[ri_43, ri_44] = i) && (x = x_4[ri_43, ri_44])) with false at 61
    - Remove branch 1 in find at 52
    - Find at 52 removed (else branch kept if any)
    - Replaced ((u_13 = iad) && (i''_1 = i) && (x_1 = x_6)) with false at 689
    - Remove branch 2 in find at 658
    - Replaced ((u_20[ri_29, ri_30] = iad) && (ri_30 = i) && (x_1 = x_2[ri_29, ri_30])) with false at 665
    - Remove branch 1 in find at 658
    - Find at 658 removed (else branch kept if any)
    - Find at 1050 removed (else branch kept if any)
yields

Game 29 is
      ((
        foreach i <= N do
        Osetup() :=
        s <-R keypairseed_t;
        return(pkgen(s));
        ((
          foreach iae <= Qeperuser do
          Oaenc(pk_2: pkey_t, m: bitstring, aad_8: bitstring, info_5: bitstring) :=
          find u_8 = ri_4 <= N suchthat defined(s[ri_4]) && (pk_2 = pkgen(s[ri_4])) then
            k_3 <-R kemseed_t;
            sk_2: skey_t <- skgen(s);
            ce_2: kemciph_t <- AuthEncap_enc_r(k_3, pk_2, sk_2);
            enc_4: kemciph_t <- ce_2;
            k'_1: kemkey_t <- cst_kemkey_t;
            r_3: keys_t <- (x: bitstring <- info_5; r_6 <-R keys_t; r_6);
            nonce_6: nonce_t <- get2(r_3);
            key_6: key_t <- get1(r_3);
            ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
            return(SealAuth_Some(ce_2, ct_8))
          else
            k_2 <-R kemseed_t;
            sk_1: skey_t <- skgen(s);
            ce_1: kemciph_t <- AuthEncap_enc_r(k_2, pk_2, sk_1);
            k_5: kemkey_t <- AuthEncap_key_r(k_2, pk_2, sk_1);
            enc_4: kemciph_t <- ce_1;
            r_3: keys_t <- KeySchedule_auth(k_5, info_5);
            nonce_6: nonce_t <- get2(r_3);
            key_6: key_t <- get1(r_3);
            ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
            k'_1: kemkey_t <- cst_kemkey_t;
            return(SealAuth_Some(ce_1, ct_8))
        ) | (
          foreach iad <= Qdperuser do
          Oadec(pk_3: pkey_t, enc_7: kemciph_t, c: bitstring, aad_9: bitstring, info_6: bitstring) :=
          find u_6 = ri_2 <= Qeperuser, u_7 = ri_3 <= N suchthat defined(ce_2[ri_2, ri_3], k'_1[ri_2, ri_3], s[ri_3], u_8[ri_2, ri_3]) && (i = u_8[ri_2, ri_3]) && (pkgen(s[ri_3]) = pk_3) && (ce_2[ri_2, ri_3] = enc_7) then
            r_4: keys_t <- (x_4: bitstring <- info_6; find [unique]  suchthat defined(x[u_6, u_7], r_6[u_6, u_7]) && (x_4 = x[u_6, u_7]) then r_6[u_6, u_7] orfind u_35 = ri_39 <= Qdperuser, u_36 = ri_40 <= N suchthat defined(r_10[ri_39, ri_40], x_4[ri_39, ri_40], u_7[ri_39, ri_40], u_6[ri_39, ri_40]) && (u_6[ri_39, ri_40] = u_6) && (u_7[ri_39, ri_40] = u_7) && (x_4 = x_4[ri_39, ri_40]) then r_10[u_35, u_36] orfind  suchthat defined(r_13, x_7, i'_1, u_4) && (u_4 = u_6) && (i'_1 = u_7) && (x_4 = x_7) then r_13 else r_10 <-R keys_t; r_10);
            nonce_9: nonce_t <- get2(r_4);
            key_8: key_t <- get1(r_4);
            let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
              return(OpenAuth_Some(Context_Open_Some(pt_6)))
            else
              return(OpenAuth_Some(Context_Open_None))
          else
            find u_20 = ri_16 <= Qdperuser suchthat defined(k'_2[ri_16], enc_7[ri_16], pk_3[ri_16]) && (pk_3[ri_16] = pk_3) && (enc_7[ri_16] = enc_7) then
              r_4: keys_t <- (x_2: bitstring <- info_6; find [unique]  suchthat defined(x_1[u_20], r_7[u_20]) && (x_2 = x_1[u_20]) then r_7[u_20] orfind u_31 = ri_33 <= Qdperuser, u_32 = ri_34 <= N suchthat defined(r_8[ri_33, ri_34], x_2[ri_33, ri_34], u_20[ri_33, ri_34]) && (u_20[ri_33, ri_34] = u_20) && (ri_34 = i) && (x_2 = x_2[ri_33, ri_34]) then r_8[u_31, u_32] orfind  suchthat defined(r_12, x_6, i''_1, u_13) && (u_13 = u_20) && (i''_1 = i) && (x_2 = x_6) then r_12 else r_8 <-R keys_t; r_8);
              nonce_9: nonce_t <- get2(r_4);
              key_8: key_t <- get1(r_4);
              let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
            orfind  suchthat defined(k'_3, enc_star, pk_S, i''_1) && (i = i''_1) && (pk_S = pk_3) && (enc_star = enc_7) then
              r_4: keys_t <- (x_3: bitstring <- info_6; find [unique] u_33 = ri_37 <= Qdperuser, u_34 = ri_38 <= N suchthat defined(x_3[ri_37, ri_38], r_9[ri_37, ri_38]) && (x_3 = x_3[ri_37, ri_38]) then r_9[u_33, u_34] orfind  suchthat defined(x_5, r_11) && (x_3 = x_5) then r_11 else r_9 <-R keys_t; r_9);
              nonce_9: nonce_t <- get2(r_4);
              key_8: key_t <- get1(r_4);
              let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
            else
              find u_22 = ri_18 <= N suchthat defined(s[ri_18]) && (pk_3 = pkgen(s[ri_18])) then
                let AuthDecap_Some(k0: kemkey_t) = AuthDecap(enc_7, skgen(s), pk_3) in
                  k'_2: kemkey_t <- cst_kemkey_t;
                  r_4: keys_t <- (x_1: bitstring <- info_6; r_7 <-R keys_t; r_7);
                  nonce_9: nonce_t <- get2(r_4);
                  key_8: key_t <- get1(r_4);
                  let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                    return(OpenAuth_Some(Context_Open_Some(pt_6)))
                  else
                    return(OpenAuth_Some(Context_Open_None))
                else
                  return(OpenAuth_None)
              else
                let AuthDecap_Some(shared_secret_4: kemkey_t) = AuthDecap(enc_7, skgen(s), pk_3) in
                  r_4: keys_t <- KeySchedule_auth(shared_secret_4, info_6);
                  nonce_9: nonce_t <- get2(r_4);
                  key_8: key_t <- get1(r_4);
                  let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                    return(OpenAuth_Some(Context_Open_Some(pt_6)))
                  else
                    return(OpenAuth_Some(Context_Open_None))
                else
                  return(OpenAuth_None)
        ))
      ) | (
        Ochall(pk_S: pkey_t, pk_R: pkey_t, enc_star: kemciph_t, ciph_star: bitstring, aad_star: bitstring, info_star: bitstring) :=
        find i'_1 = i' <= N, i''_1 = i'' <= N suchthat defined(s[i'], s[i'']) && (pkgen(s[i']) = pk_S) && (pkgen(s[i'']) = pk_R) then
          find u = u_2 <= Qeperuser suchthat defined(info_5[u_2, i'_1], aad_8[u_2, i'_1], ct_8[u_2, i'_1], enc_4[u_2, i'_1], pk_2[u_2, i'_1]) && (pk_2[u_2, i'_1] = pk_R) && (enc_4[u_2, i'_1] = enc_star) && (ct_8[u_2, i'_1] = ciph_star) && (aad_8[u_2, i'_1] = aad_star) && (info_5[u_2, i'_1] = info_star) then
            return(bottom)
          else
            find u_4 = ri <= Qeperuser suchthat defined(ce_2[ri, i'_1], k'_1[ri, i'_1], u_8[ri, i'_1]) && (i''_1 = u_8[ri, i'_1]) && (ce_2[ri, i'_1] = enc_star) then
              r_5: keys_t <- (x_7: bitstring <- info_star; find [unique]  suchthat defined(x[u_4, i'_1], r_6[u_4, i'_1]) && (x_7 = x[u_4, i'_1]) then r_6[u_4, i'_1] orfind u_27 = ri_25 <= Qdperuser, u_28 = ri_26 <= N suchthat defined(r_10[ri_25, ri_26], x_4[ri_25, ri_26], u_7[ri_25, ri_26], u_6[ri_25, ri_26]) && (u_6[ri_25, ri_26] = u_4) && (u_7[ri_25, ri_26] = i'_1) && (x_7 = x_4[ri_25, ri_26]) then r_10[u_27, u_28] else r_13 <-R keys_t; r_13);
              nonce_12: nonce_t <- get2(r_5);
              key_10: key_t <- get1(r_5);
              let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                event_abort adv_wins
              else
                return(bottom)
            else
              find u_13 = ri_9 <= Qdperuser suchthat defined(k'_2[ri_9, i''_1], enc_7[ri_9, i''_1], u_22[ri_9, i''_1]) && (u_22[ri_9, i''_1] = i'_1) && (enc_7[ri_9, i''_1] = enc_star) then
                r_5: keys_t <- (x_6: bitstring <- info_star; find [unique]  suchthat defined(x_1[u_13, i''_1], r_7[u_13, i''_1]) && (x_6 = x_1[u_13, i''_1]) then r_7[u_13, i''_1] orfind u_25 = ri_21 <= Qdperuser, u_26 = ri_22 <= N suchthat defined(r_8[ri_21, ri_22], x_2[ri_21, ri_22], u_20[ri_21, ri_22]) && (u_20[ri_21, ri_22] = u_13) && (ri_22 = i''_1) && (x_6 = x_2[ri_21, ri_22]) then r_8[u_25, u_26] else r_12 <-R keys_t; r_12);
                nonce_12: nonce_t <- get2(r_5);
                key_10: key_t <- get1(r_5);
                let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                  event_abort adv_wins
                else
                  return(bottom)
              else
                let AuthDecap_Some(k0_1: kemkey_t) = AuthDecap(enc_star, skgen(s[i''_1]), pk_S) in
                  k'_3: kemkey_t <- cst_kemkey_t;
                  r_5: keys_t <- (x_5: bitstring <- info_star; r_11 <-R keys_t; r_11);
                  nonce_12: nonce_t <- get2(r_5);
                  key_10: key_t <- get1(r_5);
                  let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                    event_abort adv_wins
                  else
                    return(bottom)
                else
                  return(bottom)
        else
          return(bottom)
      ))


Applying expand
  - Expand if/find/let
yields

Game 30 is
      ((
        foreach i <= N do
        Osetup() :=
        s <-R keypairseed_t;
        return(pkgen(s));
        ((
          foreach iae <= Qeperuser do
          Oaenc(pk_2: pkey_t, m: bitstring, aad_8: bitstring, info_5: bitstring) :=
          find u_8 = ri_4 <= N suchthat defined(s[ri_4]) && (pk_2 = pkgen(s[ri_4])) then
            k_3 <-R kemseed_t;
            sk_2: skey_t <- skgen(s);
            ce_2: kemciph_t <- AuthEncap_enc_r(k_3, pk_2, sk_2);
            enc_4: kemciph_t <- ce_2;
            k'_1: kemkey_t <- cst_kemkey_t;
            x: bitstring <- info_5;
            r_6 <-R keys_t;
            r_3: keys_t <- r_6;
            nonce_6: nonce_t <- get2(r_3);
            key_6: key_t <- get1(r_3);
            ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
            return(SealAuth_Some(ce_2, ct_8))
          else
            k_2 <-R kemseed_t;
            sk_1: skey_t <- skgen(s);
            ce_1: kemciph_t <- AuthEncap_enc_r(k_2, pk_2, sk_1);
            k_5: kemkey_t <- AuthEncap_key_r(k_2, pk_2, sk_1);
            enc_4: kemciph_t <- ce_1;
            r_3: keys_t <- KeySchedule_auth(k_5, info_5);
            nonce_6: nonce_t <- get2(r_3);
            key_6: key_t <- get1(r_3);
            ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
            k'_1: kemkey_t <- cst_kemkey_t;
            return(SealAuth_Some(ce_1, ct_8))
        ) | (
          foreach iad <= Qdperuser do
          Oadec(pk_3: pkey_t, enc_7: kemciph_t, c: bitstring, aad_9: bitstring, info_6: bitstring) :=
          find u_6 = ri_2 <= Qeperuser, u_7 = ri_3 <= N suchthat defined(ce_2[ri_2, ri_3], k'_1[ri_2, ri_3], s[ri_3], u_8[ri_2, ri_3]) && (i = u_8[ri_2, ri_3]) && (pkgen(s[ri_3]) = pk_3) && (ce_2[ri_2, ri_3] = enc_7) then
            x_4: bitstring <- info_6;
            find [unique]  suchthat defined(x[u_6, u_7], r_6[u_6, u_7]) && (x_4 = x[u_6, u_7]) then
              r_4: keys_t <- r_6[u_6, u_7];
              nonce_9: nonce_t <- get2(r_4);
              key_8: key_t <- get1(r_4);
              let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
            orfind u_35 = ri_39 <= Qdperuser, u_36 = ri_40 <= N suchthat defined(r_10[ri_39, ri_40], x_4[ri_39, ri_40], u_7[ri_39, ri_40], u_6[ri_39, ri_40]) && (u_6[ri_39, ri_40] = u_6) && (u_7[ri_39, ri_40] = u_7) && (x_4 = x_4[ri_39, ri_40]) then
              r_4: keys_t <- r_10[u_35, u_36];
              nonce_9: nonce_t <- get2(r_4);
              key_8: key_t <- get1(r_4);
              let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
            orfind  suchthat defined(r_13, x_7, i'_1, u_4) && (u_4 = u_6) && (i'_1 = u_7) && (x_4 = x_7) then
              r_4: keys_t <- r_13;
              nonce_9: nonce_t <- get2(r_4);
              key_8: key_t <- get1(r_4);
              let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
            else
              r_10 <-R keys_t;
              r_4: keys_t <- r_10;
              nonce_9: nonce_t <- get2(r_4);
              key_8: key_t <- get1(r_4);
              let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
          else
            find u_20 = ri_16 <= Qdperuser suchthat defined(k'_2[ri_16], enc_7[ri_16], pk_3[ri_16]) && (pk_3[ri_16] = pk_3) && (enc_7[ri_16] = enc_7) then
              x_2: bitstring <- info_6;
              find [unique]  suchthat defined(x_1[u_20], r_7[u_20]) && (x_2 = x_1[u_20]) then
                r_4: keys_t <- r_7[u_20];
                nonce_9: nonce_t <- get2(r_4);
                key_8: key_t <- get1(r_4);
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
              orfind u_31 = ri_33 <= Qdperuser, u_32 = ri_34 <= N suchthat defined(r_8[ri_33, ri_34], x_2[ri_33, ri_34], u_20[ri_33, ri_34]) && (u_20[ri_33, ri_34] = u_20) && (ri_34 = i) && (x_2 = x_2[ri_33, ri_34]) then
                r_4: keys_t <- r_8[u_31, u_32];
                nonce_9: nonce_t <- get2(r_4);
                key_8: key_t <- get1(r_4);
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
              orfind  suchthat defined(r_12, x_6, i''_1, u_13) && (u_13 = u_20) && (i''_1 = i) && (x_2 = x_6) then
                r_4: keys_t <- r_12;
                nonce_9: nonce_t <- get2(r_4);
                key_8: key_t <- get1(r_4);
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
              else
                r_8 <-R keys_t;
                r_4: keys_t <- r_8;
                nonce_9: nonce_t <- get2(r_4);
                key_8: key_t <- get1(r_4);
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
            orfind  suchthat defined(k'_3, enc_star, pk_S, i''_1) && (i = i''_1) && (pk_S = pk_3) && (enc_star = enc_7) then
              x_3: bitstring <- info_6;
              find [unique] u_33 = ri_37 <= Qdperuser, u_34 = ri_38 <= N suchthat defined(x_3[ri_37, ri_38], r_9[ri_37, ri_38]) && (x_3 = x_3[ri_37, ri_38]) then
                r_4: keys_t <- r_9[u_33, u_34];
                nonce_9: nonce_t <- get2(r_4);
                key_8: key_t <- get1(r_4);
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
              orfind  suchthat defined(x_5, r_11) && (x_3 = x_5) then
                r_4: keys_t <- r_11;
                nonce_9: nonce_t <- get2(r_4);
                key_8: key_t <- get1(r_4);
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
              else
                r_9 <-R keys_t;
                r_4: keys_t <- r_9;
                nonce_9: nonce_t <- get2(r_4);
                key_8: key_t <- get1(r_4);
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
            else
              find u_22 = ri_18 <= N suchthat defined(s[ri_18]) && (pk_3 = pkgen(s[ri_18])) then
                let AuthDecap_Some(k0: kemkey_t) = AuthDecap(enc_7, skgen(s), pk_3) in
                  k'_2: kemkey_t <- cst_kemkey_t;
                  x_1: bitstring <- info_6;
                  r_7 <-R keys_t;
                  r_4: keys_t <- r_7;
                  nonce_9: nonce_t <- get2(r_4);
                  key_8: key_t <- get1(r_4);
                  let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                    return(OpenAuth_Some(Context_Open_Some(pt_6)))
                  else
                    return(OpenAuth_Some(Context_Open_None))
                else
                  return(OpenAuth_None)
              else
                let AuthDecap_Some(shared_secret_4: kemkey_t) = AuthDecap(enc_7, skgen(s), pk_3) in
                  r_4: keys_t <- KeySchedule_auth(shared_secret_4, info_6);
                  nonce_9: nonce_t <- get2(r_4);
                  key_8: key_t <- get1(r_4);
                  let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                    return(OpenAuth_Some(Context_Open_Some(pt_6)))
                  else
                    return(OpenAuth_Some(Context_Open_None))
                else
                  return(OpenAuth_None)
        ))
      ) | (
        Ochall(pk_S: pkey_t, pk_R: pkey_t, enc_star: kemciph_t, ciph_star: bitstring, aad_star: bitstring, info_star: bitstring) :=
        find i'_1 = i' <= N, i''_1 = i'' <= N suchthat defined(s[i'], s[i'']) && (pkgen(s[i']) = pk_S) && (pkgen(s[i'']) = pk_R) then
          find u = u_2 <= Qeperuser suchthat defined(info_5[u_2, i'_1], aad_8[u_2, i'_1], ct_8[u_2, i'_1], enc_4[u_2, i'_1], pk_2[u_2, i'_1]) && (pk_2[u_2, i'_1] = pk_R) && (enc_4[u_2, i'_1] = enc_star) && (ct_8[u_2, i'_1] = ciph_star) && (aad_8[u_2, i'_1] = aad_star) && (info_5[u_2, i'_1] = info_star) then
            return(bottom)
          else
            find u_4 = ri <= Qeperuser suchthat defined(ce_2[ri, i'_1], k'_1[ri, i'_1], u_8[ri, i'_1]) && (i''_1 = u_8[ri, i'_1]) && (ce_2[ri, i'_1] = enc_star) then
              x_7: bitstring <- info_star;
              find [unique]  suchthat defined(x[u_4, i'_1], r_6[u_4, i'_1]) && (x_7 = x[u_4, i'_1]) then
                r_5: keys_t <- r_6[u_4, i'_1];
                nonce_12: nonce_t <- get2(r_5);
                key_10: key_t <- get1(r_5);
                let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                  event_abort adv_wins
                else
                  return(bottom)
              orfind u_27 = ri_25 <= Qdperuser, u_28 = ri_26 <= N suchthat defined(r_10[ri_25, ri_26], x_4[ri_25, ri_26], u_7[ri_25, ri_26], u_6[ri_25, ri_26]) && (u_6[ri_25, ri_26] = u_4) && (u_7[ri_25, ri_26] = i'_1) && (x_7 = x_4[ri_25, ri_26]) then
                r_5: keys_t <- r_10[u_27, u_28];
                nonce_12: nonce_t <- get2(r_5);
                key_10: key_t <- get1(r_5);
                let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                  event_abort adv_wins
                else
                  return(bottom)
              else
                r_13 <-R keys_t;
                r_5: keys_t <- r_13;
                nonce_12: nonce_t <- get2(r_5);
                key_10: key_t <- get1(r_5);
                let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                  event_abort adv_wins
                else
                  return(bottom)
            else
              find u_13 = ri_9 <= Qdperuser suchthat defined(k'_2[ri_9, i''_1], enc_7[ri_9, i''_1], u_22[ri_9, i''_1]) && (u_22[ri_9, i''_1] = i'_1) && (enc_7[ri_9, i''_1] = enc_star) then
                x_6: bitstring <- info_star;
                find [unique]  suchthat defined(x_1[u_13, i''_1], r_7[u_13, i''_1]) && (x_6 = x_1[u_13, i''_1]) then
                  r_5: keys_t <- r_7[u_13, i''_1];
                  nonce_12: nonce_t <- get2(r_5);
                  key_10: key_t <- get1(r_5);
                  let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                    event_abort adv_wins
                  else
                    return(bottom)
                orfind u_25 = ri_21 <= Qdperuser, u_26 = ri_22 <= N suchthat defined(r_8[ri_21, ri_22], x_2[ri_21, ri_22], u_20[ri_21, ri_22]) && (u_20[ri_21, ri_22] = u_13) && (ri_22 = i''_1) && (x_6 = x_2[ri_21, ri_22]) then
                  r_5: keys_t <- r_8[u_25, u_26];
                  nonce_12: nonce_t <- get2(r_5);
                  key_10: key_t <- get1(r_5);
                  let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                    event_abort adv_wins
                  else
                    return(bottom)
                else
                  r_12 <-R keys_t;
                  r_5: keys_t <- r_12;
                  nonce_12: nonce_t <- get2(r_5);
                  key_10: key_t <- get1(r_5);
                  let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                    event_abort adv_wins
                  else
                    return(bottom)
              else
                let AuthDecap_Some(k0_1: kemkey_t) = AuthDecap(enc_star, skgen(s[i''_1]), pk_S) in
                  k'_3: kemkey_t <- cst_kemkey_t;
                  x_5: bitstring <- info_star;
                  r_11 <-R keys_t;
                  r_5: keys_t <- r_11;
                  nonce_12: nonce_t <- get2(r_5);
                  key_10: key_t <- get1(r_5);
                  let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                    event_abort adv_wins
                  else
                    return(bottom)
                else
                  return(bottom)
        else
          return(bottom)
      ))


Applying remove assignments of findcond
  - Remove assignments on k'_3 (definition removed, all usages removed)
  - Remove assignments on x_5 (definition removed, all usages removed)
  - Remove assignments on r_5 (definition removed, all usages removed)
  - Remove assignments on x_6 (definition point kept, all usages removed)
  - Remove assignments on r_5 (definition removed, all usages removed)
  - Remove assignments on r_5 (definition removed, all usages removed)
  - Remove assignments on r_5 (definition removed, all usages removed)
  - Remove assignments on x_7 (definition point kept, all usages removed)
  - Remove assignments on r_5 (definition removed, all usages removed)
  - Remove assignments on r_5 (definition removed, all usages removed)
  - Remove assignments on r_5 (definition removed, all usages removed)
  - Remove assignments on k'_2 (definition removed, all usages removed)
  - Remove assignments on x_1 (definition removed, all usages removed)
  - Remove assignments on r_4 (definition removed, all usages removed)
  - Remove assignments on x_2 (definition point kept, all usages removed)
  - Remove assignments on r_4 (definition removed, all usages removed)
  - Remove assignments on r_4 (definition removed, all usages removed)
  - Remove assignments on r_4 (definition removed, all usages removed)
  - Remove assignments on r_4 (definition removed, all usages removed)
  - Remove assignments on x_3 (definition point kept, all usages removed)
  - Remove assignments on r_4 (definition removed, all usages removed)
  - Remove assignments on r_4 (definition removed, all usages removed)
  - Remove assignments on r_4 (definition removed, all usages removed)
  - Remove assignments on x_4 (definition point kept, all usages removed)
  - Remove assignments on r_4 (definition removed, all usages removed)
  - Remove assignments on r_4 (definition removed, all usages removed)
  - Remove assignments on r_4 (definition removed, all usages removed)
  - Remove assignments on r_4 (definition removed, all usages removed)
  - Remove assignments on x (definition removed, all usages removed)
  - Remove assignments on r_3 (definition removed, all usages removed)
yields

Game 31 is
      ((
        foreach i <= N do
        Osetup() :=
        s <-R keypairseed_t;
        return(pkgen(s));
        ((
          foreach iae <= Qeperuser do
          Oaenc(pk_2: pkey_t, m: bitstring, aad_8: bitstring, info_5: bitstring) :=
          find u_8 = ri_4 <= N suchthat defined(s[ri_4]) && (pk_2 = pkgen(s[ri_4])) then
            k_3 <-R kemseed_t;
            sk_2: skey_t <- skgen(s);
            ce_2: kemciph_t <- AuthEncap_enc_r(k_3, pk_2, sk_2);
            enc_4: kemciph_t <- ce_2;
            k'_1: kemkey_t <- cst_kemkey_t;
            r_6 <-R keys_t;
            nonce_6: nonce_t <- get2(r_6);
            key_6: key_t <- get1(r_6);
            ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
            return(SealAuth_Some(ce_2, ct_8))
          else
            k_2 <-R kemseed_t;
            sk_1: skey_t <- skgen(s);
            ce_1: kemciph_t <- AuthEncap_enc_r(k_2, pk_2, sk_1);
            k_5: kemkey_t <- AuthEncap_key_r(k_2, pk_2, sk_1);
            enc_4: kemciph_t <- ce_1;
            r_3: keys_t <- KeySchedule_auth(k_5, info_5);
            nonce_6: nonce_t <- get2(r_3);
            key_6: key_t <- get1(r_3);
            ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
            k'_1: kemkey_t <- cst_kemkey_t;
            return(SealAuth_Some(ce_1, ct_8))
        ) | (
          foreach iad <= Qdperuser do
          Oadec(pk_3: pkey_t, enc_7: kemciph_t, c: bitstring, aad_9: bitstring, info_6: bitstring) :=
 {177}    find u_6 = ri_2 <= Qeperuser, u_7 = ri_3 <= N suchthat defined(ce_2[ri_2, ri_3], k'_1[ri_2, ri_3], s[ri_3], u_8[ri_2, ri_3]) && (i = u_8[ri_2, ri_3]) && (pkgen(s[ri_3]) = pk_3) && (ce_2[ri_2, ri_3] = enc_7) then
            x_4: bitstring <- cst_bitstring;
 {208}      find [unique]  suchthat defined(info_5[u_6, u_7], ce_2[u_6, u_7], r_6[u_6, u_7]) && (info_6 = info_5[u_6, u_7]) then
              nonce_9: nonce_t <- get2(r_6[u_6, u_7]);
              key_8: key_t <- get1(r_6[u_6, u_7]);
              let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
            orfind u_35 = ri_39 <= Qdperuser, u_36 = ri_40 <= N suchthat defined(info_6[ri_39, ri_40], x_4[ri_39, ri_40], r_10[ri_39, ri_40], u_7[ri_39, ri_40], u_6[ri_39, ri_40]) && (u_6[ri_39, ri_40] = u_6) && (u_7[ri_39, ri_40] = u_7) && (info_6 = info_6[ri_39, ri_40]) then
              nonce_9: nonce_t <- get2(r_10[u_35, u_36]);
              key_8: key_t <- get1(r_10[u_35, u_36]);
              let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
            orfind  suchthat defined(info_star, x_7, r_13, i'_1, u_4) && (u_4 = u_6) && (i'_1 = u_7) && (info_6 = info_star) then
              nonce_9: nonce_t <- get2(r_13);
              key_8: key_t <- get1(r_13);
              let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
            else
              r_10 <-R keys_t;
              nonce_9: nonce_t <- get2(r_10);
              key_8: key_t <- get1(r_10);
              let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
          else
 {458}      find u_20 = ri_16 <= Qdperuser suchthat defined(r_7[ri_16], enc_7[ri_16], pk_3[ri_16]) && (pk_3[ri_16] = pk_3) && (enc_7[ri_16] = enc_7) then
              x_2: bitstring <- cst_bitstring;
 {482}        find [unique]  suchthat defined(info_6[u_20], r_7[u_20]) && (info_6 = info_6[u_20]) then
                nonce_9: nonce_t <- get2(r_7[u_20]);
                key_8: key_t <- get1(r_7[u_20]);
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
              orfind u_31 = ri_33 <= Qdperuser, u_32 = ri_34 <= N suchthat defined(info_6[ri_33, ri_34], x_2[ri_33, ri_34], r_8[ri_33, ri_34], u_20[ri_33, ri_34]) && (u_20[ri_33, ri_34] = u_20) && (ri_34 = i) && (info_6 = info_6[ri_33, ri_34]) then
                nonce_9: nonce_t <- get2(r_8[u_31, u_32]);
                key_8: key_t <- get1(r_8[u_31, u_32]);
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
              orfind  suchthat defined(info_star, x_6, r_12, i''_1, u_13) && (u_13 = u_20) && (i''_1 = i) && (info_6 = info_star) then
                nonce_9: nonce_t <- get2(r_12);
                key_8: key_t <- get1(r_12);
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
              else
                r_8 <-R keys_t;
                nonce_9: nonce_t <- get2(r_8);
                key_8: key_t <- get1(r_8);
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
            orfind  suchthat defined(r_11, enc_star, pk_S, i''_1) && (i = i''_1) && (pk_S = pk_3) && (enc_star = enc_7) then
              x_3: bitstring <- cst_bitstring;
 {725}        find [unique] u_33 = ri_37 <= Qdperuser, u_34 = ri_38 <= N suchthat defined(info_6[ri_37, ri_38], x_3[ri_37, ri_38], r_9[ri_37, ri_38]) && (info_6 = info_6[ri_37, ri_38]) then
                nonce_9: nonce_t <- get2(r_9[u_33, u_34]);
                key_8: key_t <- get1(r_9[u_33, u_34]);
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
              orfind  suchthat defined(info_star, r_11) && (info_6 = info_star) then
                nonce_9: nonce_t <- get2(r_11);
                key_8: key_t <- get1(r_11);
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
              else
                r_9 <-R keys_t;
                nonce_9: nonce_t <- get2(r_9);
                key_8: key_t <- get1(r_9);
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
            else
              find u_22 = ri_18 <= N suchthat defined(s[ri_18]) && (pk_3 = pkgen(s[ri_18])) then
                let AuthDecap_Some(k0: kemkey_t) = AuthDecap(enc_7, skgen(s), pk_3) in
                  r_7 <-R keys_t;
                  nonce_9: nonce_t <- get2(r_7);
                  key_8: key_t <- get1(r_7);
                  let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                    return(OpenAuth_Some(Context_Open_Some(pt_6)))
                  else
                    return(OpenAuth_Some(Context_Open_None))
                else
                  return(OpenAuth_None)
              else
                let AuthDecap_Some(shared_secret_4: kemkey_t) = AuthDecap(enc_7, skgen(s), pk_3) in
                  r_4: keys_t <- KeySchedule_auth(shared_secret_4, info_6);
                  nonce_9: nonce_t <- get2(r_4);
                  key_8: key_t <- get1(r_4);
                  let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                    return(OpenAuth_Some(Context_Open_Some(pt_6)))
                  else
                    return(OpenAuth_Some(Context_Open_None))
                else
                  return(OpenAuth_None)
        ))
      ) | (
        Ochall(pk_S: pkey_t, pk_R: pkey_t, enc_star: kemciph_t, ciph_star: bitstring, aad_star: bitstring, info_star: bitstring) :=
        find i'_1 = i' <= N, i''_1 = i'' <= N suchthat defined(s[i'], s[i'']) && (pkgen(s[i']) = pk_S) && (pkgen(s[i'']) = pk_R) then
          find u = u_2 <= Qeperuser suchthat defined(info_5[u_2, i'_1], aad_8[u_2, i'_1], ct_8[u_2, i'_1], enc_4[u_2, i'_1], pk_2[u_2, i'_1]) && (pk_2[u_2, i'_1] = pk_R) && (enc_4[u_2, i'_1] = enc_star) && (ct_8[u_2, i'_1] = ciph_star) && (aad_8[u_2, i'_1] = aad_star) && (info_5[u_2, i'_1] = info_star) then
            return(bottom)
          else
{1053}      find u_4 = ri <= Qeperuser suchthat defined(ce_2[ri, i'_1], k'_1[ri, i'_1], u_8[ri, i'_1]) && (i''_1 = u_8[ri, i'_1]) && (ce_2[ri, i'_1] = enc_star) then
              x_7: bitstring <- cst_bitstring;
{1073}        find [unique]  suchthat defined(info_5[u_4, i'_1], ce_2[u_4, i'_1], r_6[u_4, i'_1]) && (info_star = info_5[u_4, i'_1]) then
                nonce_12: nonce_t <- get2(r_6[u_4, i'_1]);
                key_10: key_t <- get1(r_6[u_4, i'_1]);
                let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                  event_abort adv_wins
                else
                  return(bottom)
              orfind u_27 = ri_25 <= Qdperuser, u_28 = ri_26 <= N suchthat defined(info_6[ri_25, ri_26], x_4[ri_25, ri_26], r_10[ri_25, ri_26], u_7[ri_25, ri_26], u_6[ri_25, ri_26]) && (u_6[ri_25, ri_26] = u_4) && (u_7[ri_25, ri_26] = i'_1) && (info_star = info_6[ri_25, ri_26]) then
                nonce_12: nonce_t <- get2(r_10[u_27, u_28]);
                key_10: key_t <- get1(r_10[u_27, u_28]);
                let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                  event_abort adv_wins
                else
                  return(bottom)
              else
                r_13 <-R keys_t;
                nonce_12: nonce_t <- get2(r_13);
                key_10: key_t <- get1(r_13);
                let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                  event_abort adv_wins
                else
                  return(bottom)
            else
{1179}        find u_13 = ri_9 <= Qdperuser suchthat defined(r_7[ri_9, i''_1], enc_7[ri_9, i''_1], u_22[ri_9, i''_1]) && (u_22[ri_9, i''_1] = i'_1) && (enc_7[ri_9, i''_1] = enc_star) then
                x_6: bitstring <- cst_bitstring;
{1199}          find [unique]  suchthat defined(info_6[u_13, i''_1], r_7[u_13, i''_1]) && (info_star = info_6[u_13, i''_1]) then
                  nonce_12: nonce_t <- get2(r_7[u_13, i''_1]);
                  key_10: key_t <- get1(r_7[u_13, i''_1]);
                  let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                    event_abort adv_wins
                  else
                    return(bottom)
                orfind u_25 = ri_21 <= Qdperuser, u_26 = ri_22 <= N suchthat defined(info_6[ri_21, ri_22], x_2[ri_21, ri_22], r_8[ri_21, ri_22], u_20[ri_21, ri_22]) && (u_20[ri_21, ri_22] = u_13) && (ri_22 = i''_1) && (info_star = info_6[ri_21, ri_22]) then
                  nonce_12: nonce_t <- get2(r_8[u_25, u_26]);
                  key_10: key_t <- get1(r_8[u_25, u_26]);
                  let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                    event_abort adv_wins
                  else
                    return(bottom)
                else
                  r_12 <-R keys_t;
                  nonce_12: nonce_t <- get2(r_12);
                  key_10: key_t <- get1(r_12);
                  let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                    event_abort adv_wins
                  else
                    return(bottom)
              else
                let AuthDecap_Some(k0_1: kemkey_t) = AuthDecap(enc_star, skgen(s[i''_1]), pk_S) in
                  r_11 <-R keys_t;
                  nonce_12: nonce_t <- get2(r_11);
                  key_10: key_t <- get1(r_11);
                  let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                    event_abort adv_wins
                  else
                    return(bottom)
                else
                  return(bottom)
        else
          return(bottom)
      ))


Applying simplify [probability N^2 * P_pk_coll]
  - Simplification pass
    - In branch 2 of find at 1199, substituting u_26 with i''_1
    - Replaced defined condition info_6[ri_21, ri_22], x_2[ri_21, ri_22], r_8[ri_21, ri_22], u_20[ri_21, ri_22] with r_8[ri_21, i''_1], info_6[ri_21, i''_1], u_20[ri_21, i''_1] in find at 1199
    - Replaced defined condition info_6[u_13, i''_1], r_7[u_13, i''_1] with an empty condition in find at 1199
    - Replaced defined condition r_7[ri_9, i''_1], enc_7[ri_9, i''_1], u_22[ri_9, i''_1] with r_7[ri_9, i''_1], info_6[ri_9, i''_1], enc_7[ri_9, i''_1], u_22[ri_9, i''_1] in find at 1179
    - Replaced defined condition info_6[ri_25, ri_26], x_4[ri_25, ri_26], r_10[ri_25, ri_26], u_7[ri_25, ri_26], u_6[ri_25, ri_26] with r_10[ri_25, ri_26], info_6[ri_25, ri_26], u_7[ri_25, ri_26], u_6[ri_25, ri_26] in find at 1073
    - Replaced defined condition info_5[u_4, i'_1], ce_2[u_4, i'_1], r_6[u_4, i'_1] with an empty condition in find at 1073
    - Replaced defined condition ce_2[ri, i'_1], k'_1[ri, i'_1], u_8[ri, i'_1] with r_6[ri, i'_1], info_5[ri, i'_1], ce_2[ri, i'_1], u_8[ri, i'_1] in find at 1053
    - Replaced defined condition info_star, r_11 with an empty condition in find at 725
    - In branch 1 of find at 725, substituting u_34 with i
    - Replaced defined condition info_6[ri_37, ri_38], x_3[ri_37, ri_38], r_9[ri_37, ri_38] with r_9[ri_37], info_6[ri_37] in find at 725
    - Replaced defined condition r_11, enc_star, pk_S, i''_1 with r_11, info_star, enc_star, pk_S, i''_1 in find at 458
    - Replaced defined condition info_star, x_6, r_12, i''_1, u_13 with r_12, info_star, i''_1, u_13 in find at 482
    - In branch 2 of find at 482, substituting u_32 with i
    - Replaced defined condition info_6[ri_33, ri_34], x_2[ri_33, ri_34], r_8[ri_33, ri_34], u_20[ri_33, ri_34] with r_8[ri_33], info_6[ri_33], u_20[ri_33] in find at 482
    - Replaced defined condition info_6[u_20], r_7[u_20] with an empty condition in find at 482
    - Replaced defined condition r_7[ri_16], enc_7[ri_16], pk_3[ri_16] with r_7[ri_16], info_6[ri_16], enc_7[ri_16], pk_3[ri_16] in find at 458
    - Replaced defined condition info_star, x_7, r_13, i'_1, u_4 with r_13, info_star, i'_1, u_4 in find at 208
    - In branch 2 of find at 208, substituting u_36 with i
    - Replaced defined condition info_6[ri_39, ri_40], x_4[ri_39, ri_40], r_10[ri_39, ri_40], u_7[ri_39, ri_40], u_6[ri_39, ri_40] with r_10[ri_39], info_6[ri_39], u_7[ri_39], u_6[ri_39] in find at 208
    - Replaced defined condition info_5[u_6, u_7], ce_2[u_6, u_7], r_6[u_6, u_7] with an empty condition in find at 208
    - Replaced defined condition ce_2[ri_2, ri_3], k'_1[ri_2, ri_3], s[ri_3], u_8[ri_2, ri_3] with r_6[ri_2, ri_3], info_5[ri_2, ri_3], ce_2[ri_2, ri_3], s[ri_3], u_8[ri_2, ri_3] in find at 177
yields

Game 32 is
      ((
        foreach i <= N do
        Osetup() :=
        s <-R keypairseed_t;
        return(pkgen(s));
        ((
          foreach iae <= Qeperuser do
          Oaenc(pk_2: pkey_t, m: bitstring, aad_8: bitstring, info_5: bitstring) :=
          find u_8 = ri_4 <= N suchthat defined(s[ri_4]) && (pk_2 = pkgen(s[ri_4])) then
            k_3 <-R kemseed_t;
            sk_2: skey_t <- skgen(s);
            ce_2: kemciph_t <- AuthEncap_enc_r(k_3, pk_2, sk_2);
            enc_4: kemciph_t <- ce_2;
            k'_1: kemkey_t <- cst_kemkey_t;
            r_6 <-R keys_t;
            nonce_6: nonce_t <- get2(r_6);
            key_6: key_t <- get1(r_6);
            ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
            return(SealAuth_Some(ce_2, ct_8))
          else
            k_2 <-R kemseed_t;
            sk_1: skey_t <- skgen(s);
            ce_1: kemciph_t <- AuthEncap_enc_r(k_2, pk_2, sk_1);
            k_5: kemkey_t <- AuthEncap_key_r(k_2, pk_2, sk_1);
            enc_4: kemciph_t <- ce_1;
            r_3: keys_t <- KeySchedule_auth(k_5, info_5);
            nonce_6: nonce_t <- get2(r_3);
            key_6: key_t <- get1(r_3);
            ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
            k'_1: kemkey_t <- cst_kemkey_t;
            return(SealAuth_Some(ce_1, ct_8))
        ) | (
          foreach iad <= Qdperuser do
          Oadec(pk_3: pkey_t, enc_7: kemciph_t, c: bitstring, aad_9: bitstring, info_6: bitstring) :=
          find u_6 = ri_2 <= Qeperuser, u_7 = ri_3 <= N suchthat defined(r_6[ri_2, ri_3], info_5[ri_2, ri_3], ce_2[ri_2, ri_3], s[ri_3], u_8[ri_2, ri_3]) && (i = u_8[ri_2, ri_3]) && (pkgen(s[ri_3]) = pk_3) && (ce_2[ri_2, ri_3] = enc_7) then
            x_4: bitstring <- cst_bitstring;
            find [unique]  suchthat info_6 = info_5[u_6, u_7] then
              nonce_9: nonce_t <- get2(r_6[u_6, u_7]);
              key_8: key_t <- get1(r_6[u_6, u_7]);
              let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
            orfind u_35 = ri_39 <= Qdperuser suchthat defined(r_10[ri_39], info_6[ri_39], u_7[ri_39], u_6[ri_39]) && (u_6[ri_39] = u_6) && (u_7[ri_39] = u_7) && (info_6 = info_6[ri_39]) then
              u_36 <= N <- i;
              nonce_9: nonce_t <- get2(r_10[u_35]);
              key_8: key_t <- get1(r_10[u_35]);
              let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
            orfind  suchthat defined(r_13, info_star, i'_1, u_4) && (u_4 = u_6) && (i'_1 = u_7) && (info_6 = info_star) then
              nonce_9: nonce_t <- get2(r_13);
              key_8: key_t <- get1(r_13);
              let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
            else
              r_10 <-R keys_t;
              nonce_9: nonce_t <- get2(r_10);
              key_8: key_t <- get1(r_10);
              let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
          else
            find u_20 = ri_16 <= Qdperuser suchthat defined(r_7[ri_16], info_6[ri_16], enc_7[ri_16], pk_3[ri_16]) && (pk_3[ri_16] = pk_3) && (enc_7[ri_16] = enc_7) then
              x_2: bitstring <- cst_bitstring;
              find [unique]  suchthat info_6 = info_6[u_20] then
                nonce_9: nonce_t <- get2(r_7[u_20]);
                key_8: key_t <- get1(r_7[u_20]);
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
              orfind u_31 = ri_33 <= Qdperuser suchthat defined(r_8[ri_33], info_6[ri_33], u_20[ri_33]) && {524}((u_20[ri_33] = u_20) && (i = i) && (info_6 = info_6[ri_33])) then
                u_32 <= N <- i;
                nonce_9: nonce_t <- get2(r_8[u_31]);
                key_8: key_t <- get1(r_8[u_31]);
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
              orfind  suchthat defined(r_12, info_star, i''_1, u_13) && (u_13 = u_20) && (i''_1 = i) && (info_6 = info_star) then
                nonce_9: nonce_t <- get2(r_12);
                key_8: key_t <- get1(r_12);
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
              else
                r_8 <-R keys_t;
                nonce_9: nonce_t <- get2(r_8);
                key_8: key_t <- get1(r_8);
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
            orfind  suchthat defined(r_11, info_star, enc_star, pk_S, i''_1) && (i = i''_1) && (pk_S = pk_3) && (enc_star = enc_7) then
              x_3: bitstring <- cst_bitstring;
              find [unique] u_33 = ri_37 <= Qdperuser suchthat defined(r_9[ri_37], info_6[ri_37]) && (info_6 = info_6[ri_37]) then
                u_34 <= N <- i;
                nonce_9: nonce_t <- get2(r_9[u_33]);
                key_8: key_t <- get1(r_9[u_33]);
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
              orfind  suchthat info_6 = info_star then
                nonce_9: nonce_t <- get2(r_11);
                key_8: key_t <- get1(r_11);
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
              else
                r_9 <-R keys_t;
                nonce_9: nonce_t <- get2(r_9);
                key_8: key_t <- get1(r_9);
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
            else
              find u_22 = ri_18 <= N suchthat defined(s[ri_18]) && (pk_3 = pkgen(s[ri_18])) then
                let AuthDecap_Some(k0: kemkey_t) = AuthDecap(enc_7, skgen(s), pk_3) in
                  r_7 <-R keys_t;
                  nonce_9: nonce_t <- get2(r_7);
                  key_8: key_t <- get1(r_7);
                  let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                    return(OpenAuth_Some(Context_Open_Some(pt_6)))
                  else
                    return(OpenAuth_Some(Context_Open_None))
                else
                  return(OpenAuth_None)
              else
                let AuthDecap_Some(shared_secret_4: kemkey_t) = AuthDecap(enc_7, skgen(s), pk_3) in
                  r_4: keys_t <- KeySchedule_auth(shared_secret_4, info_6);
                  nonce_9: nonce_t <- get2(r_4);
                  key_8: key_t <- get1(r_4);
                  let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                    return(OpenAuth_Some(Context_Open_Some(pt_6)))
                  else
                    return(OpenAuth_Some(Context_Open_None))
                else
                  return(OpenAuth_None)
        ))
      ) | (
        Ochall(pk_S: pkey_t, pk_R: pkey_t, enc_star: kemciph_t, ciph_star: bitstring, aad_star: bitstring, info_star: bitstring) :=
        find i'_1 = i' <= N, i''_1 = i'' <= N suchthat defined(s[i'], s[i'']) && (pkgen(s[i']) = pk_S) && (pkgen(s[i'']) = pk_R) then
          find u = u_2 <= Qeperuser suchthat defined(info_5[u_2, i'_1], aad_8[u_2, i'_1], ct_8[u_2, i'_1], enc_4[u_2, i'_1], pk_2[u_2, i'_1]) && (pk_2[u_2, i'_1] = pk_R) && (enc_4[u_2, i'_1] = enc_star) && (ct_8[u_2, i'_1] = ciph_star) && (aad_8[u_2, i'_1] = aad_star) && (info_5[u_2, i'_1] = info_star) then
            return(bottom)
          else
            find u_4 = ri <= Qeperuser suchthat defined(r_6[ri, i'_1], info_5[ri, i'_1], ce_2[ri, i'_1], u_8[ri, i'_1]) && (i''_1 = u_8[ri, i'_1]) && (ce_2[ri, i'_1] = enc_star) then
              x_7: bitstring <- cst_bitstring;
              find [unique]  suchthat info_star = info_5[u_4, i'_1] then
                nonce_12: nonce_t <- get2(r_6[u_4, i'_1]);
                key_10: key_t <- get1(r_6[u_4, i'_1]);
                let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                  event_abort adv_wins
                else
                  return(bottom)
              orfind u_27 = ri_25 <= Qdperuser, u_28 = ri_26 <= N suchthat defined(r_10[ri_25, ri_26], info_6[ri_25, ri_26], u_7[ri_25, ri_26], u_6[ri_25, ri_26]) && (u_6[ri_25, ri_26] = u_4) && (u_7[ri_25, ri_26] = i'_1) && (info_star = info_6[ri_25, ri_26]) then
                nonce_12: nonce_t <- get2(r_10[u_27, u_28]);
                key_10: key_t <- get1(r_10[u_27, u_28]);
                let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                  event_abort adv_wins
                else
                  return(bottom)
              else
                r_13 <-R keys_t;
                nonce_12: nonce_t <- get2(r_13);
                key_10: key_t <- get1(r_13);
                let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                  event_abort adv_wins
                else
                  return(bottom)
            else
              find u_13 = ri_9 <= Qdperuser suchthat defined(r_7[ri_9, i''_1], info_6[ri_9, i''_1], enc_7[ri_9, i''_1], u_22[ri_9, i''_1]) && (u_22[ri_9, i''_1] = i'_1) && (enc_7[ri_9, i''_1] = enc_star) then
                x_6: bitstring <- cst_bitstring;
                find [unique]  suchthat info_star = info_6[u_13, i''_1] then
                  nonce_12: nonce_t <- get2(r_7[u_13, i''_1]);
                  key_10: key_t <- get1(r_7[u_13, i''_1]);
                  let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                    event_abort adv_wins
                  else
                    return(bottom)
                orfind u_25 = ri_21 <= Qdperuser suchthat defined(r_8[ri_21, i''_1], info_6[ri_21, i''_1], u_20[ri_21, i''_1]) && {1199}((u_20[ri_21, i''_1] = u_13) && (i''_1 = i''_1) && (info_star = info_6[ri_21, i''_1])) then
                  u_26 <= N <- i''_1;
                  nonce_12: nonce_t <- get2(r_8[u_25, i''_1]);
                  key_10: key_t <- get1(r_8[u_25, i''_1]);
                  let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                    event_abort adv_wins
                  else
                    return(bottom)
                else
                  r_12 <-R keys_t;
                  nonce_12: nonce_t <- get2(r_12);
                  key_10: key_t <- get1(r_12);
                  let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                    event_abort adv_wins
                  else
                    return(bottom)
              else
                let AuthDecap_Some(k0_1: kemkey_t) = AuthDecap(enc_star, skgen(s[i''_1]), pk_S) in
                  r_11 <-R keys_t;
                  nonce_12: nonce_t <- get2(r_11);
                  key_10: key_t <- get1(r_11);
                  let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                    event_abort adv_wins
                  else
                    return(bottom)
                else
                  return(bottom)
        else
          return(bottom)
      ))


Applying simplify [probability N^2 * P_pk_coll]
  - Simplification pass
    - Replaced ((u_20[ri_21, i''_1] = u_13) && (i''_1 = i''_1) && (info_star = info_6[ri_21, i''_1])) with ((u_20[ri_21, i''_1] = u_13) && (info_star = info_6[ri_21, i''_1])) at 1199
    - Replaced ((u_20[ri_33] = u_20) && (i = i) && (info_6 = info_6[ri_33])) with ((u_20[ri_33] = u_20) && (info_6 = info_6[ri_33])) at 524
yields

Game 33 is
      ((
        foreach i <= N do
        Osetup() :=
        s <-R keypairseed_t;
        return(pkgen(s));
        ((
          foreach iae <= Qeperuser do
          Oaenc(pk_2: pkey_t, m: bitstring, aad_8: bitstring, info_5: bitstring) :=
          find u_8 = ri_4 <= N suchthat defined(s[ri_4]) && (pk_2 = pkgen(s[ri_4])) then
            k_3 <-R kemseed_t;
            sk_2: skey_t <- skgen(s);
            ce_2: kemciph_t <- AuthEncap_enc_r(k_3, pk_2, sk_2);
            enc_4: kemciph_t <- ce_2;
            k'_1: kemkey_t <- cst_kemkey_t;
            r_6 <-R keys_t;
            nonce_6: nonce_t <- get2(r_6);
            key_6: key_t <- get1(r_6);
            ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
            return(SealAuth_Some(ce_2, ct_8))
          else
            k_2 <-R kemseed_t;
            sk_1: skey_t <- skgen(s);
            ce_1: kemciph_t <- AuthEncap_enc_r(k_2, pk_2, sk_1);
            k_5: kemkey_t <- AuthEncap_key_r(k_2, pk_2, sk_1);
            enc_4: kemciph_t <- ce_1;
            r_3: keys_t <- KeySchedule_auth(k_5, info_5);
            nonce_6: nonce_t <- get2(r_3);
            key_6: key_t <- get1(r_3);
            ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
            k'_1: kemkey_t <- cst_kemkey_t;
            return(SealAuth_Some(ce_1, ct_8))
        ) | (
          foreach iad <= Qdperuser do
          Oadec(pk_3: pkey_t, enc_7: kemciph_t, c: bitstring, aad_9: bitstring, info_6: bitstring) :=
          find u_6 = ri_2 <= Qeperuser, u_7 = ri_3 <= N suchthat defined(r_6[ri_2, ri_3], info_5[ri_2, ri_3], ce_2[ri_2, ri_3], s[ri_3], u_8[ri_2, ri_3]) && (i = u_8[ri_2, ri_3]) && (pkgen(s[ri_3]) = pk_3) && (ce_2[ri_2, ri_3] = enc_7) then
            x_4: bitstring <- cst_bitstring;
            find [unique]  suchthat info_6 = info_5[u_6, u_7] then
              nonce_9: nonce_t <- get2(r_6[u_6, u_7]);
              key_8: key_t <- get1(r_6[u_6, u_7]);
              let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
            orfind u_35 = ri_39 <= Qdperuser suchthat defined(r_10[ri_39], info_6[ri_39], u_7[ri_39], u_6[ri_39]) && (u_6[ri_39] = u_6) && (u_7[ri_39] = u_7) && (info_6 = info_6[ri_39]) then
              u_36 <= N <- i;
              nonce_9: nonce_t <- get2(r_10[u_35]);
              key_8: key_t <- get1(r_10[u_35]);
              let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
            orfind  suchthat defined(r_13, info_star, i'_1, u_4) && (u_4 = u_6) && (i'_1 = u_7) && (info_6 = info_star) then
              nonce_9: nonce_t <- get2(r_13);
              key_8: key_t <- get1(r_13);
              let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
            else
              r_10 <-R keys_t;
              nonce_9: nonce_t <- get2(r_10);
              key_8: key_t <- get1(r_10);
              let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
          else
            find u_20 = ri_16 <= Qdperuser suchthat defined(r_7[ri_16], info_6[ri_16], enc_7[ri_16], pk_3[ri_16]) && (pk_3[ri_16] = pk_3) && (enc_7[ri_16] = enc_7) then
              x_2: bitstring <- cst_bitstring;
              find [unique]  suchthat info_6 = info_6[u_20] then
                nonce_9: nonce_t <- get2(r_7[u_20]);
                key_8: key_t <- get1(r_7[u_20]);
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
              orfind u_31 = ri_33 <= Qdperuser suchthat defined(r_8[ri_33], info_6[ri_33], u_20[ri_33]) && (u_20[ri_33] = u_20) && (info_6 = info_6[ri_33]) then
                u_32 <= N <- i;
                nonce_9: nonce_t <- get2(r_8[u_31]);
                key_8: key_t <- get1(r_8[u_31]);
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
              orfind  suchthat defined(r_12, info_star, i''_1, u_13) && (u_13 = u_20) && (i''_1 = i) && (info_6 = info_star) then
                nonce_9: nonce_t <- get2(r_12);
                key_8: key_t <- get1(r_12);
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
              else
                r_8 <-R keys_t;
                nonce_9: nonce_t <- get2(r_8);
                key_8: key_t <- get1(r_8);
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
            orfind  suchthat defined(r_11, info_star, enc_star, pk_S, i''_1) && (i = i''_1) && (pk_S = pk_3) && (enc_star = enc_7) then
              x_3: bitstring <- cst_bitstring;
              find [unique] u_33 = ri_37 <= Qdperuser suchthat defined(r_9[ri_37], info_6[ri_37]) && (info_6 = info_6[ri_37]) then
                u_34 <= N <- i;
                nonce_9: nonce_t <- get2(r_9[u_33]);
                key_8: key_t <- get1(r_9[u_33]);
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
              orfind  suchthat info_6 = info_star then
                nonce_9: nonce_t <- get2(r_11);
                key_8: key_t <- get1(r_11);
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
              else
                r_9 <-R keys_t;
                nonce_9: nonce_t <- get2(r_9);
                key_8: key_t <- get1(r_9);
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
            else
              find u_22 = ri_18 <= N suchthat defined(s[ri_18]) && (pk_3 = pkgen(s[ri_18])) then
                let AuthDecap_Some(k0: kemkey_t) = AuthDecap(enc_7, skgen(s), pk_3) in
                  r_7 <-R keys_t;
                  nonce_9: nonce_t <- get2(r_7);
                  key_8: key_t <- get1(r_7);
                  let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                    return(OpenAuth_Some(Context_Open_Some(pt_6)))
                  else
                    return(OpenAuth_Some(Context_Open_None))
                else
                  return(OpenAuth_None)
              else
                let AuthDecap_Some(shared_secret_4: kemkey_t) = AuthDecap(enc_7, skgen(s), pk_3) in
                  r_4: keys_t <- KeySchedule_auth(shared_secret_4, info_6);
                  nonce_9: nonce_t <- get2(r_4);
                  key_8: key_t <- get1(r_4);
                  let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                    return(OpenAuth_Some(Context_Open_Some(pt_6)))
                  else
                    return(OpenAuth_Some(Context_Open_None))
                else
                  return(OpenAuth_None)
        ))
      ) | (
        Ochall(pk_S: pkey_t, pk_R: pkey_t, enc_star: kemciph_t, ciph_star: bitstring, aad_star: bitstring, info_star: bitstring) :=
        find i'_1 = i' <= N, i''_1 = i'' <= N suchthat defined(s[i'], s[i'']) && (pkgen(s[i']) = pk_S) && (pkgen(s[i'']) = pk_R) then
          find u = u_2 <= Qeperuser suchthat defined(info_5[u_2, i'_1], aad_8[u_2, i'_1], ct_8[u_2, i'_1], enc_4[u_2, i'_1], pk_2[u_2, i'_1]) && (pk_2[u_2, i'_1] = pk_R) && (enc_4[u_2, i'_1] = enc_star) && (ct_8[u_2, i'_1] = ciph_star) && (aad_8[u_2, i'_1] = aad_star) && (info_5[u_2, i'_1] = info_star) then
            return(bottom)
          else
            find u_4 = ri <= Qeperuser suchthat defined(r_6[ri, i'_1], info_5[ri, i'_1], ce_2[ri, i'_1], u_8[ri, i'_1]) && (i''_1 = u_8[ri, i'_1]) && (ce_2[ri, i'_1] = enc_star) then
              x_7: bitstring <- cst_bitstring;
              find [unique]  suchthat info_star = info_5[u_4, i'_1] then
                nonce_12: nonce_t <- get2(r_6[u_4, i'_1]);
                key_10: key_t <- get1(r_6[u_4, i'_1]);
                let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                  event_abort adv_wins
                else
                  return(bottom)
              orfind u_27 = ri_25 <= Qdperuser, u_28 = ri_26 <= N suchthat defined(r_10[ri_25, ri_26], info_6[ri_25, ri_26], u_7[ri_25, ri_26], u_6[ri_25, ri_26]) && (u_6[ri_25, ri_26] = u_4) && (u_7[ri_25, ri_26] = i'_1) && (info_star = info_6[ri_25, ri_26]) then
                nonce_12: nonce_t <- get2(r_10[u_27, u_28]);
                key_10: key_t <- get1(r_10[u_27, u_28]);
                let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                  event_abort adv_wins
                else
                  return(bottom)
              else
                r_13 <-R keys_t;
                nonce_12: nonce_t <- get2(r_13);
                key_10: key_t <- get1(r_13);
                let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                  event_abort adv_wins
                else
                  return(bottom)
            else
              find u_13 = ri_9 <= Qdperuser suchthat defined(r_7[ri_9, i''_1], info_6[ri_9, i''_1], enc_7[ri_9, i''_1], u_22[ri_9, i''_1]) && (u_22[ri_9, i''_1] = i'_1) && (enc_7[ri_9, i''_1] = enc_star) then
                x_6: bitstring <- cst_bitstring;
                find [unique]  suchthat info_star = info_6[u_13, i''_1] then
                  nonce_12: nonce_t <- get2(r_7[u_13, i''_1]);
                  key_10: key_t <- get1(r_7[u_13, i''_1]);
                  let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                    event_abort adv_wins
                  else
                    return(bottom)
                orfind u_25 = ri_21 <= Qdperuser suchthat defined(r_8[ri_21, i''_1], info_6[ri_21, i''_1], u_20[ri_21, i''_1]) && (u_20[ri_21, i''_1] = u_13) && (info_star = info_6[ri_21, i''_1]) then
                  u_26 <= N <- i''_1;
                  nonce_12: nonce_t <- get2(r_8[u_25, i''_1]);
                  key_10: key_t <- get1(r_8[u_25, i''_1]);
                  let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                    event_abort adv_wins
                  else
                    return(bottom)
                else
                  r_12 <-R keys_t;
                  nonce_12: nonce_t <- get2(r_12);
                  key_10: key_t <- get1(r_12);
                  let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                    event_abort adv_wins
                  else
                    return(bottom)
              else
                let AuthDecap_Some(k0_1: kemkey_t) = AuthDecap(enc_star, skgen(s[i''_1]), pk_S) in
                  r_11 <-R keys_t;
                  nonce_12: nonce_t <- get2(r_11);
                  key_10: key_t <- get1(r_11);
                  let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                    event_abort adv_wins
                  else
                    return(bottom)
                else
                  return(bottom)
        else
          return(bottom)
      ))


Applying move all binders
  - Move assignment to x_6
  - Move assignment to x_7
  - Move assignment to x_2
  - Move assignment to x_3
  - Move assignment to x_4
yields

Game 34 is
      ((
        foreach i <= N do
        Osetup() :=
        s <-R keypairseed_t;
        return(pkgen(s));
        ((
          foreach iae <= Qeperuser do
          Oaenc(pk_2: pkey_t, m: bitstring, aad_8: bitstring, info_5: bitstring) :=
          find u_8 = ri_4 <= N suchthat defined(s[ri_4]) && (pk_2 = pkgen(s[ri_4])) then
            k_3 <-R kemseed_t;
            sk_2: skey_t <- skgen(s);
            ce_2: kemciph_t <- AuthEncap_enc_r(k_3, pk_2, sk_2);
            enc_4: kemciph_t <- ce_2;
            k'_1: kemkey_t <- cst_kemkey_t;
            r_6 <-R keys_t;
            nonce_6: nonce_t <- get2(r_6);
            key_6: key_t <- get1(r_6);
            ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
            return(SealAuth_Some(ce_2, ct_8))
          else
            k_2 <-R kemseed_t;
            sk_1: skey_t <- skgen(s);
            ce_1: kemciph_t <- AuthEncap_enc_r(k_2, pk_2, sk_1);
            k_5: kemkey_t <- AuthEncap_key_r(k_2, pk_2, sk_1);
            enc_4: kemciph_t <- ce_1;
            r_3: keys_t <- KeySchedule_auth(k_5, info_5);
            nonce_6: nonce_t <- get2(r_3);
            key_6: key_t <- get1(r_3);
            ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
            k'_1: kemkey_t <- cst_kemkey_t;
            return(SealAuth_Some(ce_1, ct_8))
        ) | (
          foreach iad <= Qdperuser do
          Oadec(pk_3: pkey_t, enc_7: kemciph_t, c: bitstring, aad_9: bitstring, info_6: bitstring) :=
          find u_6 = ri_2 <= Qeperuser, u_7 = ri_3 <= N suchthat defined(r_6[ri_2, ri_3], info_5[ri_2, ri_3], ce_2[ri_2, ri_3], s[ri_3], u_8[ri_2, ri_3]) && (i = u_8[ri_2, ri_3]) && (pkgen(s[ri_3]) = pk_3) && (ce_2[ri_2, ri_3] = enc_7) then
            find [unique]  suchthat info_6 = info_5[u_6, u_7] then
              nonce_9: nonce_t <- get2(r_6[u_6, u_7]);
              key_8: key_t <- get1(r_6[u_6, u_7]);
              let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
            orfind u_35 = ri_39 <= Qdperuser suchthat defined(r_10[ri_39], info_6[ri_39], u_7[ri_39], u_6[ri_39]) && (u_6[ri_39] = u_6) && (u_7[ri_39] = u_7) && (info_6 = info_6[ri_39]) then
              u_36 <= N <- i;
              nonce_9: nonce_t <- get2(r_10[u_35]);
              key_8: key_t <- get1(r_10[u_35]);
              let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
            orfind  suchthat defined(r_13, info_star, i'_1, u_4) && (u_4 = u_6) && (i'_1 = u_7) && (info_6 = info_star) then
              nonce_9: nonce_t <- get2(r_13);
              key_8: key_t <- get1(r_13);
              let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
            else
              r_10 <-R keys_t;
              nonce_9: nonce_t <- get2(r_10);
              key_8: key_t <- get1(r_10);
              let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
          else
            find u_20 = ri_16 <= Qdperuser suchthat defined(r_7[ri_16], info_6[ri_16], enc_7[ri_16], pk_3[ri_16]) && (pk_3[ri_16] = pk_3) && (enc_7[ri_16] = enc_7) then
              find [unique]  suchthat info_6 = info_6[u_20] then
                nonce_9: nonce_t <- get2(r_7[u_20]);
                key_8: key_t <- get1(r_7[u_20]);
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
              orfind u_31 = ri_33 <= Qdperuser suchthat defined(r_8[ri_33], info_6[ri_33], u_20[ri_33]) && (u_20[ri_33] = u_20) && (info_6 = info_6[ri_33]) then
                u_32 <= N <- i;
                nonce_9: nonce_t <- get2(r_8[u_31]);
                key_8: key_t <- get1(r_8[u_31]);
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
              orfind  suchthat defined(r_12, info_star, i''_1, u_13) && (u_13 = u_20) && (i''_1 = i) && (info_6 = info_star) then
                nonce_9: nonce_t <- get2(r_12);
                key_8: key_t <- get1(r_12);
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
              else
                r_8 <-R keys_t;
                nonce_9: nonce_t <- get2(r_8);
                key_8: key_t <- get1(r_8);
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
            orfind  suchthat defined(r_11, info_star, enc_star, pk_S, i''_1) && (i = i''_1) && (pk_S = pk_3) && (enc_star = enc_7) then
              find [unique] u_33 = ri_37 <= Qdperuser suchthat defined(r_9[ri_37], info_6[ri_37]) && (info_6 = info_6[ri_37]) then
                u_34 <= N <- i;
                nonce_9: nonce_t <- get2(r_9[u_33]);
                key_8: key_t <- get1(r_9[u_33]);
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
              orfind  suchthat info_6 = info_star then
                nonce_9: nonce_t <- get2(r_11);
                key_8: key_t <- get1(r_11);
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
              else
                r_9 <-R keys_t;
                nonce_9: nonce_t <- get2(r_9);
                key_8: key_t <- get1(r_9);
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
            else
              find u_22 = ri_18 <= N suchthat defined(s[ri_18]) && (pk_3 = pkgen(s[ri_18])) then
                let AuthDecap_Some(k0: kemkey_t) = AuthDecap(enc_7, skgen(s), pk_3) in
                  r_7 <-R keys_t;
                  nonce_9: nonce_t <- get2(r_7);
                  key_8: key_t <- get1(r_7);
                  let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                    return(OpenAuth_Some(Context_Open_Some(pt_6)))
                  else
                    return(OpenAuth_Some(Context_Open_None))
                else
                  return(OpenAuth_None)
              else
                let AuthDecap_Some(shared_secret_4: kemkey_t) = AuthDecap(enc_7, skgen(s), pk_3) in
                  r_4: keys_t <- KeySchedule_auth(shared_secret_4, info_6);
                  nonce_9: nonce_t <- get2(r_4);
                  key_8: key_t <- get1(r_4);
                  let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                    return(OpenAuth_Some(Context_Open_Some(pt_6)))
                  else
                    return(OpenAuth_Some(Context_Open_None))
                else
                  return(OpenAuth_None)
        ))
      ) | (
        Ochall(pk_S: pkey_t, pk_R: pkey_t, enc_star: kemciph_t, ciph_star: bitstring, aad_star: bitstring, info_star: bitstring) :=
        find i'_1 = i' <= N, i''_1 = i'' <= N suchthat defined(s[i'], s[i'']) && (pkgen(s[i']) = pk_S) && (pkgen(s[i'']) = pk_R) then
          find u = u_2 <= Qeperuser suchthat defined(info_5[u_2, i'_1], aad_8[u_2, i'_1], ct_8[u_2, i'_1], enc_4[u_2, i'_1], pk_2[u_2, i'_1]) && (pk_2[u_2, i'_1] = pk_R) && (enc_4[u_2, i'_1] = enc_star) && (ct_8[u_2, i'_1] = ciph_star) && (aad_8[u_2, i'_1] = aad_star) && (info_5[u_2, i'_1] = info_star) then
            return(bottom)
          else
            find u_4 = ri <= Qeperuser suchthat defined(r_6[ri, i'_1], info_5[ri, i'_1], ce_2[ri, i'_1], u_8[ri, i'_1]) && (i''_1 = u_8[ri, i'_1]) && (ce_2[ri, i'_1] = enc_star) then
              find [unique]  suchthat info_star = info_5[u_4, i'_1] then
                nonce_12: nonce_t <- get2(r_6[u_4, i'_1]);
                key_10: key_t <- get1(r_6[u_4, i'_1]);
                let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                  event_abort adv_wins
                else
                  return(bottom)
              orfind u_27 = ri_25 <= Qdperuser, u_28 = ri_26 <= N suchthat defined(r_10[ri_25, ri_26], info_6[ri_25, ri_26], u_7[ri_25, ri_26], u_6[ri_25, ri_26]) && (u_6[ri_25, ri_26] = u_4) && (u_7[ri_25, ri_26] = i'_1) && (info_star = info_6[ri_25, ri_26]) then
                nonce_12: nonce_t <- get2(r_10[u_27, u_28]);
                key_10: key_t <- get1(r_10[u_27, u_28]);
                let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                  event_abort adv_wins
                else
                  return(bottom)
              else
                r_13 <-R keys_t;
                nonce_12: nonce_t <- get2(r_13);
                key_10: key_t <- get1(r_13);
                let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                  event_abort adv_wins
                else
                  return(bottom)
            else
              find u_13 = ri_9 <= Qdperuser suchthat defined(r_7[ri_9, i''_1], info_6[ri_9, i''_1], enc_7[ri_9, i''_1], u_22[ri_9, i''_1]) && (u_22[ri_9, i''_1] = i'_1) && (enc_7[ri_9, i''_1] = enc_star) then
                find [unique]  suchthat info_star = info_6[u_13, i''_1] then
                  nonce_12: nonce_t <- get2(r_7[u_13, i''_1]);
                  key_10: key_t <- get1(r_7[u_13, i''_1]);
                  let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                    event_abort adv_wins
                  else
                    return(bottom)
                orfind u_25 = ri_21 <= Qdperuser suchthat defined(r_8[ri_21, i''_1], info_6[ri_21, i''_1], u_20[ri_21, i''_1]) && (u_20[ri_21, i''_1] = u_13) && (info_star = info_6[ri_21, i''_1]) then
                  u_26 <= N <- i''_1;
                  nonce_12: nonce_t <- get2(r_8[u_25, i''_1]);
                  key_10: key_t <- get1(r_8[u_25, i''_1]);
                  let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                    event_abort adv_wins
                  else
                    return(bottom)
                else
                  r_12 <-R keys_t;
                  nonce_12: nonce_t <- get2(r_12);
                  key_10: key_t <- get1(r_12);
                  let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                    event_abort adv_wins
                  else
                    return(bottom)
              else
                let AuthDecap_Some(k0_1: kemkey_t) = AuthDecap(enc_star, skgen(s[i''_1]), pk_S) in
                  r_11 <-R keys_t;
                  nonce_12: nonce_t <- get2(r_11);
                  key_10: key_t <- get1(r_11);
                  let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                    event_abort adv_wins
                  else
                    return(bottom)
                else
                  return(bottom)
        else
          return(bottom)
      ))


Applying remove assignments of findcond
  - Remove assignments on u_26 (definition removed, all usages removed)
  - Remove assignments on u_32 (definition removed, all usages removed)
  - Remove assignments on u_34 (definition removed, all usages removed)
  - Remove assignments on u_36 (definition removed, all usages removed)
  - Remove assignments on k'_1 (definition removed, all usages removed)
  - Remove assignments on k'_1 (definition removed, all usages removed)
yields

Game 35 is
      ((
        foreach i <= N do
        Osetup() :=
        s <-R keypairseed_t;
        return(pkgen(s));
        ((
          foreach iae <= Qeperuser do
          Oaenc(pk_2: pkey_t, m: bitstring, aad_8: bitstring, info_5: bitstring) :=
          find u_8 = ri_4 <= N suchthat defined(s[ri_4]) && (pk_2 = pkgen(s[ri_4])) then
            k_3 <-R kemseed_t;
            sk_2: skey_t <- skgen(s);
            ce_2: kemciph_t <- AuthEncap_enc_r(k_3, pk_2, sk_2);
            enc_4: kemciph_t <- ce_2;
            r_6 <-R keys_t;
            nonce_6: nonce_t <- get2(r_6);
            key_6: key_t <- get1(r_6);
            ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
            return(SealAuth_Some(ce_2, ct_8))
          else
            k_2 <-R kemseed_t;
            sk_1: skey_t <- skgen(s);
            ce_1: kemciph_t <- AuthEncap_enc_r(k_2, pk_2, sk_1);
            k_5: kemkey_t <- AuthEncap_key_r(k_2, pk_2, sk_1);
            enc_4: kemciph_t <- ce_1;
            r_3: keys_t <- KeySchedule_auth(k_5, info_5);
            nonce_6: nonce_t <- get2(r_3);
            key_6: key_t <- get1(r_3);
            ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
            return(SealAuth_Some(ce_1, ct_8))
        ) | (
          foreach iad <= Qdperuser do
          Oadec(pk_3: pkey_t, enc_7: kemciph_t, c: bitstring, aad_9: bitstring, info_6: bitstring) :=
          find u_6 = ri_2 <= Qeperuser, u_7 = ri_3 <= N suchthat defined(r_6[ri_2, ri_3], info_5[ri_2, ri_3], ce_2[ri_2, ri_3], s[ri_3], u_8[ri_2, ri_3]) && (i = u_8[ri_2, ri_3]) && (pkgen(s[ri_3]) = pk_3) && (ce_2[ri_2, ri_3] = enc_7) then
            find [unique]  suchthat info_6 = info_5[u_6, u_7] then
              nonce_9: nonce_t <- get2(r_6[u_6, u_7]);
              key_8: key_t <- get1(r_6[u_6, u_7]);
              let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
            orfind u_35 = ri_39 <= Qdperuser suchthat defined(r_10[ri_39], info_6[ri_39], u_7[ri_39], u_6[ri_39]) && (u_6[ri_39] = u_6) && (u_7[ri_39] = u_7) && (info_6 = info_6[ri_39]) then
              nonce_9: nonce_t <- get2(r_10[u_35]);
              key_8: key_t <- get1(r_10[u_35]);
              let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
            orfind  suchthat defined(r_13, info_star, i'_1, u_4) && (u_4 = u_6) && (i'_1 = u_7) && (info_6 = info_star) then
              nonce_9: nonce_t <- get2(r_13);
              key_8: key_t <- get1(r_13);
              let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
            else
              r_10 <-R keys_t;
              nonce_9: nonce_t <- get2(r_10);
              key_8: key_t <- get1(r_10);
              let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
          else
            find u_20 = ri_16 <= Qdperuser suchthat defined(r_7[ri_16], info_6[ri_16], enc_7[ri_16], pk_3[ri_16]) && (pk_3[ri_16] = pk_3) && (enc_7[ri_16] = enc_7) then
              find [unique]  suchthat info_6 = info_6[u_20] then
                nonce_9: nonce_t <- get2(r_7[u_20]);
                key_8: key_t <- get1(r_7[u_20]);
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
              orfind u_31 = ri_33 <= Qdperuser suchthat defined(r_8[ri_33], info_6[ri_33], u_20[ri_33]) && (u_20[ri_33] = u_20) && (info_6 = info_6[ri_33]) then
                nonce_9: nonce_t <- get2(r_8[u_31]);
                key_8: key_t <- get1(r_8[u_31]);
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
              orfind  suchthat defined(r_12, info_star, i''_1, u_13) && (u_13 = u_20) && (i''_1 = i) && (info_6 = info_star) then
                nonce_9: nonce_t <- get2(r_12);
                key_8: key_t <- get1(r_12);
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
              else
                r_8 <-R keys_t;
                nonce_9: nonce_t <- get2(r_8);
                key_8: key_t <- get1(r_8);
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
            orfind  suchthat defined(r_11, info_star, enc_star, pk_S, i''_1) && (i = i''_1) && (pk_S = pk_3) && (enc_star = enc_7) then
              find [unique] u_33 = ri_37 <= Qdperuser suchthat defined(r_9[ri_37], info_6[ri_37]) && (info_6 = info_6[ri_37]) then
                nonce_9: nonce_t <- get2(r_9[u_33]);
                key_8: key_t <- get1(r_9[u_33]);
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
              orfind  suchthat info_6 = info_star then
                nonce_9: nonce_t <- get2(r_11);
                key_8: key_t <- get1(r_11);
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
              else
                r_9 <-R keys_t;
                nonce_9: nonce_t <- get2(r_9);
                key_8: key_t <- get1(r_9);
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
            else
              find u_22 = ri_18 <= N suchthat defined(s[ri_18]) && (pk_3 = pkgen(s[ri_18])) then
                let AuthDecap_Some(k0: kemkey_t) = AuthDecap(enc_7, skgen(s), pk_3) in
                  r_7 <-R keys_t;
                  nonce_9: nonce_t <- get2(r_7);
                  key_8: key_t <- get1(r_7);
                  let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                    return(OpenAuth_Some(Context_Open_Some(pt_6)))
                  else
                    return(OpenAuth_Some(Context_Open_None))
                else
                  return(OpenAuth_None)
              else
                let AuthDecap_Some(shared_secret_4: kemkey_t) = AuthDecap(enc_7, skgen(s), pk_3) in
                  r_4: keys_t <- KeySchedule_auth(shared_secret_4, info_6);
                  nonce_9: nonce_t <- get2(r_4);
                  key_8: key_t <- get1(r_4);
                  let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                    return(OpenAuth_Some(Context_Open_Some(pt_6)))
                  else
                    return(OpenAuth_Some(Context_Open_None))
                else
                  return(OpenAuth_None)
        ))
      ) | (
        Ochall(pk_S: pkey_t, pk_R: pkey_t, enc_star: kemciph_t, ciph_star: bitstring, aad_star: bitstring, info_star: bitstring) :=
        find i'_1 = i' <= N, i''_1 = i'' <= N suchthat defined(s[i'], s[i'']) && (pkgen(s[i']) = pk_S) && (pkgen(s[i'']) = pk_R) then
          find u = u_2 <= Qeperuser suchthat defined(info_5[u_2, i'_1], aad_8[u_2, i'_1], ct_8[u_2, i'_1], enc_4[u_2, i'_1], pk_2[u_2, i'_1]) && (pk_2[u_2, i'_1] = pk_R) && (enc_4[u_2, i'_1] = enc_star) && (ct_8[u_2, i'_1] = ciph_star) && (aad_8[u_2, i'_1] = aad_star) && (info_5[u_2, i'_1] = info_star) then
            return(bottom)
          else
            find u_4 = ri <= Qeperuser suchthat defined(r_6[ri, i'_1], info_5[ri, i'_1], ce_2[ri, i'_1], u_8[ri, i'_1]) && (i''_1 = u_8[ri, i'_1]) && (ce_2[ri, i'_1] = enc_star) then
              find [unique]  suchthat info_star = info_5[u_4, i'_1] then
                nonce_12: nonce_t <- get2(r_6[u_4, i'_1]);
                key_10: key_t <- get1(r_6[u_4, i'_1]);
                let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                  event_abort adv_wins
                else
                  return(bottom)
              orfind u_27 = ri_25 <= Qdperuser, u_28 = ri_26 <= N suchthat defined(r_10[ri_25, ri_26], info_6[ri_25, ri_26], u_7[ri_25, ri_26], u_6[ri_25, ri_26]) && (u_6[ri_25, ri_26] = u_4) && (u_7[ri_25, ri_26] = i'_1) && (info_star = info_6[ri_25, ri_26]) then
                nonce_12: nonce_t <- get2(r_10[u_27, u_28]);
                key_10: key_t <- get1(r_10[u_27, u_28]);
                let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                  event_abort adv_wins
                else
                  return(bottom)
              else
                r_13 <-R keys_t;
                nonce_12: nonce_t <- get2(r_13);
                key_10: key_t <- get1(r_13);
                let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                  event_abort adv_wins
                else
                  return(bottom)
            else
              find u_13 = ri_9 <= Qdperuser suchthat defined(r_7[ri_9, i''_1], info_6[ri_9, i''_1], enc_7[ri_9, i''_1], u_22[ri_9, i''_1]) && (u_22[ri_9, i''_1] = i'_1) && (enc_7[ri_9, i''_1] = enc_star) then
                find [unique]  suchthat info_star = info_6[u_13, i''_1] then
                  nonce_12: nonce_t <- get2(r_7[u_13, i''_1]);
                  key_10: key_t <- get1(r_7[u_13, i''_1]);
                  let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                    event_abort adv_wins
                  else
                    return(bottom)
                orfind u_25 = ri_21 <= Qdperuser suchthat defined(r_8[ri_21, i''_1], info_6[ri_21, i''_1], u_20[ri_21, i''_1]) && (u_20[ri_21, i''_1] = u_13) && (info_star = info_6[ri_21, i''_1]) then
                  nonce_12: nonce_t <- get2(r_8[u_25, i''_1]);
                  key_10: key_t <- get1(r_8[u_25, i''_1]);
                  let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                    event_abort adv_wins
                  else
                    return(bottom)
                else
                  r_12 <-R keys_t;
                  nonce_12: nonce_t <- get2(r_12);
                  key_10: key_t <- get1(r_12);
                  let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                    event_abort adv_wins
                  else
                    return(bottom)
              else
                let AuthDecap_Some(k0_1: kemkey_t) = AuthDecap(enc_star, skgen(s[i''_1]), pk_S) in
                  r_11 <-R keys_t;
                  nonce_12: nonce_t <- get2(r_11);
                  key_10: key_t <- get1(r_11);
                  let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                    event_abort adv_wins
                  else
                    return(bottom)
                else
                  return(bottom)
        else
          return(bottom)
      ))


Applying equivalence splitter(split)
  - Equivalence splitter(split) with variables: r_11 -> r
yields

Game 36 is
      ((
        foreach i <= N do
        Osetup() :=
        s <-R keypairseed_t;
        return(pkgen(s));
        ((
          foreach iae <= Qeperuser do
          Oaenc(pk_2: pkey_t, m: bitstring, aad_8: bitstring, info_5: bitstring) :=
          find u_8 = ri_4 <= N suchthat defined(s[ri_4]) && (pk_2 = pkgen(s[ri_4])) then
            k_3 <-R kemseed_t;
            sk_2: skey_t <- skgen(s);
            ce_2: kemciph_t <- AuthEncap_enc_r(k_3, pk_2, sk_2);
            enc_4: kemciph_t <- ce_2;
            r_6 <-R keys_t;
            nonce_6: nonce_t <- get2(r_6);
            key_6: key_t <- get1(r_6);
            ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
            return(SealAuth_Some(ce_2, ct_8))
          else
            k_2 <-R kemseed_t;
            sk_1: skey_t <- skgen(s);
            ce_1: kemciph_t <- AuthEncap_enc_r(k_2, pk_2, sk_1);
            k_5: kemkey_t <- AuthEncap_key_r(k_2, pk_2, sk_1);
            enc_4: kemciph_t <- ce_1;
            r_3: keys_t <- KeySchedule_auth(k_5, info_5);
            nonce_6: nonce_t <- get2(r_3);
            key_6: key_t <- get1(r_3);
            ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
            return(SealAuth_Some(ce_1, ct_8))
        ) | (
          foreach iad <= Qdperuser do
          Oadec(pk_3: pkey_t, enc_7: kemciph_t, c: bitstring, aad_9: bitstring, info_6: bitstring) :=
          find u_6 = ri_2 <= Qeperuser, u_7 = ri_3 <= N suchthat defined(r_6[ri_2, ri_3], info_5[ri_2, ri_3], ce_2[ri_2, ri_3], s[ri_3], u_8[ri_2, ri_3]) && (i = u_8[ri_2, ri_3]) && (pkgen(s[ri_3]) = pk_3) && (ce_2[ri_2, ri_3] = enc_7) then
            find [unique]  suchthat info_6 = info_5[u_6, u_7] then
              nonce_9: nonce_t <- get2(r_6[u_6, u_7]);
              key_8: key_t <- get1(r_6[u_6, u_7]);
              let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
            orfind u_35 = ri_39 <= Qdperuser suchthat defined(r_10[ri_39], info_6[ri_39], u_7[ri_39], u_6[ri_39]) && (u_6[ri_39] = u_6) && (u_7[ri_39] = u_7) && (info_6 = info_6[ri_39]) then
              nonce_9: nonce_t <- get2(r_10[u_35]);
              key_8: key_t <- get1(r_10[u_35]);
              let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
            orfind  suchthat defined(r_13, info_star, i'_1, u_4) && (u_4 = u_6) && (i'_1 = u_7) && (info_6 = info_star) then
              nonce_9: nonce_t <- get2(r_13);
              key_8: key_t <- get1(r_13);
              let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
            else
              r_10 <-R keys_t;
              nonce_9: nonce_t <- get2(r_10);
              key_8: key_t <- get1(r_10);
              let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
          else
            find u_20 = ri_16 <= Qdperuser suchthat defined(r_7[ri_16], info_6[ri_16], enc_7[ri_16], pk_3[ri_16]) && (pk_3[ri_16] = pk_3) && (enc_7[ri_16] = enc_7) then
              find [unique]  suchthat info_6 = info_6[u_20] then
                nonce_9: nonce_t <- get2(r_7[u_20]);
                key_8: key_t <- get1(r_7[u_20]);
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
              orfind u_31 = ri_33 <= Qdperuser suchthat defined(r_8[ri_33], info_6[ri_33], u_20[ri_33]) && (u_20[ri_33] = u_20) && (info_6 = info_6[ri_33]) then
                nonce_9: nonce_t <- get2(r_8[u_31]);
                key_8: key_t <- get1(r_8[u_31]);
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
              orfind  suchthat defined(r_12, info_star, i''_1, u_13) && (u_13 = u_20) && (i''_1 = i) && (info_6 = info_star) then
                nonce_9: nonce_t <- get2(r_12);
                key_8: key_t <- get1(r_12);
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
              else
                r_8 <-R keys_t;
                nonce_9: nonce_t <- get2(r_8);
                key_8: key_t <- get1(r_8);
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
            orfind  suchthat defined(part2, part1, r_11, info_star, enc_star, pk_S, i''_1) && (i = i''_1) && (pk_S = pk_3) && (enc_star = enc_7) then
              find [unique] u_33 = ri_37 <= Qdperuser suchthat defined(r_9[ri_37], info_6[ri_37]) && (info_6 = info_6[ri_37]) then
                nonce_9: nonce_t <- get2(r_9[u_33]);
                key_8: key_t <- get1(r_9[u_33]);
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
              orfind  suchthat info_6 = info_star then
                nonce_9: nonce_t <- part2;
                key_8: key_t <- part1;
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
              else
                r_9 <-R keys_t;
                nonce_9: nonce_t <- get2(r_9);
                key_8: key_t <- get1(r_9);
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
            else
              find u_22 = ri_18 <= N suchthat defined(s[ri_18]) && (pk_3 = pkgen(s[ri_18])) then
                let AuthDecap_Some(k0: kemkey_t) = AuthDecap(enc_7, skgen(s), pk_3) in
                  r_7 <-R keys_t;
                  nonce_9: nonce_t <- get2(r_7);
                  key_8: key_t <- get1(r_7);
                  let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                    return(OpenAuth_Some(Context_Open_Some(pt_6)))
                  else
                    return(OpenAuth_Some(Context_Open_None))
                else
                  return(OpenAuth_None)
              else
                let AuthDecap_Some(shared_secret_4: kemkey_t) = AuthDecap(enc_7, skgen(s), pk_3) in
                  r_4: keys_t <- KeySchedule_auth(shared_secret_4, info_6);
                  nonce_9: nonce_t <- get2(r_4);
                  key_8: key_t <- get1(r_4);
                  let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                    return(OpenAuth_Some(Context_Open_Some(pt_6)))
                  else
                    return(OpenAuth_Some(Context_Open_None))
                else
                  return(OpenAuth_None)
        ))
      ) | (
        Ochall(pk_S: pkey_t, pk_R: pkey_t, enc_star: kemciph_t, ciph_star: bitstring, aad_star: bitstring, info_star: bitstring) :=
        find i'_1 = i' <= N, i''_1 = i'' <= N suchthat defined(s[i'], s[i'']) && (pkgen(s[i']) = pk_S) && (pkgen(s[i'']) = pk_R) then
          find u = u_2 <= Qeperuser suchthat defined(info_5[u_2, i'_1], aad_8[u_2, i'_1], ct_8[u_2, i'_1], enc_4[u_2, i'_1], pk_2[u_2, i'_1]) && (pk_2[u_2, i'_1] = pk_R) && (enc_4[u_2, i'_1] = enc_star) && (ct_8[u_2, i'_1] = ciph_star) && (aad_8[u_2, i'_1] = aad_star) && (info_5[u_2, i'_1] = info_star) then
            return(bottom)
          else
            find u_4 = ri <= Qeperuser suchthat defined(r_6[ri, i'_1], info_5[ri, i'_1], ce_2[ri, i'_1], u_8[ri, i'_1]) && (i''_1 = u_8[ri, i'_1]) && (ce_2[ri, i'_1] = enc_star) then
              find [unique]  suchthat info_star = info_5[u_4, i'_1] then
                nonce_12: nonce_t <- get2(r_6[u_4, i'_1]);
                key_10: key_t <- get1(r_6[u_4, i'_1]);
                let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                  event_abort adv_wins
                else
                  return(bottom)
              orfind u_27 = ri_25 <= Qdperuser, u_28 = ri_26 <= N suchthat defined(r_10[ri_25, ri_26], info_6[ri_25, ri_26], u_7[ri_25, ri_26], u_6[ri_25, ri_26]) && (u_6[ri_25, ri_26] = u_4) && (u_7[ri_25, ri_26] = i'_1) && (info_star = info_6[ri_25, ri_26]) then
                nonce_12: nonce_t <- get2(r_10[u_27, u_28]);
                key_10: key_t <- get1(r_10[u_27, u_28]);
                let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                  event_abort adv_wins
                else
                  return(bottom)
              else
                r_13 <-R keys_t;
                nonce_12: nonce_t <- get2(r_13);
                key_10: key_t <- get1(r_13);
                let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                  event_abort adv_wins
                else
                  return(bottom)
            else
              find u_13 = ri_9 <= Qdperuser suchthat defined(r_7[ri_9, i''_1], info_6[ri_9, i''_1], enc_7[ri_9, i''_1], u_22[ri_9, i''_1]) && (u_22[ri_9, i''_1] = i'_1) && (enc_7[ri_9, i''_1] = enc_star) then
                find [unique]  suchthat info_star = info_6[u_13, i''_1] then
                  nonce_12: nonce_t <- get2(r_7[u_13, i''_1]);
                  key_10: key_t <- get1(r_7[u_13, i''_1]);
                  let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                    event_abort adv_wins
                  else
                    return(bottom)
                orfind u_25 = ri_21 <= Qdperuser suchthat defined(r_8[ri_21, i''_1], info_6[ri_21, i''_1], u_20[ri_21, i''_1]) && (u_20[ri_21, i''_1] = u_13) && (info_star = info_6[ri_21, i''_1]) then
                  nonce_12: nonce_t <- get2(r_8[u_25, i''_1]);
                  key_10: key_t <- get1(r_8[u_25, i''_1]);
                  let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                    event_abort adv_wins
                  else
                    return(bottom)
                else
                  r_12 <-R keys_t;
                  nonce_12: nonce_t <- get2(r_12);
                  key_10: key_t <- get1(r_12);
                  let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                    event_abort adv_wins
                  else
                    return(bottom)
              else
                let AuthDecap_Some(k0_1: kemkey_t) = AuthDecap(enc_star, skgen(s[i''_1]), pk_S) in
                  part2 <-R nonce_t;
                  part1 <-R key_t;
                  r_11: keys_t <- cst_keys_t;
                  nonce_12: nonce_t <- part2;
                  key_10: key_t <- part1;
                  let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                    event_abort adv_wins
                  else
                    return(bottom)
                else
                  return(bottom)
        else
          return(bottom)
      ))


Applying equivalence splitter(split)
  - Equivalence splitter(split) with variables: r_12 -> r
yields

Game 37 is
      ((
        foreach i <= N do
        Osetup() :=
        s <-R keypairseed_t;
        return(pkgen(s));
        ((
          foreach iae <= Qeperuser do
          Oaenc(pk_2: pkey_t, m: bitstring, aad_8: bitstring, info_5: bitstring) :=
          find u_8 = ri_4 <= N suchthat defined(s[ri_4]) && (pk_2 = pkgen(s[ri_4])) then
            k_3 <-R kemseed_t;
            sk_2: skey_t <- skgen(s);
            ce_2: kemciph_t <- AuthEncap_enc_r(k_3, pk_2, sk_2);
            enc_4: kemciph_t <- ce_2;
            r_6 <-R keys_t;
            nonce_6: nonce_t <- get2(r_6);
            key_6: key_t <- get1(r_6);
            ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
            return(SealAuth_Some(ce_2, ct_8))
          else
            k_2 <-R kemseed_t;
            sk_1: skey_t <- skgen(s);
            ce_1: kemciph_t <- AuthEncap_enc_r(k_2, pk_2, sk_1);
            k_5: kemkey_t <- AuthEncap_key_r(k_2, pk_2, sk_1);
            enc_4: kemciph_t <- ce_1;
            r_3: keys_t <- KeySchedule_auth(k_5, info_5);
            nonce_6: nonce_t <- get2(r_3);
            key_6: key_t <- get1(r_3);
            ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
            return(SealAuth_Some(ce_1, ct_8))
        ) | (
          foreach iad <= Qdperuser do
          Oadec(pk_3: pkey_t, enc_7: kemciph_t, c: bitstring, aad_9: bitstring, info_6: bitstring) :=
          find u_6 = ri_2 <= Qeperuser, u_7 = ri_3 <= N suchthat defined(r_6[ri_2, ri_3], info_5[ri_2, ri_3], ce_2[ri_2, ri_3], s[ri_3], u_8[ri_2, ri_3]) && (i = u_8[ri_2, ri_3]) && (pkgen(s[ri_3]) = pk_3) && (ce_2[ri_2, ri_3] = enc_7) then
            find [unique]  suchthat info_6 = info_5[u_6, u_7] then
              nonce_9: nonce_t <- get2(r_6[u_6, u_7]);
              key_8: key_t <- get1(r_6[u_6, u_7]);
              let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
            orfind u_35 = ri_39 <= Qdperuser suchthat defined(r_10[ri_39], info_6[ri_39], u_7[ri_39], u_6[ri_39]) && (u_6[ri_39] = u_6) && (u_7[ri_39] = u_7) && (info_6 = info_6[ri_39]) then
              nonce_9: nonce_t <- get2(r_10[u_35]);
              key_8: key_t <- get1(r_10[u_35]);
              let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
            orfind  suchthat defined(r_13, info_star, i'_1, u_4) && (u_4 = u_6) && (i'_1 = u_7) && (info_6 = info_star) then
              nonce_9: nonce_t <- get2(r_13);
              key_8: key_t <- get1(r_13);
              let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
            else
              r_10 <-R keys_t;
              nonce_9: nonce_t <- get2(r_10);
              key_8: key_t <- get1(r_10);
              let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
          else
            find u_20 = ri_16 <= Qdperuser suchthat defined(r_7[ri_16], info_6[ri_16], enc_7[ri_16], pk_3[ri_16]) && (pk_3[ri_16] = pk_3) && (enc_7[ri_16] = enc_7) then
              find [unique]  suchthat info_6 = info_6[u_20] then
                nonce_9: nonce_t <- get2(r_7[u_20]);
                key_8: key_t <- get1(r_7[u_20]);
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
              orfind u_31 = ri_33 <= Qdperuser suchthat defined(r_8[ri_33], info_6[ri_33], u_20[ri_33]) && (u_20[ri_33] = u_20) && (info_6 = info_6[ri_33]) then
                nonce_9: nonce_t <- get2(r_8[u_31]);
                key_8: key_t <- get1(r_8[u_31]);
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
              orfind  suchthat defined(part2_1, part1_1, r_12, info_star, i''_1, u_13) && (u_13 = u_20) && (i''_1 = i) && (info_6 = info_star) then
                nonce_9: nonce_t <- part2_1;
                key_8: key_t <- part1_1;
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
              else
                r_8 <-R keys_t;
                nonce_9: nonce_t <- get2(r_8);
                key_8: key_t <- get1(r_8);
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
            orfind  suchthat defined(part2, part1, r_11, info_star, enc_star, pk_S, i''_1) && (i = i''_1) && (pk_S = pk_3) && (enc_star = enc_7) then
              find [unique] u_33 = ri_37 <= Qdperuser suchthat defined(r_9[ri_37], info_6[ri_37]) && (info_6 = info_6[ri_37]) then
                nonce_9: nonce_t <- get2(r_9[u_33]);
                key_8: key_t <- get1(r_9[u_33]);
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
              orfind  suchthat info_6 = info_star then
                nonce_9: nonce_t <- part2;
                key_8: key_t <- part1;
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
              else
                r_9 <-R keys_t;
                nonce_9: nonce_t <- get2(r_9);
                key_8: key_t <- get1(r_9);
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
            else
              find u_22 = ri_18 <= N suchthat defined(s[ri_18]) && (pk_3 = pkgen(s[ri_18])) then
                let AuthDecap_Some(k0: kemkey_t) = AuthDecap(enc_7, skgen(s), pk_3) in
                  r_7 <-R keys_t;
                  nonce_9: nonce_t <- get2(r_7);
                  key_8: key_t <- get1(r_7);
                  let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                    return(OpenAuth_Some(Context_Open_Some(pt_6)))
                  else
                    return(OpenAuth_Some(Context_Open_None))
                else
                  return(OpenAuth_None)
              else
                let AuthDecap_Some(shared_secret_4: kemkey_t) = AuthDecap(enc_7, skgen(s), pk_3) in
                  r_4: keys_t <- KeySchedule_auth(shared_secret_4, info_6);
                  nonce_9: nonce_t <- get2(r_4);
                  key_8: key_t <- get1(r_4);
                  let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                    return(OpenAuth_Some(Context_Open_Some(pt_6)))
                  else
                    return(OpenAuth_Some(Context_Open_None))
                else
                  return(OpenAuth_None)
        ))
      ) | (
        Ochall(pk_S: pkey_t, pk_R: pkey_t, enc_star: kemciph_t, ciph_star: bitstring, aad_star: bitstring, info_star: bitstring) :=
        find i'_1 = i' <= N, i''_1 = i'' <= N suchthat defined(s[i'], s[i'']) && (pkgen(s[i']) = pk_S) && (pkgen(s[i'']) = pk_R) then
          find u = u_2 <= Qeperuser suchthat defined(info_5[u_2, i'_1], aad_8[u_2, i'_1], ct_8[u_2, i'_1], enc_4[u_2, i'_1], pk_2[u_2, i'_1]) && (pk_2[u_2, i'_1] = pk_R) && (enc_4[u_2, i'_1] = enc_star) && (ct_8[u_2, i'_1] = ciph_star) && (aad_8[u_2, i'_1] = aad_star) && (info_5[u_2, i'_1] = info_star) then
            return(bottom)
          else
            find u_4 = ri <= Qeperuser suchthat defined(r_6[ri, i'_1], info_5[ri, i'_1], ce_2[ri, i'_1], u_8[ri, i'_1]) && (i''_1 = u_8[ri, i'_1]) && (ce_2[ri, i'_1] = enc_star) then
              find [unique]  suchthat info_star = info_5[u_4, i'_1] then
                nonce_12: nonce_t <- get2(r_6[u_4, i'_1]);
                key_10: key_t <- get1(r_6[u_4, i'_1]);
                let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                  event_abort adv_wins
                else
                  return(bottom)
              orfind u_27 = ri_25 <= Qdperuser, u_28 = ri_26 <= N suchthat defined(r_10[ri_25, ri_26], info_6[ri_25, ri_26], u_7[ri_25, ri_26], u_6[ri_25, ri_26]) && (u_6[ri_25, ri_26] = u_4) && (u_7[ri_25, ri_26] = i'_1) && (info_star = info_6[ri_25, ri_26]) then
                nonce_12: nonce_t <- get2(r_10[u_27, u_28]);
                key_10: key_t <- get1(r_10[u_27, u_28]);
                let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                  event_abort adv_wins
                else
                  return(bottom)
              else
                r_13 <-R keys_t;
                nonce_12: nonce_t <- get2(r_13);
                key_10: key_t <- get1(r_13);
                let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                  event_abort adv_wins
                else
                  return(bottom)
            else
              find u_13 = ri_9 <= Qdperuser suchthat defined(r_7[ri_9, i''_1], info_6[ri_9, i''_1], enc_7[ri_9, i''_1], u_22[ri_9, i''_1]) && (u_22[ri_9, i''_1] = i'_1) && (enc_7[ri_9, i''_1] = enc_star) then
                find [unique]  suchthat info_star = info_6[u_13, i''_1] then
                  nonce_12: nonce_t <- get2(r_7[u_13, i''_1]);
                  key_10: key_t <- get1(r_7[u_13, i''_1]);
                  let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                    event_abort adv_wins
                  else
                    return(bottom)
                orfind u_25 = ri_21 <= Qdperuser suchthat defined(r_8[ri_21, i''_1], info_6[ri_21, i''_1], u_20[ri_21, i''_1]) && (u_20[ri_21, i''_1] = u_13) && (info_star = info_6[ri_21, i''_1]) then
                  nonce_12: nonce_t <- get2(r_8[u_25, i''_1]);
                  key_10: key_t <- get1(r_8[u_25, i''_1]);
                  let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                    event_abort adv_wins
                  else
                    return(bottom)
                else
                  part2_1 <-R nonce_t;
                  part1_1 <-R key_t;
                  r_12: keys_t <- cst_keys_t;
                  nonce_12: nonce_t <- part2_1;
                  key_10: key_t <- part1_1;
                  let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                    event_abort adv_wins
                  else
                    return(bottom)
              else
                let AuthDecap_Some(k0_1: kemkey_t) = AuthDecap(enc_star, skgen(s[i''_1]), pk_S) in
                  part2 <-R nonce_t;
                  part1 <-R key_t;
                  r_11: keys_t <- cst_keys_t;
                  nonce_12: nonce_t <- part2;
                  key_10: key_t <- part1;
                  let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                    event_abort adv_wins
                  else
                    return(bottom)
                else
                  return(bottom)
        else
          return(bottom)
      ))


Applying equivalence splitter(split)
  - Equivalence splitter(split) with variables: r_13 -> r
yields

Game 38 is
      ((
        foreach i <= N do
        Osetup() :=
        s <-R keypairseed_t;
        return(pkgen(s));
        ((
          foreach iae <= Qeperuser do
          Oaenc(pk_2: pkey_t, m: bitstring, aad_8: bitstring, info_5: bitstring) :=
          find u_8 = ri_4 <= N suchthat defined(s[ri_4]) && (pk_2 = pkgen(s[ri_4])) then
            k_3 <-R kemseed_t;
            sk_2: skey_t <- skgen(s);
            ce_2: kemciph_t <- AuthEncap_enc_r(k_3, pk_2, sk_2);
            enc_4: kemciph_t <- ce_2;
            r_6 <-R keys_t;
            nonce_6: nonce_t <- get2(r_6);
            key_6: key_t <- get1(r_6);
            ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
            return(SealAuth_Some(ce_2, ct_8))
          else
            k_2 <-R kemseed_t;
            sk_1: skey_t <- skgen(s);
            ce_1: kemciph_t <- AuthEncap_enc_r(k_2, pk_2, sk_1);
            k_5: kemkey_t <- AuthEncap_key_r(k_2, pk_2, sk_1);
            enc_4: kemciph_t <- ce_1;
            r_3: keys_t <- KeySchedule_auth(k_5, info_5);
            nonce_6: nonce_t <- get2(r_3);
            key_6: key_t <- get1(r_3);
            ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
            return(SealAuth_Some(ce_1, ct_8))
        ) | (
          foreach iad <= Qdperuser do
          Oadec(pk_3: pkey_t, enc_7: kemciph_t, c: bitstring, aad_9: bitstring, info_6: bitstring) :=
          find u_6 = ri_2 <= Qeperuser, u_7 = ri_3 <= N suchthat defined(r_6[ri_2, ri_3], info_5[ri_2, ri_3], ce_2[ri_2, ri_3], s[ri_3], u_8[ri_2, ri_3]) && (i = u_8[ri_2, ri_3]) && (pkgen(s[ri_3]) = pk_3) && (ce_2[ri_2, ri_3] = enc_7) then
            find [unique]  suchthat info_6 = info_5[u_6, u_7] then
              nonce_9: nonce_t <- get2(r_6[u_6, u_7]);
              key_8: key_t <- get1(r_6[u_6, u_7]);
              let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
            orfind u_35 = ri_39 <= Qdperuser suchthat defined(r_10[ri_39], info_6[ri_39], u_7[ri_39], u_6[ri_39]) && (u_6[ri_39] = u_6) && (u_7[ri_39] = u_7) && (info_6 = info_6[ri_39]) then
              nonce_9: nonce_t <- get2(r_10[u_35]);
              key_8: key_t <- get1(r_10[u_35]);
              let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
            orfind  suchthat defined(part2_2, part1_2, r_13, info_star, i'_1, u_4) && (u_4 = u_6) && (i'_1 = u_7) && (info_6 = info_star) then
              nonce_9: nonce_t <- part2_2;
              key_8: key_t <- part1_2;
              let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
            else
              r_10 <-R keys_t;
              nonce_9: nonce_t <- get2(r_10);
              key_8: key_t <- get1(r_10);
              let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
          else
            find u_20 = ri_16 <= Qdperuser suchthat defined(r_7[ri_16], info_6[ri_16], enc_7[ri_16], pk_3[ri_16]) && (pk_3[ri_16] = pk_3) && (enc_7[ri_16] = enc_7) then
              find [unique]  suchthat info_6 = info_6[u_20] then
                nonce_9: nonce_t <- get2(r_7[u_20]);
                key_8: key_t <- get1(r_7[u_20]);
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
              orfind u_31 = ri_33 <= Qdperuser suchthat defined(r_8[ri_33], info_6[ri_33], u_20[ri_33]) && (u_20[ri_33] = u_20) && (info_6 = info_6[ri_33]) then
                nonce_9: nonce_t <- get2(r_8[u_31]);
                key_8: key_t <- get1(r_8[u_31]);
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
              orfind  suchthat defined(part2_1, part1_1, r_12, info_star, i''_1, u_13) && (u_13 = u_20) && (i''_1 = i) && (info_6 = info_star) then
                nonce_9: nonce_t <- part2_1;
                key_8: key_t <- part1_1;
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
              else
                r_8 <-R keys_t;
                nonce_9: nonce_t <- get2(r_8);
                key_8: key_t <- get1(r_8);
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
            orfind  suchthat defined(part2, part1, r_11, info_star, enc_star, pk_S, i''_1) && (i = i''_1) && (pk_S = pk_3) && (enc_star = enc_7) then
              find [unique] u_33 = ri_37 <= Qdperuser suchthat defined(r_9[ri_37], info_6[ri_37]) && (info_6 = info_6[ri_37]) then
                nonce_9: nonce_t <- get2(r_9[u_33]);
                key_8: key_t <- get1(r_9[u_33]);
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
              orfind  suchthat info_6 = info_star then
                nonce_9: nonce_t <- part2;
                key_8: key_t <- part1;
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
              else
                r_9 <-R keys_t;
                nonce_9: nonce_t <- get2(r_9);
                key_8: key_t <- get1(r_9);
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
            else
              find u_22 = ri_18 <= N suchthat defined(s[ri_18]) && (pk_3 = pkgen(s[ri_18])) then
                let AuthDecap_Some(k0: kemkey_t) = AuthDecap(enc_7, skgen(s), pk_3) in
                  r_7 <-R keys_t;
                  nonce_9: nonce_t <- get2(r_7);
                  key_8: key_t <- get1(r_7);
                  let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                    return(OpenAuth_Some(Context_Open_Some(pt_6)))
                  else
                    return(OpenAuth_Some(Context_Open_None))
                else
                  return(OpenAuth_None)
              else
                let AuthDecap_Some(shared_secret_4: kemkey_t) = AuthDecap(enc_7, skgen(s), pk_3) in
                  r_4: keys_t <- KeySchedule_auth(shared_secret_4, info_6);
                  nonce_9: nonce_t <- get2(r_4);
                  key_8: key_t <- get1(r_4);
                  let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                    return(OpenAuth_Some(Context_Open_Some(pt_6)))
                  else
                    return(OpenAuth_Some(Context_Open_None))
                else
                  return(OpenAuth_None)
        ))
      ) | (
        Ochall(pk_S: pkey_t, pk_R: pkey_t, enc_star: kemciph_t, ciph_star: bitstring, aad_star: bitstring, info_star: bitstring) :=
        find i'_1 = i' <= N, i''_1 = i'' <= N suchthat defined(s[i'], s[i'']) && (pkgen(s[i']) = pk_S) && (pkgen(s[i'']) = pk_R) then
          find u = u_2 <= Qeperuser suchthat defined(info_5[u_2, i'_1], aad_8[u_2, i'_1], ct_8[u_2, i'_1], enc_4[u_2, i'_1], pk_2[u_2, i'_1]) && (pk_2[u_2, i'_1] = pk_R) && (enc_4[u_2, i'_1] = enc_star) && (ct_8[u_2, i'_1] = ciph_star) && (aad_8[u_2, i'_1] = aad_star) && (info_5[u_2, i'_1] = info_star) then
            return(bottom)
          else
            find u_4 = ri <= Qeperuser suchthat defined(r_6[ri, i'_1], info_5[ri, i'_1], ce_2[ri, i'_1], u_8[ri, i'_1]) && (i''_1 = u_8[ri, i'_1]) && (ce_2[ri, i'_1] = enc_star) then
              find [unique]  suchthat info_star = info_5[u_4, i'_1] then
                nonce_12: nonce_t <- get2(r_6[u_4, i'_1]);
                key_10: key_t <- get1(r_6[u_4, i'_1]);
                let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                  event_abort adv_wins
                else
                  return(bottom)
              orfind u_27 = ri_25 <= Qdperuser, u_28 = ri_26 <= N suchthat defined(r_10[ri_25, ri_26], info_6[ri_25, ri_26], u_7[ri_25, ri_26], u_6[ri_25, ri_26]) && (u_6[ri_25, ri_26] = u_4) && (u_7[ri_25, ri_26] = i'_1) && (info_star = info_6[ri_25, ri_26]) then
                nonce_12: nonce_t <- get2(r_10[u_27, u_28]);
                key_10: key_t <- get1(r_10[u_27, u_28]);
                let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                  event_abort adv_wins
                else
                  return(bottom)
              else
                part2_2 <-R nonce_t;
                part1_2 <-R key_t;
                r_13: keys_t <- cst_keys_t;
                nonce_12: nonce_t <- part2_2;
                key_10: key_t <- part1_2;
                let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                  event_abort adv_wins
                else
                  return(bottom)
            else
              find u_13 = ri_9 <= Qdperuser suchthat defined(r_7[ri_9, i''_1], info_6[ri_9, i''_1], enc_7[ri_9, i''_1], u_22[ri_9, i''_1]) && (u_22[ri_9, i''_1] = i'_1) && (enc_7[ri_9, i''_1] = enc_star) then
                find [unique]  suchthat info_star = info_6[u_13, i''_1] then
                  nonce_12: nonce_t <- get2(r_7[u_13, i''_1]);
                  key_10: key_t <- get1(r_7[u_13, i''_1]);
                  let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                    event_abort adv_wins
                  else
                    return(bottom)
                orfind u_25 = ri_21 <= Qdperuser suchthat defined(r_8[ri_21, i''_1], info_6[ri_21, i''_1], u_20[ri_21, i''_1]) && (u_20[ri_21, i''_1] = u_13) && (info_star = info_6[ri_21, i''_1]) then
                  nonce_12: nonce_t <- get2(r_8[u_25, i''_1]);
                  key_10: key_t <- get1(r_8[u_25, i''_1]);
                  let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                    event_abort adv_wins
                  else
                    return(bottom)
                else
                  part2_1 <-R nonce_t;
                  part1_1 <-R key_t;
                  r_12: keys_t <- cst_keys_t;
                  nonce_12: nonce_t <- part2_1;
                  key_10: key_t <- part1_1;
                  let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                    event_abort adv_wins
                  else
                    return(bottom)
              else
                let AuthDecap_Some(k0_1: kemkey_t) = AuthDecap(enc_star, skgen(s[i''_1]), pk_S) in
                  part2 <-R nonce_t;
                  part1 <-R key_t;
                  r_11: keys_t <- cst_keys_t;
                  nonce_12: nonce_t <- part2;
                  key_10: key_t <- part1;
                  let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                    event_abort adv_wins
                  else
                    return(bottom)
                else
                  return(bottom)
        else
          return(bottom)
      ))


Applying equivalence splitter(split)
  - Equivalence splitter(split) with variables: r_7 -> r
yields

Game 39 is
      ((
        foreach i <= N do
        Osetup() :=
        s <-R keypairseed_t;
        return(pkgen(s));
        ((
          foreach iae <= Qeperuser do
          Oaenc(pk_2: pkey_t, m: bitstring, aad_8: bitstring, info_5: bitstring) :=
          find u_8 = ri_4 <= N suchthat defined(s[ri_4]) && (pk_2 = pkgen(s[ri_4])) then
            k_3 <-R kemseed_t;
            sk_2: skey_t <- skgen(s);
            ce_2: kemciph_t <- AuthEncap_enc_r(k_3, pk_2, sk_2);
            enc_4: kemciph_t <- ce_2;
            r_6 <-R keys_t;
            nonce_6: nonce_t <- get2(r_6);
            key_6: key_t <- get1(r_6);
            ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
            return(SealAuth_Some(ce_2, ct_8))
          else
            k_2 <-R kemseed_t;
            sk_1: skey_t <- skgen(s);
            ce_1: kemciph_t <- AuthEncap_enc_r(k_2, pk_2, sk_1);
            k_5: kemkey_t <- AuthEncap_key_r(k_2, pk_2, sk_1);
            enc_4: kemciph_t <- ce_1;
            r_3: keys_t <- KeySchedule_auth(k_5, info_5);
            nonce_6: nonce_t <- get2(r_3);
            key_6: key_t <- get1(r_3);
            ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
            return(SealAuth_Some(ce_1, ct_8))
        ) | (
          foreach iad <= Qdperuser do
          Oadec(pk_3: pkey_t, enc_7: kemciph_t, c: bitstring, aad_9: bitstring, info_6: bitstring) :=
          find u_6 = ri_2 <= Qeperuser, u_7 = ri_3 <= N suchthat defined(r_6[ri_2, ri_3], info_5[ri_2, ri_3], ce_2[ri_2, ri_3], s[ri_3], u_8[ri_2, ri_3]) && (i = u_8[ri_2, ri_3]) && (pkgen(s[ri_3]) = pk_3) && (ce_2[ri_2, ri_3] = enc_7) then
            find [unique]  suchthat info_6 = info_5[u_6, u_7] then
              nonce_9: nonce_t <- get2(r_6[u_6, u_7]);
              key_8: key_t <- get1(r_6[u_6, u_7]);
              let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
            orfind u_35 = ri_39 <= Qdperuser suchthat defined(r_10[ri_39], info_6[ri_39], u_7[ri_39], u_6[ri_39]) && (u_6[ri_39] = u_6) && (u_7[ri_39] = u_7) && (info_6 = info_6[ri_39]) then
              nonce_9: nonce_t <- get2(r_10[u_35]);
              key_8: key_t <- get1(r_10[u_35]);
              let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
            orfind  suchthat defined(part2_2, part1_2, r_13, info_star, i'_1, u_4) && (u_4 = u_6) && (i'_1 = u_7) && (info_6 = info_star) then
              nonce_9: nonce_t <- part2_2;
              key_8: key_t <- part1_2;
              let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
            else
              r_10 <-R keys_t;
              nonce_9: nonce_t <- get2(r_10);
              key_8: key_t <- get1(r_10);
              let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
          else
            find u_20 = ri_16 <= Qdperuser suchthat defined(part2_3[ri_16], part1_3[ri_16], r_7[ri_16], info_6[ri_16], enc_7[ri_16], pk_3[ri_16]) && (pk_3[ri_16] = pk_3) && (enc_7[ri_16] = enc_7) then
              find [unique]  suchthat info_6 = info_6[u_20] then
                nonce_9: nonce_t <- part2_3[u_20];
                key_8: key_t <- part1_3[u_20];
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
              orfind u_31 = ri_33 <= Qdperuser suchthat defined(r_8[ri_33], info_6[ri_33], u_20[ri_33]) && (u_20[ri_33] = u_20) && (info_6 = info_6[ri_33]) then
                nonce_9: nonce_t <- get2(r_8[u_31]);
                key_8: key_t <- get1(r_8[u_31]);
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
              orfind  suchthat defined(part2_1, part1_1, r_12, info_star, i''_1, u_13) && (u_13 = u_20) && (i''_1 = i) && (info_6 = info_star) then
                nonce_9: nonce_t <- part2_1;
                key_8: key_t <- part1_1;
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
              else
                r_8 <-R keys_t;
                nonce_9: nonce_t <- get2(r_8);
                key_8: key_t <- get1(r_8);
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
            orfind  suchthat defined(part2, part1, r_11, info_star, enc_star, pk_S, i''_1) && (i = i''_1) && (pk_S = pk_3) && (enc_star = enc_7) then
              find [unique] u_33 = ri_37 <= Qdperuser suchthat defined(r_9[ri_37], info_6[ri_37]) && (info_6 = info_6[ri_37]) then
                nonce_9: nonce_t <- get2(r_9[u_33]);
                key_8: key_t <- get1(r_9[u_33]);
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
              orfind  suchthat info_6 = info_star then
                nonce_9: nonce_t <- part2;
                key_8: key_t <- part1;
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
              else
                r_9 <-R keys_t;
                nonce_9: nonce_t <- get2(r_9);
                key_8: key_t <- get1(r_9);
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
            else
              find u_22 = ri_18 <= N suchthat defined(s[ri_18]) && (pk_3 = pkgen(s[ri_18])) then
                let AuthDecap_Some(k0: kemkey_t) = AuthDecap(enc_7, skgen(s), pk_3) in
                  part2_3 <-R nonce_t;
                  part1_3 <-R key_t;
                  r_7: keys_t <- cst_keys_t;
                  nonce_9: nonce_t <- part2_3;
                  key_8: key_t <- part1_3;
                  let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                    return(OpenAuth_Some(Context_Open_Some(pt_6)))
                  else
                    return(OpenAuth_Some(Context_Open_None))
                else
                  return(OpenAuth_None)
              else
                let AuthDecap_Some(shared_secret_4: kemkey_t) = AuthDecap(enc_7, skgen(s), pk_3) in
                  r_4: keys_t <- KeySchedule_auth(shared_secret_4, info_6);
                  nonce_9: nonce_t <- get2(r_4);
                  key_8: key_t <- get1(r_4);
                  let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                    return(OpenAuth_Some(Context_Open_Some(pt_6)))
                  else
                    return(OpenAuth_Some(Context_Open_None))
                else
                  return(OpenAuth_None)
        ))
      ) | (
        Ochall(pk_S: pkey_t, pk_R: pkey_t, enc_star: kemciph_t, ciph_star: bitstring, aad_star: bitstring, info_star: bitstring) :=
        find i'_1 = i' <= N, i''_1 = i'' <= N suchthat defined(s[i'], s[i'']) && (pkgen(s[i']) = pk_S) && (pkgen(s[i'']) = pk_R) then
          find u = u_2 <= Qeperuser suchthat defined(info_5[u_2, i'_1], aad_8[u_2, i'_1], ct_8[u_2, i'_1], enc_4[u_2, i'_1], pk_2[u_2, i'_1]) && (pk_2[u_2, i'_1] = pk_R) && (enc_4[u_2, i'_1] = enc_star) && (ct_8[u_2, i'_1] = ciph_star) && (aad_8[u_2, i'_1] = aad_star) && (info_5[u_2, i'_1] = info_star) then
            return(bottom)
          else
            find u_4 = ri <= Qeperuser suchthat defined(r_6[ri, i'_1], info_5[ri, i'_1], ce_2[ri, i'_1], u_8[ri, i'_1]) && (i''_1 = u_8[ri, i'_1]) && (ce_2[ri, i'_1] = enc_star) then
              find [unique]  suchthat info_star = info_5[u_4, i'_1] then
                nonce_12: nonce_t <- get2(r_6[u_4, i'_1]);
                key_10: key_t <- get1(r_6[u_4, i'_1]);
                let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                  event_abort adv_wins
                else
                  return(bottom)
              orfind u_27 = ri_25 <= Qdperuser, u_28 = ri_26 <= N suchthat defined(r_10[ri_25, ri_26], info_6[ri_25, ri_26], u_7[ri_25, ri_26], u_6[ri_25, ri_26]) && (u_6[ri_25, ri_26] = u_4) && (u_7[ri_25, ri_26] = i'_1) && (info_star = info_6[ri_25, ri_26]) then
                nonce_12: nonce_t <- get2(r_10[u_27, u_28]);
                key_10: key_t <- get1(r_10[u_27, u_28]);
                let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                  event_abort adv_wins
                else
                  return(bottom)
              else
                part2_2 <-R nonce_t;
                part1_2 <-R key_t;
                r_13: keys_t <- cst_keys_t;
                nonce_12: nonce_t <- part2_2;
                key_10: key_t <- part1_2;
                let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                  event_abort adv_wins
                else
                  return(bottom)
            else
              find u_13 = ri_9 <= Qdperuser suchthat defined(part2_3[ri_9, i''_1], part1_3[ri_9, i''_1], r_7[ri_9, i''_1], info_6[ri_9, i''_1], enc_7[ri_9, i''_1], u_22[ri_9, i''_1]) && (u_22[ri_9, i''_1] = i'_1) && (enc_7[ri_9, i''_1] = enc_star) then
                find [unique]  suchthat info_star = info_6[u_13, i''_1] then
                  nonce_12: nonce_t <- part2_3[u_13, i''_1];
                  key_10: key_t <- part1_3[u_13, i''_1];
                  let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                    event_abort adv_wins
                  else
                    return(bottom)
                orfind u_25 = ri_21 <= Qdperuser suchthat defined(r_8[ri_21, i''_1], info_6[ri_21, i''_1], u_20[ri_21, i''_1]) && (u_20[ri_21, i''_1] = u_13) && (info_star = info_6[ri_21, i''_1]) then
                  nonce_12: nonce_t <- get2(r_8[u_25, i''_1]);
                  key_10: key_t <- get1(r_8[u_25, i''_1]);
                  let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                    event_abort adv_wins
                  else
                    return(bottom)
                else
                  part2_1 <-R nonce_t;
                  part1_1 <-R key_t;
                  r_12: keys_t <- cst_keys_t;
                  nonce_12: nonce_t <- part2_1;
                  key_10: key_t <- part1_1;
                  let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                    event_abort adv_wins
                  else
                    return(bottom)
              else
                let AuthDecap_Some(k0_1: kemkey_t) = AuthDecap(enc_star, skgen(s[i''_1]), pk_S) in
                  part2 <-R nonce_t;
                  part1 <-R key_t;
                  r_11: keys_t <- cst_keys_t;
                  nonce_12: nonce_t <- part2;
                  key_10: key_t <- part1;
                  let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                    event_abort adv_wins
                  else
                    return(bottom)
                else
                  return(bottom)
        else
          return(bottom)
      ))


Applying equivalence splitter(split)
  - Equivalence splitter(split) with variables: r_9 -> r
yields

Game 40 is
      ((
        foreach i <= N do
        Osetup() :=
        s <-R keypairseed_t;
        return(pkgen(s));
        ((
          foreach iae <= Qeperuser do
          Oaenc(pk_2: pkey_t, m: bitstring, aad_8: bitstring, info_5: bitstring) :=
          find u_8 = ri_4 <= N suchthat defined(s[ri_4]) && (pk_2 = pkgen(s[ri_4])) then
            k_3 <-R kemseed_t;
            sk_2: skey_t <- skgen(s);
            ce_2: kemciph_t <- AuthEncap_enc_r(k_3, pk_2, sk_2);
            enc_4: kemciph_t <- ce_2;
            r_6 <-R keys_t;
            nonce_6: nonce_t <- get2(r_6);
            key_6: key_t <- get1(r_6);
            ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
            return(SealAuth_Some(ce_2, ct_8))
          else
            k_2 <-R kemseed_t;
            sk_1: skey_t <- skgen(s);
            ce_1: kemciph_t <- AuthEncap_enc_r(k_2, pk_2, sk_1);
            k_5: kemkey_t <- AuthEncap_key_r(k_2, pk_2, sk_1);
            enc_4: kemciph_t <- ce_1;
            r_3: keys_t <- KeySchedule_auth(k_5, info_5);
            nonce_6: nonce_t <- get2(r_3);
            key_6: key_t <- get1(r_3);
            ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
            return(SealAuth_Some(ce_1, ct_8))
        ) | (
          foreach iad <= Qdperuser do
          Oadec(pk_3: pkey_t, enc_7: kemciph_t, c: bitstring, aad_9: bitstring, info_6: bitstring) :=
          find u_6 = ri_2 <= Qeperuser, u_7 = ri_3 <= N suchthat defined(r_6[ri_2, ri_3], info_5[ri_2, ri_3], ce_2[ri_2, ri_3], s[ri_3], u_8[ri_2, ri_3]) && (i = u_8[ri_2, ri_3]) && (pkgen(s[ri_3]) = pk_3) && (ce_2[ri_2, ri_3] = enc_7) then
            find [unique]  suchthat info_6 = info_5[u_6, u_7] then
              nonce_9: nonce_t <- get2(r_6[u_6, u_7]);
              key_8: key_t <- get1(r_6[u_6, u_7]);
              let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
            orfind u_35 = ri_39 <= Qdperuser suchthat defined(r_10[ri_39], info_6[ri_39], u_7[ri_39], u_6[ri_39]) && (u_6[ri_39] = u_6) && (u_7[ri_39] = u_7) && (info_6 = info_6[ri_39]) then
              nonce_9: nonce_t <- get2(r_10[u_35]);
              key_8: key_t <- get1(r_10[u_35]);
              let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
            orfind  suchthat defined(part2_2, part1_2, r_13, info_star, i'_1, u_4) && (u_4 = u_6) && (i'_1 = u_7) && (info_6 = info_star) then
              nonce_9: nonce_t <- part2_2;
              key_8: key_t <- part1_2;
              let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
            else
              r_10 <-R keys_t;
              nonce_9: nonce_t <- get2(r_10);
              key_8: key_t <- get1(r_10);
              let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
          else
            find u_20 = ri_16 <= Qdperuser suchthat defined(part2_3[ri_16], part1_3[ri_16], r_7[ri_16], info_6[ri_16], enc_7[ri_16], pk_3[ri_16]) && (pk_3[ri_16] = pk_3) && (enc_7[ri_16] = enc_7) then
              find [unique]  suchthat info_6 = info_6[u_20] then
                nonce_9: nonce_t <- part2_3[u_20];
                key_8: key_t <- part1_3[u_20];
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
              orfind u_31 = ri_33 <= Qdperuser suchthat defined(r_8[ri_33], info_6[ri_33], u_20[ri_33]) && (u_20[ri_33] = u_20) && (info_6 = info_6[ri_33]) then
                nonce_9: nonce_t <- get2(r_8[u_31]);
                key_8: key_t <- get1(r_8[u_31]);
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
              orfind  suchthat defined(part2_1, part1_1, r_12, info_star, i''_1, u_13) && (u_13 = u_20) && (i''_1 = i) && (info_6 = info_star) then
                nonce_9: nonce_t <- part2_1;
                key_8: key_t <- part1_1;
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
              else
                r_8 <-R keys_t;
                nonce_9: nonce_t <- get2(r_8);
                key_8: key_t <- get1(r_8);
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
            orfind  suchthat defined(part2, part1, r_11, info_star, enc_star, pk_S, i''_1) && (i = i''_1) && (pk_S = pk_3) && (enc_star = enc_7) then
              find [unique] u_33 = ri_37 <= Qdperuser suchthat defined(part2_4[ri_37], part1_4[ri_37], r_9[ri_37], info_6[ri_37]) && (info_6 = info_6[ri_37]) then
                nonce_9: nonce_t <- part2_4[u_33];
                key_8: key_t <- part1_4[u_33];
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
              orfind  suchthat info_6 = info_star then
                nonce_9: nonce_t <- part2;
                key_8: key_t <- part1;
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
              else
                part2_4 <-R nonce_t;
                part1_4 <-R key_t;
                r_9: keys_t <- cst_keys_t;
                nonce_9: nonce_t <- part2_4;
                key_8: key_t <- part1_4;
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
            else
              find u_22 = ri_18 <= N suchthat defined(s[ri_18]) && (pk_3 = pkgen(s[ri_18])) then
                let AuthDecap_Some(k0: kemkey_t) = AuthDecap(enc_7, skgen(s), pk_3) in
                  part2_3 <-R nonce_t;
                  part1_3 <-R key_t;
                  r_7: keys_t <- cst_keys_t;
                  nonce_9: nonce_t <- part2_3;
                  key_8: key_t <- part1_3;
                  let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                    return(OpenAuth_Some(Context_Open_Some(pt_6)))
                  else
                    return(OpenAuth_Some(Context_Open_None))
                else
                  return(OpenAuth_None)
              else
                let AuthDecap_Some(shared_secret_4: kemkey_t) = AuthDecap(enc_7, skgen(s), pk_3) in
                  r_4: keys_t <- KeySchedule_auth(shared_secret_4, info_6);
                  nonce_9: nonce_t <- get2(r_4);
                  key_8: key_t <- get1(r_4);
                  let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                    return(OpenAuth_Some(Context_Open_Some(pt_6)))
                  else
                    return(OpenAuth_Some(Context_Open_None))
                else
                  return(OpenAuth_None)
        ))
      ) | (
        Ochall(pk_S: pkey_t, pk_R: pkey_t, enc_star: kemciph_t, ciph_star: bitstring, aad_star: bitstring, info_star: bitstring) :=
        find i'_1 = i' <= N, i''_1 = i'' <= N suchthat defined(s[i'], s[i'']) && (pkgen(s[i']) = pk_S) && (pkgen(s[i'']) = pk_R) then
          find u = u_2 <= Qeperuser suchthat defined(info_5[u_2, i'_1], aad_8[u_2, i'_1], ct_8[u_2, i'_1], enc_4[u_2, i'_1], pk_2[u_2, i'_1]) && (pk_2[u_2, i'_1] = pk_R) && (enc_4[u_2, i'_1] = enc_star) && (ct_8[u_2, i'_1] = ciph_star) && (aad_8[u_2, i'_1] = aad_star) && (info_5[u_2, i'_1] = info_star) then
            return(bottom)
          else
            find u_4 = ri <= Qeperuser suchthat defined(r_6[ri, i'_1], info_5[ri, i'_1], ce_2[ri, i'_1], u_8[ri, i'_1]) && (i''_1 = u_8[ri, i'_1]) && (ce_2[ri, i'_1] = enc_star) then
              find [unique]  suchthat info_star = info_5[u_4, i'_1] then
                nonce_12: nonce_t <- get2(r_6[u_4, i'_1]);
                key_10: key_t <- get1(r_6[u_4, i'_1]);
                let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                  event_abort adv_wins
                else
                  return(bottom)
              orfind u_27 = ri_25 <= Qdperuser, u_28 = ri_26 <= N suchthat defined(r_10[ri_25, ri_26], info_6[ri_25, ri_26], u_7[ri_25, ri_26], u_6[ri_25, ri_26]) && (u_6[ri_25, ri_26] = u_4) && (u_7[ri_25, ri_26] = i'_1) && (info_star = info_6[ri_25, ri_26]) then
                nonce_12: nonce_t <- get2(r_10[u_27, u_28]);
                key_10: key_t <- get1(r_10[u_27, u_28]);
                let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                  event_abort adv_wins
                else
                  return(bottom)
              else
                part2_2 <-R nonce_t;
                part1_2 <-R key_t;
                r_13: keys_t <- cst_keys_t;
                nonce_12: nonce_t <- part2_2;
                key_10: key_t <- part1_2;
                let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                  event_abort adv_wins
                else
                  return(bottom)
            else
              find u_13 = ri_9 <= Qdperuser suchthat defined(part2_3[ri_9, i''_1], part1_3[ri_9, i''_1], r_7[ri_9, i''_1], info_6[ri_9, i''_1], enc_7[ri_9, i''_1], u_22[ri_9, i''_1]) && (u_22[ri_9, i''_1] = i'_1) && (enc_7[ri_9, i''_1] = enc_star) then
                find [unique]  suchthat info_star = info_6[u_13, i''_1] then
                  nonce_12: nonce_t <- part2_3[u_13, i''_1];
                  key_10: key_t <- part1_3[u_13, i''_1];
                  let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                    event_abort adv_wins
                  else
                    return(bottom)
                orfind u_25 = ri_21 <= Qdperuser suchthat defined(r_8[ri_21, i''_1], info_6[ri_21, i''_1], u_20[ri_21, i''_1]) && (u_20[ri_21, i''_1] = u_13) && (info_star = info_6[ri_21, i''_1]) then
                  nonce_12: nonce_t <- get2(r_8[u_25, i''_1]);
                  key_10: key_t <- get1(r_8[u_25, i''_1]);
                  let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                    event_abort adv_wins
                  else
                    return(bottom)
                else
                  part2_1 <-R nonce_t;
                  part1_1 <-R key_t;
                  r_12: keys_t <- cst_keys_t;
                  nonce_12: nonce_t <- part2_1;
                  key_10: key_t <- part1_1;
                  let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                    event_abort adv_wins
                  else
                    return(bottom)
              else
                let AuthDecap_Some(k0_1: kemkey_t) = AuthDecap(enc_star, skgen(s[i''_1]), pk_S) in
                  part2 <-R nonce_t;
                  part1 <-R key_t;
                  r_11: keys_t <- cst_keys_t;
                  nonce_12: nonce_t <- part2;
                  key_10: key_t <- part1;
                  let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                    event_abort adv_wins
                  else
                    return(bottom)
                else
                  return(bottom)
        else
          return(bottom)
      ))


Applying equivalence splitter(split)
  - Equivalence splitter(split) with variables: r_8 -> r
yields

Game 41 is
      ((
        foreach i <= N do
        Osetup() :=
        s <-R keypairseed_t;
        return(pkgen(s));
        ((
          foreach iae <= Qeperuser do
          Oaenc(pk_2: pkey_t, m: bitstring, aad_8: bitstring, info_5: bitstring) :=
          find u_8 = ri_4 <= N suchthat defined(s[ri_4]) && (pk_2 = pkgen(s[ri_4])) then
            k_3 <-R kemseed_t;
            sk_2: skey_t <- skgen(s);
            ce_2: kemciph_t <- AuthEncap_enc_r(k_3, pk_2, sk_2);
            enc_4: kemciph_t <- ce_2;
            r_6 <-R keys_t;
            nonce_6: nonce_t <- get2(r_6);
            key_6: key_t <- get1(r_6);
            ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
            return(SealAuth_Some(ce_2, ct_8))
          else
            k_2 <-R kemseed_t;
            sk_1: skey_t <- skgen(s);
            ce_1: kemciph_t <- AuthEncap_enc_r(k_2, pk_2, sk_1);
            k_5: kemkey_t <- AuthEncap_key_r(k_2, pk_2, sk_1);
            enc_4: kemciph_t <- ce_1;
            r_3: keys_t <- KeySchedule_auth(k_5, info_5);
            nonce_6: nonce_t <- get2(r_3);
            key_6: key_t <- get1(r_3);
            ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
            return(SealAuth_Some(ce_1, ct_8))
        ) | (
          foreach iad <= Qdperuser do
          Oadec(pk_3: pkey_t, enc_7: kemciph_t, c: bitstring, aad_9: bitstring, info_6: bitstring) :=
          find u_6 = ri_2 <= Qeperuser, u_7 = ri_3 <= N suchthat defined(r_6[ri_2, ri_3], info_5[ri_2, ri_3], ce_2[ri_2, ri_3], s[ri_3], u_8[ri_2, ri_3]) && (i = u_8[ri_2, ri_3]) && (pkgen(s[ri_3]) = pk_3) && (ce_2[ri_2, ri_3] = enc_7) then
            find [unique]  suchthat info_6 = info_5[u_6, u_7] then
              nonce_9: nonce_t <- get2(r_6[u_6, u_7]);
              key_8: key_t <- get1(r_6[u_6, u_7]);
              let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
            orfind u_35 = ri_39 <= Qdperuser suchthat defined(r_10[ri_39], info_6[ri_39], u_7[ri_39], u_6[ri_39]) && (u_6[ri_39] = u_6) && (u_7[ri_39] = u_7) && (info_6 = info_6[ri_39]) then
              nonce_9: nonce_t <- get2(r_10[u_35]);
              key_8: key_t <- get1(r_10[u_35]);
              let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
            orfind  suchthat defined(part2_2, part1_2, r_13, info_star, i'_1, u_4) && (u_4 = u_6) && (i'_1 = u_7) && (info_6 = info_star) then
              nonce_9: nonce_t <- part2_2;
              key_8: key_t <- part1_2;
              let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
            else
              r_10 <-R keys_t;
              nonce_9: nonce_t <- get2(r_10);
              key_8: key_t <- get1(r_10);
              let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
          else
            find u_20 = ri_16 <= Qdperuser suchthat defined(part2_3[ri_16], part1_3[ri_16], r_7[ri_16], info_6[ri_16], enc_7[ri_16], pk_3[ri_16]) && (pk_3[ri_16] = pk_3) && (enc_7[ri_16] = enc_7) then
              find [unique]  suchthat info_6 = info_6[u_20] then
                nonce_9: nonce_t <- part2_3[u_20];
                key_8: key_t <- part1_3[u_20];
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
              orfind u_31 = ri_33 <= Qdperuser suchthat defined(part2_5[ri_33], part1_5[ri_33], r_8[ri_33], info_6[ri_33], u_20[ri_33]) && (u_20[ri_33] = u_20) && (info_6 = info_6[ri_33]) then
                nonce_9: nonce_t <- part2_5[u_31];
                key_8: key_t <- part1_5[u_31];
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
              orfind  suchthat defined(part2_1, part1_1, r_12, info_star, i''_1, u_13) && (u_13 = u_20) && (i''_1 = i) && (info_6 = info_star) then
                nonce_9: nonce_t <- part2_1;
                key_8: key_t <- part1_1;
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
              else
                part2_5 <-R nonce_t;
                part1_5 <-R key_t;
                r_8: keys_t <- cst_keys_t;
                nonce_9: nonce_t <- part2_5;
                key_8: key_t <- part1_5;
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
            orfind  suchthat defined(part2, part1, r_11, info_star, enc_star, pk_S, i''_1) && (i = i''_1) && (pk_S = pk_3) && (enc_star = enc_7) then
              find [unique] u_33 = ri_37 <= Qdperuser suchthat defined(part2_4[ri_37], part1_4[ri_37], r_9[ri_37], info_6[ri_37]) && (info_6 = info_6[ri_37]) then
                nonce_9: nonce_t <- part2_4[u_33];
                key_8: key_t <- part1_4[u_33];
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
              orfind  suchthat info_6 = info_star then
                nonce_9: nonce_t <- part2;
                key_8: key_t <- part1;
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
              else
                part2_4 <-R nonce_t;
                part1_4 <-R key_t;
                r_9: keys_t <- cst_keys_t;
                nonce_9: nonce_t <- part2_4;
                key_8: key_t <- part1_4;
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
            else
              find u_22 = ri_18 <= N suchthat defined(s[ri_18]) && (pk_3 = pkgen(s[ri_18])) then
                let AuthDecap_Some(k0: kemkey_t) = AuthDecap(enc_7, skgen(s), pk_3) in
                  part2_3 <-R nonce_t;
                  part1_3 <-R key_t;
                  r_7: keys_t <- cst_keys_t;
                  nonce_9: nonce_t <- part2_3;
                  key_8: key_t <- part1_3;
                  let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                    return(OpenAuth_Some(Context_Open_Some(pt_6)))
                  else
                    return(OpenAuth_Some(Context_Open_None))
                else
                  return(OpenAuth_None)
              else
                let AuthDecap_Some(shared_secret_4: kemkey_t) = AuthDecap(enc_7, skgen(s), pk_3) in
                  r_4: keys_t <- KeySchedule_auth(shared_secret_4, info_6);
                  nonce_9: nonce_t <- get2(r_4);
                  key_8: key_t <- get1(r_4);
                  let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                    return(OpenAuth_Some(Context_Open_Some(pt_6)))
                  else
                    return(OpenAuth_Some(Context_Open_None))
                else
                  return(OpenAuth_None)
        ))
      ) | (
        Ochall(pk_S: pkey_t, pk_R: pkey_t, enc_star: kemciph_t, ciph_star: bitstring, aad_star: bitstring, info_star: bitstring) :=
        find i'_1 = i' <= N, i''_1 = i'' <= N suchthat defined(s[i'], s[i'']) && (pkgen(s[i']) = pk_S) && (pkgen(s[i'']) = pk_R) then
          find u = u_2 <= Qeperuser suchthat defined(info_5[u_2, i'_1], aad_8[u_2, i'_1], ct_8[u_2, i'_1], enc_4[u_2, i'_1], pk_2[u_2, i'_1]) && (pk_2[u_2, i'_1] = pk_R) && (enc_4[u_2, i'_1] = enc_star) && (ct_8[u_2, i'_1] = ciph_star) && (aad_8[u_2, i'_1] = aad_star) && (info_5[u_2, i'_1] = info_star) then
            return(bottom)
          else
            find u_4 = ri <= Qeperuser suchthat defined(r_6[ri, i'_1], info_5[ri, i'_1], ce_2[ri, i'_1], u_8[ri, i'_1]) && (i''_1 = u_8[ri, i'_1]) && (ce_2[ri, i'_1] = enc_star) then
              find [unique]  suchthat info_star = info_5[u_4, i'_1] then
                nonce_12: nonce_t <- get2(r_6[u_4, i'_1]);
                key_10: key_t <- get1(r_6[u_4, i'_1]);
                let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                  event_abort adv_wins
                else
                  return(bottom)
              orfind u_27 = ri_25 <= Qdperuser, u_28 = ri_26 <= N suchthat defined(r_10[ri_25, ri_26], info_6[ri_25, ri_26], u_7[ri_25, ri_26], u_6[ri_25, ri_26]) && (u_6[ri_25, ri_26] = u_4) && (u_7[ri_25, ri_26] = i'_1) && (info_star = info_6[ri_25, ri_26]) then
                nonce_12: nonce_t <- get2(r_10[u_27, u_28]);
                key_10: key_t <- get1(r_10[u_27, u_28]);
                let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                  event_abort adv_wins
                else
                  return(bottom)
              else
                part2_2 <-R nonce_t;
                part1_2 <-R key_t;
                r_13: keys_t <- cst_keys_t;
                nonce_12: nonce_t <- part2_2;
                key_10: key_t <- part1_2;
                let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                  event_abort adv_wins
                else
                  return(bottom)
            else
              find u_13 = ri_9 <= Qdperuser suchthat defined(part2_3[ri_9, i''_1], part1_3[ri_9, i''_1], r_7[ri_9, i''_1], info_6[ri_9, i''_1], enc_7[ri_9, i''_1], u_22[ri_9, i''_1]) && (u_22[ri_9, i''_1] = i'_1) && (enc_7[ri_9, i''_1] = enc_star) then
                find [unique]  suchthat info_star = info_6[u_13, i''_1] then
                  nonce_12: nonce_t <- part2_3[u_13, i''_1];
                  key_10: key_t <- part1_3[u_13, i''_1];
                  let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                    event_abort adv_wins
                  else
                    return(bottom)
                orfind u_25 = ri_21 <= Qdperuser suchthat defined(part2_5[ri_21, i''_1], part1_5[ri_21, i''_1], r_8[ri_21, i''_1], info_6[ri_21, i''_1], u_20[ri_21, i''_1]) && (u_20[ri_21, i''_1] = u_13) && (info_star = info_6[ri_21, i''_1]) then
                  nonce_12: nonce_t <- part2_5[u_25, i''_1];
                  key_10: key_t <- part1_5[u_25, i''_1];
                  let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                    event_abort adv_wins
                  else
                    return(bottom)
                else
                  part2_1 <-R nonce_t;
                  part1_1 <-R key_t;
                  r_12: keys_t <- cst_keys_t;
                  nonce_12: nonce_t <- part2_1;
                  key_10: key_t <- part1_1;
                  let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                    event_abort adv_wins
                  else
                    return(bottom)
              else
                let AuthDecap_Some(k0_1: kemkey_t) = AuthDecap(enc_star, skgen(s[i''_1]), pk_S) in
                  part2 <-R nonce_t;
                  part1 <-R key_t;
                  r_11: keys_t <- cst_keys_t;
                  nonce_12: nonce_t <- part2;
                  key_10: key_t <- part1;
                  let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                    event_abort adv_wins
                  else
                    return(bottom)
                else
                  return(bottom)
        else
          return(bottom)
      ))


Applying equivalence splitter(split)
  - Equivalence splitter(split) with variables: r_10 -> r
yields

Game 42 is
      ((
        foreach i <= N do
        Osetup() :=
        s <-R keypairseed_t;
        return(pkgen(s));
        ((
          foreach iae <= Qeperuser do
          Oaenc(pk_2: pkey_t, m: bitstring, aad_8: bitstring, info_5: bitstring) :=
          find u_8 = ri_4 <= N suchthat defined(s[ri_4]) && (pk_2 = pkgen(s[ri_4])) then
            k_3 <-R kemseed_t;
            sk_2: skey_t <- skgen(s);
            ce_2: kemciph_t <- AuthEncap_enc_r(k_3, pk_2, sk_2);
            enc_4: kemciph_t <- ce_2;
            r_6 <-R keys_t;
            nonce_6: nonce_t <- get2(r_6);
            key_6: key_t <- get1(r_6);
            ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
            return(SealAuth_Some(ce_2, ct_8))
          else
            k_2 <-R kemseed_t;
            sk_1: skey_t <- skgen(s);
            ce_1: kemciph_t <- AuthEncap_enc_r(k_2, pk_2, sk_1);
            k_5: kemkey_t <- AuthEncap_key_r(k_2, pk_2, sk_1);
            enc_4: kemciph_t <- ce_1;
            r_3: keys_t <- KeySchedule_auth(k_5, info_5);
            nonce_6: nonce_t <- get2(r_3);
            key_6: key_t <- get1(r_3);
            ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
            return(SealAuth_Some(ce_1, ct_8))
        ) | (
          foreach iad <= Qdperuser do
          Oadec(pk_3: pkey_t, enc_7: kemciph_t, c: bitstring, aad_9: bitstring, info_6: bitstring) :=
          find u_6 = ri_2 <= Qeperuser, u_7 = ri_3 <= N suchthat defined(r_6[ri_2, ri_3], info_5[ri_2, ri_3], ce_2[ri_2, ri_3], s[ri_3], u_8[ri_2, ri_3]) && (i = u_8[ri_2, ri_3]) && (pkgen(s[ri_3]) = pk_3) && (ce_2[ri_2, ri_3] = enc_7) then
            find [unique]  suchthat info_6 = info_5[u_6, u_7] then
              nonce_9: nonce_t <- get2(r_6[u_6, u_7]);
              key_8: key_t <- get1(r_6[u_6, u_7]);
              let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
            orfind u_35 = ri_39 <= Qdperuser suchthat defined(part2_6[ri_39], part1_6[ri_39], r_10[ri_39], info_6[ri_39], u_7[ri_39], u_6[ri_39]) && (u_6[ri_39] = u_6) && (u_7[ri_39] = u_7) && (info_6 = info_6[ri_39]) then
              nonce_9: nonce_t <- part2_6[u_35];
              key_8: key_t <- part1_6[u_35];
              let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
            orfind  suchthat defined(part2_2, part1_2, r_13, info_star, i'_1, u_4) && (u_4 = u_6) && (i'_1 = u_7) && (info_6 = info_star) then
              nonce_9: nonce_t <- part2_2;
              key_8: key_t <- part1_2;
              let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
            else
              part2_6 <-R nonce_t;
              part1_6 <-R key_t;
              r_10: keys_t <- cst_keys_t;
              nonce_9: nonce_t <- part2_6;
              key_8: key_t <- part1_6;
              let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
          else
            find u_20 = ri_16 <= Qdperuser suchthat defined(part2_3[ri_16], part1_3[ri_16], r_7[ri_16], info_6[ri_16], enc_7[ri_16], pk_3[ri_16]) && (pk_3[ri_16] = pk_3) && (enc_7[ri_16] = enc_7) then
              find [unique]  suchthat info_6 = info_6[u_20] then
                nonce_9: nonce_t <- part2_3[u_20];
                key_8: key_t <- part1_3[u_20];
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
              orfind u_31 = ri_33 <= Qdperuser suchthat defined(part2_5[ri_33], part1_5[ri_33], r_8[ri_33], info_6[ri_33], u_20[ri_33]) && (u_20[ri_33] = u_20) && (info_6 = info_6[ri_33]) then
                nonce_9: nonce_t <- part2_5[u_31];
                key_8: key_t <- part1_5[u_31];
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
              orfind  suchthat defined(part2_1, part1_1, r_12, info_star, i''_1, u_13) && (u_13 = u_20) && (i''_1 = i) && (info_6 = info_star) then
                nonce_9: nonce_t <- part2_1;
                key_8: key_t <- part1_1;
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
              else
                part2_5 <-R nonce_t;
                part1_5 <-R key_t;
                r_8: keys_t <- cst_keys_t;
                nonce_9: nonce_t <- part2_5;
                key_8: key_t <- part1_5;
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
            orfind  suchthat defined(part2, part1, r_11, info_star, enc_star, pk_S, i''_1) && (i = i''_1) && (pk_S = pk_3) && (enc_star = enc_7) then
              find [unique] u_33 = ri_37 <= Qdperuser suchthat defined(part2_4[ri_37], part1_4[ri_37], r_9[ri_37], info_6[ri_37]) && (info_6 = info_6[ri_37]) then
                nonce_9: nonce_t <- part2_4[u_33];
                key_8: key_t <- part1_4[u_33];
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
              orfind  suchthat info_6 = info_star then
                nonce_9: nonce_t <- part2;
                key_8: key_t <- part1;
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
              else
                part2_4 <-R nonce_t;
                part1_4 <-R key_t;
                r_9: keys_t <- cst_keys_t;
                nonce_9: nonce_t <- part2_4;
                key_8: key_t <- part1_4;
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
            else
              find u_22 = ri_18 <= N suchthat defined(s[ri_18]) && (pk_3 = pkgen(s[ri_18])) then
                let AuthDecap_Some(k0: kemkey_t) = AuthDecap(enc_7, skgen(s), pk_3) in
                  part2_3 <-R nonce_t;
                  part1_3 <-R key_t;
                  r_7: keys_t <- cst_keys_t;
                  nonce_9: nonce_t <- part2_3;
                  key_8: key_t <- part1_3;
                  let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                    return(OpenAuth_Some(Context_Open_Some(pt_6)))
                  else
                    return(OpenAuth_Some(Context_Open_None))
                else
                  return(OpenAuth_None)
              else
                let AuthDecap_Some(shared_secret_4: kemkey_t) = AuthDecap(enc_7, skgen(s), pk_3) in
                  r_4: keys_t <- KeySchedule_auth(shared_secret_4, info_6);
                  nonce_9: nonce_t <- get2(r_4);
                  key_8: key_t <- get1(r_4);
                  let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                    return(OpenAuth_Some(Context_Open_Some(pt_6)))
                  else
                    return(OpenAuth_Some(Context_Open_None))
                else
                  return(OpenAuth_None)
        ))
      ) | (
        Ochall(pk_S: pkey_t, pk_R: pkey_t, enc_star: kemciph_t, ciph_star: bitstring, aad_star: bitstring, info_star: bitstring) :=
        find i'_1 = i' <= N, i''_1 = i'' <= N suchthat defined(s[i'], s[i'']) && (pkgen(s[i']) = pk_S) && (pkgen(s[i'']) = pk_R) then
          find u = u_2 <= Qeperuser suchthat defined(info_5[u_2, i'_1], aad_8[u_2, i'_1], ct_8[u_2, i'_1], enc_4[u_2, i'_1], pk_2[u_2, i'_1]) && (pk_2[u_2, i'_1] = pk_R) && (enc_4[u_2, i'_1] = enc_star) && (ct_8[u_2, i'_1] = ciph_star) && (aad_8[u_2, i'_1] = aad_star) && (info_5[u_2, i'_1] = info_star) then
            return(bottom)
          else
            find u_4 = ri <= Qeperuser suchthat defined(r_6[ri, i'_1], info_5[ri, i'_1], ce_2[ri, i'_1], u_8[ri, i'_1]) && (i''_1 = u_8[ri, i'_1]) && (ce_2[ri, i'_1] = enc_star) then
              find [unique]  suchthat info_star = info_5[u_4, i'_1] then
                nonce_12: nonce_t <- get2(r_6[u_4, i'_1]);
                key_10: key_t <- get1(r_6[u_4, i'_1]);
                let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                  event_abort adv_wins
                else
                  return(bottom)
              orfind u_27 = ri_25 <= Qdperuser, u_28 = ri_26 <= N suchthat defined(part2_6[ri_25, ri_26], part1_6[ri_25, ri_26], r_10[ri_25, ri_26], info_6[ri_25, ri_26], u_7[ri_25, ri_26], u_6[ri_25, ri_26]) && (u_6[ri_25, ri_26] = u_4) && (u_7[ri_25, ri_26] = i'_1) && (info_star = info_6[ri_25, ri_26]) then
                nonce_12: nonce_t <- part2_6[u_27, u_28];
                key_10: key_t <- part1_6[u_27, u_28];
                let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                  event_abort adv_wins
                else
                  return(bottom)
              else
                part2_2 <-R nonce_t;
                part1_2 <-R key_t;
                r_13: keys_t <- cst_keys_t;
                nonce_12: nonce_t <- part2_2;
                key_10: key_t <- part1_2;
                let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                  event_abort adv_wins
                else
                  return(bottom)
            else
              find u_13 = ri_9 <= Qdperuser suchthat defined(part2_3[ri_9, i''_1], part1_3[ri_9, i''_1], r_7[ri_9, i''_1], info_6[ri_9, i''_1], enc_7[ri_9, i''_1], u_22[ri_9, i''_1]) && (u_22[ri_9, i''_1] = i'_1) && (enc_7[ri_9, i''_1] = enc_star) then
                find [unique]  suchthat info_star = info_6[u_13, i''_1] then
                  nonce_12: nonce_t <- part2_3[u_13, i''_1];
                  key_10: key_t <- part1_3[u_13, i''_1];
                  let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                    event_abort adv_wins
                  else
                    return(bottom)
                orfind u_25 = ri_21 <= Qdperuser suchthat defined(part2_5[ri_21, i''_1], part1_5[ri_21, i''_1], r_8[ri_21, i''_1], info_6[ri_21, i''_1], u_20[ri_21, i''_1]) && (u_20[ri_21, i''_1] = u_13) && (info_star = info_6[ri_21, i''_1]) then
                  nonce_12: nonce_t <- part2_5[u_25, i''_1];
                  key_10: key_t <- part1_5[u_25, i''_1];
                  let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                    event_abort adv_wins
                  else
                    return(bottom)
                else
                  part2_1 <-R nonce_t;
                  part1_1 <-R key_t;
                  r_12: keys_t <- cst_keys_t;
                  nonce_12: nonce_t <- part2_1;
                  key_10: key_t <- part1_1;
                  let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                    event_abort adv_wins
                  else
                    return(bottom)
              else
                let AuthDecap_Some(k0_1: kemkey_t) = AuthDecap(enc_star, skgen(s[i''_1]), pk_S) in
                  part2 <-R nonce_t;
                  part1 <-R key_t;
                  r_11: keys_t <- cst_keys_t;
                  nonce_12: nonce_t <- part2;
                  key_10: key_t <- part1;
                  let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                    event_abort adv_wins
                  else
                    return(bottom)
                else
                  return(bottom)
        else
          return(bottom)
      ))


Applying equivalence splitter(split)
  - Equivalence splitter(split) with variables: r_6 -> r
yields

Game 43 is
      ((
        foreach i <= N do
        Osetup() :=
        s <-R keypairseed_t;
        return(pkgen(s));
        ((
          foreach iae <= Qeperuser do
          Oaenc(pk_2: pkey_t, m: bitstring, aad_8: bitstring, info_5: bitstring) :=
          find u_8 = ri_4 <= N suchthat defined(s[ri_4]) && (pk_2 = pkgen(s[ri_4])) then
            k_3 <-R kemseed_t;
            sk_2: skey_t <- skgen(s);
            ce_2: kemciph_t <- AuthEncap_enc_r(k_3, pk_2, sk_2);
            enc_4: kemciph_t <- ce_2;
            part2_7 <-R nonce_t;
            part1_7 <-R key_t;
            r_6: keys_t <- cst_keys_t;
            nonce_6: nonce_t <- part2_7;
            key_6: key_t <- part1_7;
            ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
            return(SealAuth_Some(ce_2, ct_8))
          else
            k_2 <-R kemseed_t;
            sk_1: skey_t <- skgen(s);
            ce_1: kemciph_t <- AuthEncap_enc_r(k_2, pk_2, sk_1);
            k_5: kemkey_t <- AuthEncap_key_r(k_2, pk_2, sk_1);
            enc_4: kemciph_t <- ce_1;
            r_3: keys_t <- KeySchedule_auth(k_5, info_5);
            nonce_6: nonce_t <- get2(r_3);
            key_6: key_t <- get1(r_3);
            ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
            return(SealAuth_Some(ce_1, ct_8))
        ) | (
          foreach iad <= Qdperuser do
          Oadec(pk_3: pkey_t, enc_7: kemciph_t, c: bitstring, aad_9: bitstring, info_6: bitstring) :=
          find u_6 = ri_2 <= Qeperuser, u_7 = ri_3 <= N suchthat defined(part2_7[ri_2, ri_3], part1_7[ri_2, ri_3], r_6[ri_2, ri_3], info_5[ri_2, ri_3], ce_2[ri_2, ri_3], s[ri_3], u_8[ri_2, ri_3]) && (i = u_8[ri_2, ri_3]) && (pkgen(s[ri_3]) = pk_3) && (ce_2[ri_2, ri_3] = enc_7) then
            find [unique]  suchthat info_6 = info_5[u_6, u_7] then
              nonce_9: nonce_t <- part2_7[u_6, u_7];
              key_8: key_t <- part1_7[u_6, u_7];
              let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
            orfind u_35 = ri_39 <= Qdperuser suchthat defined(part2_6[ri_39], part1_6[ri_39], r_10[ri_39], info_6[ri_39], u_7[ri_39], u_6[ri_39]) && (u_6[ri_39] = u_6) && (u_7[ri_39] = u_7) && (info_6 = info_6[ri_39]) then
              nonce_9: nonce_t <- part2_6[u_35];
              key_8: key_t <- part1_6[u_35];
              let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
            orfind  suchthat defined(part2_2, part1_2, r_13, info_star, i'_1, u_4) && (u_4 = u_6) && (i'_1 = u_7) && (info_6 = info_star) then
              nonce_9: nonce_t <- part2_2;
              key_8: key_t <- part1_2;
              let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
            else
              part2_6 <-R nonce_t;
              part1_6 <-R key_t;
              r_10: keys_t <- cst_keys_t;
              nonce_9: nonce_t <- part2_6;
              key_8: key_t <- part1_6;
              let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
          else
            find u_20 = ri_16 <= Qdperuser suchthat defined(part2_3[ri_16], part1_3[ri_16], r_7[ri_16], info_6[ri_16], enc_7[ri_16], pk_3[ri_16]) && (pk_3[ri_16] = pk_3) && (enc_7[ri_16] = enc_7) then
              find [unique]  suchthat info_6 = info_6[u_20] then
                nonce_9: nonce_t <- part2_3[u_20];
                key_8: key_t <- part1_3[u_20];
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
              orfind u_31 = ri_33 <= Qdperuser suchthat defined(part2_5[ri_33], part1_5[ri_33], r_8[ri_33], info_6[ri_33], u_20[ri_33]) && (u_20[ri_33] = u_20) && (info_6 = info_6[ri_33]) then
                nonce_9: nonce_t <- part2_5[u_31];
                key_8: key_t <- part1_5[u_31];
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
              orfind  suchthat defined(part2_1, part1_1, r_12, info_star, i''_1, u_13) && (u_13 = u_20) && (i''_1 = i) && (info_6 = info_star) then
                nonce_9: nonce_t <- part2_1;
                key_8: key_t <- part1_1;
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
              else
                part2_5 <-R nonce_t;
                part1_5 <-R key_t;
                r_8: keys_t <- cst_keys_t;
                nonce_9: nonce_t <- part2_5;
                key_8: key_t <- part1_5;
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
            orfind  suchthat defined(part2, part1, r_11, info_star, enc_star, pk_S, i''_1) && (i = i''_1) && (pk_S = pk_3) && (enc_star = enc_7) then
              find [unique] u_33 = ri_37 <= Qdperuser suchthat defined(part2_4[ri_37], part1_4[ri_37], r_9[ri_37], info_6[ri_37]) && (info_6 = info_6[ri_37]) then
                nonce_9: nonce_t <- part2_4[u_33];
                key_8: key_t <- part1_4[u_33];
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
              orfind  suchthat info_6 = info_star then
                nonce_9: nonce_t <- part2;
                key_8: key_t <- part1;
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
              else
                part2_4 <-R nonce_t;
                part1_4 <-R key_t;
                r_9: keys_t <- cst_keys_t;
                nonce_9: nonce_t <- part2_4;
                key_8: key_t <- part1_4;
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
            else
              find u_22 = ri_18 <= N suchthat defined(s[ri_18]) && (pk_3 = pkgen(s[ri_18])) then
                let AuthDecap_Some(k0: kemkey_t) = AuthDecap(enc_7, skgen(s), pk_3) in
                  part2_3 <-R nonce_t;
                  part1_3 <-R key_t;
                  r_7: keys_t <- cst_keys_t;
                  nonce_9: nonce_t <- part2_3;
                  key_8: key_t <- part1_3;
                  let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                    return(OpenAuth_Some(Context_Open_Some(pt_6)))
                  else
                    return(OpenAuth_Some(Context_Open_None))
                else
                  return(OpenAuth_None)
              else
                let AuthDecap_Some(shared_secret_4: kemkey_t) = AuthDecap(enc_7, skgen(s), pk_3) in
                  r_4: keys_t <- KeySchedule_auth(shared_secret_4, info_6);
                  nonce_9: nonce_t <- get2(r_4);
                  key_8: key_t <- get1(r_4);
                  let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                    return(OpenAuth_Some(Context_Open_Some(pt_6)))
                  else
                    return(OpenAuth_Some(Context_Open_None))
                else
                  return(OpenAuth_None)
        ))
      ) | (
        Ochall(pk_S: pkey_t, pk_R: pkey_t, enc_star: kemciph_t, ciph_star: bitstring, aad_star: bitstring, info_star: bitstring) :=
        find i'_1 = i' <= N, i''_1 = i'' <= N suchthat defined(s[i'], s[i'']) && (pkgen(s[i']) = pk_S) && (pkgen(s[i'']) = pk_R) then
          find u = u_2 <= Qeperuser suchthat defined(info_5[u_2, i'_1], aad_8[u_2, i'_1], ct_8[u_2, i'_1], enc_4[u_2, i'_1], pk_2[u_2, i'_1]) && (pk_2[u_2, i'_1] = pk_R) && (enc_4[u_2, i'_1] = enc_star) && (ct_8[u_2, i'_1] = ciph_star) && (aad_8[u_2, i'_1] = aad_star) && (info_5[u_2, i'_1] = info_star) then
            return(bottom)
          else
            find u_4 = ri <= Qeperuser suchthat defined(part2_7[ri, i'_1], part1_7[ri, i'_1], r_6[ri, i'_1], info_5[ri, i'_1], ce_2[ri, i'_1], u_8[ri, i'_1]) && (i''_1 = u_8[ri, i'_1]) && (ce_2[ri, i'_1] = enc_star) then
              find [unique]  suchthat info_star = info_5[u_4, i'_1] then
                nonce_12: nonce_t <- part2_7[u_4, i'_1];
                key_10: key_t <- part1_7[u_4, i'_1];
                let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                  event_abort adv_wins
                else
                  return(bottom)
              orfind u_27 = ri_25 <= Qdperuser, u_28 = ri_26 <= N suchthat defined(part2_6[ri_25, ri_26], part1_6[ri_25, ri_26], r_10[ri_25, ri_26], info_6[ri_25, ri_26], u_7[ri_25, ri_26], u_6[ri_25, ri_26]) && (u_6[ri_25, ri_26] = u_4) && (u_7[ri_25, ri_26] = i'_1) && (info_star = info_6[ri_25, ri_26]) then
                nonce_12: nonce_t <- part2_6[u_27, u_28];
                key_10: key_t <- part1_6[u_27, u_28];
                let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                  event_abort adv_wins
                else
                  return(bottom)
              else
                part2_2 <-R nonce_t;
                part1_2 <-R key_t;
                r_13: keys_t <- cst_keys_t;
                nonce_12: nonce_t <- part2_2;
                key_10: key_t <- part1_2;
                let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                  event_abort adv_wins
                else
                  return(bottom)
            else
              find u_13 = ri_9 <= Qdperuser suchthat defined(part2_3[ri_9, i''_1], part1_3[ri_9, i''_1], r_7[ri_9, i''_1], info_6[ri_9, i''_1], enc_7[ri_9, i''_1], u_22[ri_9, i''_1]) && (u_22[ri_9, i''_1] = i'_1) && (enc_7[ri_9, i''_1] = enc_star) then
                find [unique]  suchthat info_star = info_6[u_13, i''_1] then
                  nonce_12: nonce_t <- part2_3[u_13, i''_1];
                  key_10: key_t <- part1_3[u_13, i''_1];
                  let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                    event_abort adv_wins
                  else
                    return(bottom)
                orfind u_25 = ri_21 <= Qdperuser suchthat defined(part2_5[ri_21, i''_1], part1_5[ri_21, i''_1], r_8[ri_21, i''_1], info_6[ri_21, i''_1], u_20[ri_21, i''_1]) && (u_20[ri_21, i''_1] = u_13) && (info_star = info_6[ri_21, i''_1]) then
                  nonce_12: nonce_t <- part2_5[u_25, i''_1];
                  key_10: key_t <- part1_5[u_25, i''_1];
                  let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                    event_abort adv_wins
                  else
                    return(bottom)
                else
                  part2_1 <-R nonce_t;
                  part1_1 <-R key_t;
                  r_12: keys_t <- cst_keys_t;
                  nonce_12: nonce_t <- part2_1;
                  key_10: key_t <- part1_1;
                  let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                    event_abort adv_wins
                  else
                    return(bottom)
              else
                let AuthDecap_Some(k0_1: kemkey_t) = AuthDecap(enc_star, skgen(s[i''_1]), pk_S) in
                  part2 <-R nonce_t;
                  part1 <-R key_t;
                  r_11: keys_t <- cst_keys_t;
                  nonce_12: nonce_t <- part2;
                  key_10: key_t <- part1;
                  let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, key_10, nonce_12) in
                    event_abort adv_wins
                  else
                    return(bottom)
                else
                  return(bottom)
        else
          return(bottom)
      ))


Applying remove assignments of findcond
  - Remove assignments on r_11 (definition removed, all usages removed)
  - Remove assignments on nonce_12 (definition removed, all usages removed)
  - Remove assignments on key_10 (definition removed, all usages removed)
  - Remove assignments on r_12 (definition removed, all usages removed)
  - Remove assignments on nonce_12 (definition removed, all usages removed)
  - Remove assignments on key_10 (definition removed, all usages removed)
  - Remove assignments on nonce_12 (definition removed, all usages removed)
  - Remove assignments on key_10 (definition removed, all usages removed)
  - Remove assignments on nonce_12 (definition removed, all usages removed)
  - Remove assignments on key_10 (definition removed, all usages removed)
  - Remove assignments on r_13 (definition removed, all usages removed)
  - Remove assignments on nonce_12 (definition removed, all usages removed)
  - Remove assignments on key_10 (definition removed, all usages removed)
  - Remove assignments on nonce_12 (definition removed, all usages removed)
  - Remove assignments on key_10 (definition removed, all usages removed)
  - Remove assignments on nonce_12 (definition removed, all usages removed)
  - Remove assignments on key_10 (definition removed, all usages removed)
  - Remove assignments on r_7 (definition removed, all usages removed)
  - Remove assignments on nonce_9 (definition removed, all usages removed)
  - Remove assignments on key_8 (definition removed, all usages removed)
  - Remove assignments on r_8 (definition removed, all usages removed)
  - Remove assignments on nonce_9 (definition removed, all usages removed)
  - Remove assignments on key_8 (definition removed, all usages removed)
  - Remove assignments on nonce_9 (definition removed, all usages removed)
  - Remove assignments on key_8 (definition removed, all usages removed)
  - Remove assignments on nonce_9 (definition removed, all usages removed)
  - Remove assignments on key_8 (definition removed, all usages removed)
  - Remove assignments on nonce_9 (definition removed, all usages removed)
  - Remove assignments on key_8 (definition removed, all usages removed)
  - Remove assignments on r_9 (definition removed, all usages removed)
  - Remove assignments on nonce_9 (definition removed, all usages removed)
  - Remove assignments on key_8 (definition removed, all usages removed)
  - Remove assignments on nonce_9 (definition removed, all usages removed)
  - Remove assignments on key_8 (definition removed, all usages removed)
  - Remove assignments on nonce_9 (definition removed, all usages removed)
  - Remove assignments on key_8 (definition removed, all usages removed)
  - Remove assignments on r_10 (definition removed, all usages removed)
  - Remove assignments on nonce_9 (definition removed, all usages removed)
  - Remove assignments on key_8 (definition removed, all usages removed)
  - Remove assignments on nonce_9 (definition removed, all usages removed)
  - Remove assignments on key_8 (definition removed, all usages removed)
  - Remove assignments on nonce_9 (definition removed, all usages removed)
  - Remove assignments on key_8 (definition removed, all usages removed)
  - Remove assignments on nonce_9 (definition removed, all usages removed)
  - Remove assignments on key_8 (definition removed, all usages removed)
  - Remove assignments on r_6 (definition removed, all usages removed)
  - Remove assignments on nonce_6 (definition removed, all usages removed)
  - Remove assignments on key_6 (definition removed, all usages removed)
yields

Game 44 is
      ((
        foreach i <= N do
        Osetup() :=
        s <-R keypairseed_t;
        return(pkgen(s));
        ((
          foreach iae <= Qeperuser do
          Oaenc(pk_2: pkey_t, m: bitstring, aad_8: bitstring, info_5: bitstring) :=
          find u_8 = ri_4 <= N suchthat defined(s[ri_4]) && (pk_2 = pkgen(s[ri_4])) then
            k_3 <-R kemseed_t;
            sk_2: skey_t <- skgen(s);
            ce_2: kemciph_t <- AuthEncap_enc_r(k_3, pk_2, sk_2);
            enc_4: kemciph_t <- ce_2;
            part2_7 <-R nonce_t;
            part1_7 <-R key_t;
            ct_8: bitstring <- Seal_inner(m, aad_8, part1_7, part2_7);
            return(SealAuth_Some(ce_2, ct_8))
          else
            k_2 <-R kemseed_t;
            sk_1: skey_t <- skgen(s);
            ce_1: kemciph_t <- AuthEncap_enc_r(k_2, pk_2, sk_1);
            k_5: kemkey_t <- AuthEncap_key_r(k_2, pk_2, sk_1);
            enc_4: kemciph_t <- ce_1;
            r_3: keys_t <- KeySchedule_auth(k_5, info_5);
            nonce_6: nonce_t <- get2(r_3);
            key_6: key_t <- get1(r_3);
            ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
            return(SealAuth_Some(ce_1, ct_8))
        ) | (
          foreach iad <= Qdperuser do
          Oadec(pk_3: pkey_t, enc_7: kemciph_t, c: bitstring, aad_9: bitstring, info_6: bitstring) :=
          find u_6 = ri_2 <= Qeperuser, u_7 = ri_3 <= N suchthat defined(part2_7[ri_2, ri_3], part1_7[ri_2, ri_3], info_5[ri_2, ri_3], ce_2[ri_2, ri_3], s[ri_3], u_8[ri_2, ri_3]) && (i = u_8[ri_2, ri_3]) && (pkgen(s[ri_3]) = pk_3) && (ce_2[ri_2, ri_3] = enc_7) then
            find [unique]  suchthat info_6 = info_5[u_6, u_7] then
              let injbot(pt_6: bitstring) = Open_inner(c, aad_9, part1_7[u_6, u_7], part2_7[u_6, u_7]) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
            orfind u_35 = ri_39 <= Qdperuser suchthat defined(part2_6[ri_39], part1_6[ri_39], info_6[ri_39], u_7[ri_39], u_6[ri_39]) && (u_6[ri_39] = u_6) && (u_7[ri_39] = u_7) && (info_6 = info_6[ri_39]) then
              let injbot(pt_6: bitstring) = Open_inner(c, aad_9, part1_6[u_35], part2_6[u_35]) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
            orfind  suchthat defined(part2_2, part1_2, info_star, i'_1, u_4) && (u_4 = u_6) && (i'_1 = u_7) && (info_6 = info_star) then
              let injbot(pt_6: bitstring) = Open_inner(c, aad_9, part1_2, part2_2) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
            else
              part2_6 <-R nonce_t;
              part1_6 <-R key_t;
              let injbot(pt_6: bitstring) = Open_inner(c, aad_9, part1_6, part2_6) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
          else
            find u_20 = ri_16 <= Qdperuser suchthat defined(part2_3[ri_16], part1_3[ri_16], info_6[ri_16], enc_7[ri_16], pk_3[ri_16]) && (pk_3[ri_16] = pk_3) && (enc_7[ri_16] = enc_7) then
              find [unique]  suchthat info_6 = info_6[u_20] then
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, part1_3[u_20], part2_3[u_20]) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
              orfind u_31 = ri_33 <= Qdperuser suchthat defined(part2_5[ri_33], part1_5[ri_33], info_6[ri_33], u_20[ri_33]) && (u_20[ri_33] = u_20) && (info_6 = info_6[ri_33]) then
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, part1_5[u_31], part2_5[u_31]) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
              orfind  suchthat defined(part2_1, part1_1, info_star, i''_1, u_13) && (u_13 = u_20) && (i''_1 = i) && (info_6 = info_star) then
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, part1_1, part2_1) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
              else
                part2_5 <-R nonce_t;
                part1_5 <-R key_t;
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, part1_5, part2_5) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
            orfind  suchthat defined(part2, part1, info_star, enc_star, pk_S, i''_1) && (i = i''_1) && (pk_S = pk_3) && (enc_star = enc_7) then
              find [unique] u_33 = ri_37 <= Qdperuser suchthat defined(part2_4[ri_37], part1_4[ri_37], info_6[ri_37]) && (info_6 = info_6[ri_37]) then
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, part1_4[u_33], part2_4[u_33]) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
              orfind  suchthat info_6 = info_star then
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, part1, part2) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
              else
                part2_4 <-R nonce_t;
                part1_4 <-R key_t;
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, part1_4, part2_4) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
            else
              find u_22 = ri_18 <= N suchthat defined(s[ri_18]) && (pk_3 = pkgen(s[ri_18])) then
                let AuthDecap_Some(k0: kemkey_t) = AuthDecap(enc_7, skgen(s), pk_3) in
                  part2_3 <-R nonce_t;
                  part1_3 <-R key_t;
                  let injbot(pt_6: bitstring) = Open_inner(c, aad_9, part1_3, part2_3) in
                    return(OpenAuth_Some(Context_Open_Some(pt_6)))
                  else
                    return(OpenAuth_Some(Context_Open_None))
                else
                  return(OpenAuth_None)
              else
                let AuthDecap_Some(shared_secret_4: kemkey_t) = AuthDecap(enc_7, skgen(s), pk_3) in
                  r_4: keys_t <- KeySchedule_auth(shared_secret_4, info_6);
                  nonce_9: nonce_t <- get2(r_4);
                  key_8: key_t <- get1(r_4);
                  let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                    return(OpenAuth_Some(Context_Open_Some(pt_6)))
                  else
                    return(OpenAuth_Some(Context_Open_None))
                else
                  return(OpenAuth_None)
        ))
      ) | (
        Ochall(pk_S: pkey_t, pk_R: pkey_t, enc_star: kemciph_t, ciph_star: bitstring, aad_star: bitstring, info_star: bitstring) :=
        find i'_1 = i' <= N, i''_1 = i'' <= N suchthat defined(s[i'], s[i'']) && (pkgen(s[i']) = pk_S) && (pkgen(s[i'']) = pk_R) then
          find u = u_2 <= Qeperuser suchthat defined(info_5[u_2, i'_1], aad_8[u_2, i'_1], ct_8[u_2, i'_1], enc_4[u_2, i'_1], pk_2[u_2, i'_1]) && (pk_2[u_2, i'_1] = pk_R) && (enc_4[u_2, i'_1] = enc_star) && (ct_8[u_2, i'_1] = ciph_star) && (aad_8[u_2, i'_1] = aad_star) && (info_5[u_2, i'_1] = info_star) then
            return(bottom)
          else
            find u_4 = ri <= Qeperuser suchthat defined(part2_7[ri, i'_1], part1_7[ri, i'_1], info_5[ri, i'_1], ce_2[ri, i'_1], u_8[ri, i'_1]) && (i''_1 = u_8[ri, i'_1]) && (ce_2[ri, i'_1] = enc_star) then
              find [unique]  suchthat info_star = info_5[u_4, i'_1] then
                let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, part1_7[u_4, i'_1], part2_7[u_4, i'_1]) in
                  event_abort adv_wins
                else
                  return(bottom)
              orfind u_27 = ri_25 <= Qdperuser, u_28 = ri_26 <= N suchthat defined(part2_6[ri_25, ri_26], part1_6[ri_25, ri_26], info_6[ri_25, ri_26], u_7[ri_25, ri_26], u_6[ri_25, ri_26]) && (u_6[ri_25, ri_26] = u_4) && (u_7[ri_25, ri_26] = i'_1) && (info_star = info_6[ri_25, ri_26]) then
                let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, part1_6[u_27, u_28], part2_6[u_27, u_28]) in
                  event_abort adv_wins
                else
                  return(bottom)
              else
                part2_2 <-R nonce_t;
                part1_2 <-R key_t;
                let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, part1_2, part2_2) in
                  event_abort adv_wins
                else
                  return(bottom)
            else
              find u_13 = ri_9 <= Qdperuser suchthat defined(part2_3[ri_9, i''_1], part1_3[ri_9, i''_1], info_6[ri_9, i''_1], enc_7[ri_9, i''_1], u_22[ri_9, i''_1]) && (u_22[ri_9, i''_1] = i'_1) && (enc_7[ri_9, i''_1] = enc_star) then
                find [unique]  suchthat info_star = info_6[u_13, i''_1] then
                  let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, part1_3[u_13, i''_1], part2_3[u_13, i''_1]) in
                    event_abort adv_wins
                  else
                    return(bottom)
                orfind u_25 = ri_21 <= Qdperuser suchthat defined(part2_5[ri_21, i''_1], part1_5[ri_21, i''_1], info_6[ri_21, i''_1], u_20[ri_21, i''_1]) && (u_20[ri_21, i''_1] = u_13) && (info_star = info_6[ri_21, i''_1]) then
                  let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, part1_5[u_25, i''_1], part2_5[u_25, i''_1]) in
                    event_abort adv_wins
                  else
                    return(bottom)
                else
                  part2_1 <-R nonce_t;
                  part1_1 <-R key_t;
                  let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, part1_1, part2_1) in
                    event_abort adv_wins
                  else
                    return(bottom)
              else
                let AuthDecap_Some(k0_1: kemkey_t) = AuthDecap(enc_star, skgen(s[i''_1]), pk_S) in
                  part2 <-R nonce_t;
                  part1 <-R key_t;
                  let injbot(pt_7: bitstring) = Open_inner(ciph_star, aad_star, part1, part2) in
                    event_abort adv_wins
                  else
                    return(bottom)
                else
                  return(bottom)
        else
          return(bottom)
      ))


Applying equivalence int_ctxt(Seal_inner) with part1, part1_1, part1_5, part1_3, part1_2, part1_6, part1_7 [probability Adv_ctxt(time_4, 1 + #Oadec + #Oaenc, 1 + Qdperuser + #Oadec)]
  - Equivalence int_ctxt(Seal_inner) with variables: part2_2 -> n, part2_6 -> n, part2 -> n, part2_1 -> n, part2_5 -> n, part2_3 -> n, part2_7 -> n, part1_7 -> k_1, part1_6 -> k_1, part1_2 -> k_1, part1_3 -> k_1, part1_5 -> k_1, part1_1 -> k_1, part1 -> k_1
yields

Game 45 is
      ((
        foreach i <= N do
        Osetup() :=
        s <-R keypairseed_t;
        return(pkgen(s));
        ((
          foreach iae <= Qeperuser do
          Oaenc(pk_2: pkey_t, m: bitstring, aad_8: bitstring, info_5: bitstring) :=
          find u_8 = ri_4 <= N suchthat defined(s[ri_4]) && (pk_2 = pkgen(s[ri_4])) then
            k_3 <-R kemseed_t;
            sk_2: skey_t <- skgen(s);
            ce_2: kemciph_t <- AuthEncap_enc_r(k_3, pk_2, sk_2);
            enc_4: kemciph_t <- ce_2;
            part2_7 <-R nonce_t;
            part1_7 <-R key_t;
            ct_8: bitstring <- (x_8: bitstring <- m; d: bitstring <- aad_8; r_14: bitstring <- Seal_inner(x_8, d, part1_7, part2_7); r_14);
            return(SealAuth_Some(ce_2, ct_8))
          else
            k_2 <-R kemseed_t;
            sk_1: skey_t <- skgen(s);
            ce_1: kemciph_t <- AuthEncap_enc_r(k_2, pk_2, sk_1);
            k_5: kemkey_t <- AuthEncap_key_r(k_2, pk_2, sk_1);
            enc_4: kemciph_t <- ce_1;
            r_3: keys_t <- KeySchedule_auth(k_5, info_5);
            nonce_6: nonce_t <- get2(r_3);
            key_6: key_t <- get1(r_3);
            ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
            return(SealAuth_Some(ce_1, ct_8))
        ) | (
          foreach iad <= Qdperuser do
          Oadec(pk_3: pkey_t, enc_7: kemciph_t, c: bitstring, aad_9: bitstring, info_6: bitstring) :=
          find u_6 = ri_2 <= Qeperuser, u_7 = ri_3 <= N suchthat defined(part1_7[ri_2, ri_3], info_5[ri_2, ri_3], ce_2[ri_2, ri_3], s[ri_3], u_8[ri_2, ri_3]) && (i = u_8[ri_2, ri_3]) && (pkgen(s[ri_3]) = pk_3) && (ce_2[ri_2, ri_3] = enc_7) then
            find [unique]  suchthat info_6 = info_5[u_6, u_7] then
              let injbot(pt_6: bitstring) = (y_7: bitstring <- c; c_d_7: bitstring <- aad_9; if defined(x_8[u_6, u_7], d[u_6, u_7], r_14[u_6, u_7]) && (r_14[u_6, u_7] = y_7) && (d[u_6, u_7] = c_d_7) then injbot(x_8[u_6, u_7]) else bottom) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
            orfind u_35 = ri_39 <= Qdperuser suchthat defined(part1_6[ri_39], info_6[ri_39], u_7[ri_39], u_6[ri_39]) && (u_6[ri_39] = u_6) && (u_7[ri_39] = u_7) && (info_6 = info_6[ri_39]) then
              let injbot(pt_6: bitstring) = (y_8: bitstring <- c; c_d_8: bitstring <- aad_9; {328}find  else bottom) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
            orfind  suchthat defined(part1_2, info_star, i'_1, u_4) && (u_4 = u_6) && (i'_1 = u_7) && (info_6 = info_star) then
              let injbot(pt_6: bitstring) = (y_9: bitstring <- c; c_d_9: bitstring <- aad_9; {369}find  else bottom) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
            else
              part2_6 <-R nonce_t;
              part1_6 <-R key_t;
              let injbot(pt_6: bitstring) = (y_6: bitstring <- c; c_d_6: bitstring <- aad_9; {395}find  else bottom) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
          else
            find u_20 = ri_16 <= Qdperuser suchthat defined(part1_3[ri_16], info_6[ri_16], enc_7[ri_16], pk_3[ri_16]) && (pk_3[ri_16] = pk_3) && (enc_7[ri_16] = enc_7) then
              find [unique]  suchthat info_6 = info_6[u_20] then
                let injbot(pt_6: bitstring) = (y_2: bitstring <- c; c_d_2: bitstring <- aad_9; {453}find  else bottom) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
              orfind u_31 = ri_33 <= Qdperuser suchthat defined(part1_5[ri_33], info_6[ri_33], u_20[ri_33]) && (u_20[ri_33] = u_20) && (info_6 = info_6[ri_33]) then
                let injbot(pt_6: bitstring) = (y_3: bitstring <- c; c_d_3: bitstring <- aad_9; {498}find  else bottom) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
              orfind  suchthat defined(part1_1, info_star, i''_1, u_13) && (u_13 = u_20) && (i''_1 = i) && (info_6 = info_star) then
                let injbot(pt_6: bitstring) = (y_4: bitstring <- c; c_d_4: bitstring <- aad_9; {537}find  else bottom) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
              else
                part2_5 <-R nonce_t;
                part1_5 <-R key_t;
                let injbot(pt_6: bitstring) = (y_1: bitstring <- c; c_d_1: bitstring <- aad_9; {563}find  else bottom) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
            orfind  suchthat defined(part1, info_star, enc_star, pk_S, i''_1) && (i = i''_1) && (pk_S = pk_3) && (enc_star = enc_7) then
              find [unique] u_33 = ri_37 <= Qdperuser suchthat defined(part2_4[ri_37], part1_4[ri_37], info_6[ri_37]) && (info_6 = info_6[ri_37]) then
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, part1_4[u_33], part2_4[u_33]) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
              orfind  suchthat info_6 = info_star then
                let injbot(pt_6: bitstring) = (y_5: bitstring <- c; c_d_5: bitstring <- aad_9; {652}find  else bottom) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
              else
                part2_4 <-R nonce_t;
                part1_4 <-R key_t;
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, part1_4, part2_4) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
            else
              find u_22 = ri_18 <= N suchthat defined(s[ri_18]) && (pk_3 = pkgen(s[ri_18])) then
                let AuthDecap_Some(k0: kemkey_t) = AuthDecap(enc_7, skgen(s), pk_3) in
                  part2_3 <-R nonce_t;
                  part1_3 <-R key_t;
                  let injbot(pt_6: bitstring) = (y: bitstring <- c; c_d: bitstring <- aad_9; {727}find  else bottom) in
                    return(OpenAuth_Some(Context_Open_Some(pt_6)))
                  else
                    return(OpenAuth_Some(Context_Open_None))
                else
                  return(OpenAuth_None)
              else
                let AuthDecap_Some(shared_secret_4: kemkey_t) = AuthDecap(enc_7, skgen(s), pk_3) in
                  r_4: keys_t <- KeySchedule_auth(shared_secret_4, info_6);
                  nonce_9: nonce_t <- get2(r_4);
                  key_8: key_t <- get1(r_4);
                  let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                    return(OpenAuth_Some(Context_Open_Some(pt_6)))
                  else
                    return(OpenAuth_Some(Context_Open_None))
                else
                  return(OpenAuth_None)
        ))
      ) | (
        Ochall(pk_S: pkey_t, pk_R: pkey_t, enc_star: kemciph_t, ciph_star: bitstring, aad_star: bitstring, info_star: bitstring) :=
        find i'_1 = i' <= N, i''_1 = i'' <= N suchthat defined(s[i'], s[i'']) && (pkgen(s[i']) = pk_S) && (pkgen(s[i'']) = pk_R) then
          find u = u_2 <= Qeperuser suchthat defined(info_5[u_2, i'_1], aad_8[u_2, i'_1], ct_8[u_2, i'_1], enc_4[u_2, i'_1], pk_2[u_2, i'_1]) && (pk_2[u_2, i'_1] = pk_R) && (enc_4[u_2, i'_1] = enc_star) && (ct_8[u_2, i'_1] = ciph_star) && (aad_8[u_2, i'_1] = aad_star) && (info_5[u_2, i'_1] = info_star) then
            return(bottom)
          else
            find u_4 = ri <= Qeperuser suchthat defined(part1_7[ri, i'_1], info_5[ri, i'_1], ce_2[ri, i'_1], u_8[ri, i'_1]) && (i''_1 = u_8[ri, i'_1]) && (ce_2[ri, i'_1] = enc_star) then
              find [unique]  suchthat info_star = info_5[u_4, i'_1] then
                let injbot(pt_7: bitstring) = (y_15: bitstring <- ciph_star; c_d_15: bitstring <- aad_star; if defined(x_8[u_4, i'_1], d[u_4, i'_1], r_14[u_4, i'_1]) && (r_14[u_4, i'_1] = y_15) && (d[u_4, i'_1] = c_d_15) then injbot(x_8[u_4, i'_1]) else bottom) in
                  event_abort adv_wins
                else
                  return(bottom)
              orfind u_27 = ri_25 <= Qdperuser, u_28 = ri_26 <= N suchthat defined(part1_6[ri_25, ri_26], info_6[ri_25, ri_26], u_7[ri_25, ri_26], u_6[ri_25, ri_26]) && (u_6[ri_25, ri_26] = u_4) && (u_7[ri_25, ri_26] = i'_1) && (info_star = info_6[ri_25, ri_26]) then
                let injbot(pt_7: bitstring) = (y_16: bitstring <- ciph_star; c_d_16: bitstring <- aad_star; {957}find  else bottom) in
                  event_abort adv_wins
                else
                  return(bottom)
              else
                part2_2 <-R nonce_t;
                part1_2 <-R key_t;
                let injbot(pt_7: bitstring) = (y_14: bitstring <- ciph_star; c_d_14: bitstring <- aad_star; {971}find  else bottom) in
                  event_abort adv_wins
                else
                  return(bottom)
            else
              find u_13 = ri_9 <= Qdperuser suchthat defined(part1_3[ri_9, i''_1], info_6[ri_9, i''_1], enc_7[ri_9, i''_1], u_22[ri_9, i''_1]) && (u_22[ri_9, i''_1] = i'_1) && (enc_7[ri_9, i''_1] = enc_star) then
                find [unique]  suchthat info_star = info_6[u_13, i''_1] then
                  let injbot(pt_7: bitstring) = (y_12: bitstring <- ciph_star; c_d_12: bitstring <- aad_star; {1009}find  else bottom) in
                    event_abort adv_wins
                  else
                    return(bottom)
                orfind u_25 = ri_21 <= Qdperuser suchthat defined(part1_5[ri_21, i''_1], info_6[ri_21, i''_1], u_20[ri_21, i''_1]) && (u_20[ri_21, i''_1] = u_13) && (info_star = info_6[ri_21, i''_1]) then
                  let injbot(pt_7: bitstring) = (y_13: bitstring <- ciph_star; c_d_13: bitstring <- aad_star; {1038}find  else bottom) in
                    event_abort adv_wins
                  else
                    return(bottom)
                else
                  part2_1 <-R nonce_t;
                  part1_1 <-R key_t;
                  let injbot(pt_7: bitstring) = (y_11: bitstring <- ciph_star; c_d_11: bitstring <- aad_star; {1052}find  else bottom) in
                    event_abort adv_wins
                  else
                    return(bottom)
              else
                let AuthDecap_Some(k0_1: kemkey_t) = AuthDecap(enc_star, skgen(s[i''_1]), pk_S) in
                  part2 <-R nonce_t;
                  part1 <-R key_t;
                  let injbot(pt_7: bitstring) = (y_10: bitstring <- ciph_star; c_d_10: bitstring <- aad_star; {1073}find  else bottom) in
                    event_abort adv_wins
                  else
                    return(bottom)
                else
                  return(bottom)
        else
          return(bottom)
      ))


Applying simplify (non-expanded game)
  - Simplification pass
    - Find at 328 removed (else branch kept if any)
    - Find at 369 removed (else branch kept if any)
    - Find at 395 removed (else branch kept if any)
    - Find at 453 removed (else branch kept if any)
    - Find at 498 removed (else branch kept if any)
    - Find at 537 removed (else branch kept if any)
    - Find at 563 removed (else branch kept if any)
    - Find at 652 removed (else branch kept if any)
    - Find at 727 removed (else branch kept if any)
    - Find at 957 removed (else branch kept if any)
    - Find at 971 removed (else branch kept if any)
    - Find at 1009 removed (else branch kept if any)
    - Find at 1038 removed (else branch kept if any)
    - Find at 1052 removed (else branch kept if any)
    - Find at 1073 removed (else branch kept if any)
yields

Game 46 is
      ((
        foreach i <= N do
        Osetup() :=
        s <-R keypairseed_t;
        return(pkgen(s));
        ((
          foreach iae <= Qeperuser do
          Oaenc(pk_2: pkey_t, m: bitstring, aad_8: bitstring, info_5: bitstring) :=
          find u_8 = ri_4 <= N suchthat defined(s[ri_4]) && (pk_2 = pkgen(s[ri_4])) then
            k_3 <-R kemseed_t;
            sk_2: skey_t <- skgen(s);
            ce_2: kemciph_t <- AuthEncap_enc_r(k_3, pk_2, sk_2);
            enc_4: kemciph_t <- ce_2;
            part2_7 <-R nonce_t;
            part1_7 <-R key_t;
            ct_8: bitstring <- (x_8: bitstring <- m; d: bitstring <- aad_8; r_14: bitstring <- Seal_inner(x_8, d, part1_7, part2_7); r_14);
            return(SealAuth_Some(ce_2, ct_8))
          else
            k_2 <-R kemseed_t;
            sk_1: skey_t <- skgen(s);
            ce_1: kemciph_t <- AuthEncap_enc_r(k_2, pk_2, sk_1);
            k_5: kemkey_t <- AuthEncap_key_r(k_2, pk_2, sk_1);
            enc_4: kemciph_t <- ce_1;
            r_3: keys_t <- KeySchedule_auth(k_5, info_5);
            nonce_6: nonce_t <- get2(r_3);
            key_6: key_t <- get1(r_3);
            ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
            return(SealAuth_Some(ce_1, ct_8))
        ) | (
          foreach iad <= Qdperuser do
          Oadec(pk_3: pkey_t, enc_7: kemciph_t, c: bitstring, aad_9: bitstring, info_6: bitstring) :=
          find u_6 = ri_2 <= Qeperuser, u_7 = ri_3 <= N suchthat defined(part1_7[ri_2, ri_3], info_5[ri_2, ri_3], ce_2[ri_2, ri_3], s[ri_3], u_8[ri_2, ri_3]) && (i = u_8[ri_2, ri_3]) && (pkgen(s[ri_3]) = pk_3) && (ce_2[ri_2, ri_3] = enc_7) then
            find [unique]  suchthat info_6 = info_5[u_6, u_7] then
 {215}        let injbot(pt_6: bitstring) = (y_7: bitstring <- c; c_d_7: bitstring <- aad_9; if defined(x_8[u_6, u_7], d[u_6, u_7], r_14[u_6, u_7]) && (r_14[u_6, u_7] = y_7) && (d[u_6, u_7] = c_d_7) then injbot(x_8[u_6, u_7]) else bottom) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
            orfind u_35 = ri_39 <= Qdperuser suchthat defined(part1_6[ri_39], info_6[ri_39], u_7[ri_39], u_6[ri_39]) && (u_6[ri_39] = u_6) && (u_7[ri_39] = u_7) && (info_6 = info_6[ri_39]) then
 {319}        let injbot(pt_6: bitstring) = (y_8: bitstring <- c; c_d_8: bitstring <- aad_9; bottom) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
            orfind  suchthat defined(part1_2, info_star, i'_1, u_4) && (u_4 = u_6) && (i'_1 = u_7) && (info_6 = info_star) then
 {359}        let injbot(pt_6: bitstring) = (y_9: bitstring <- c; c_d_9: bitstring <- aad_9; bottom) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
            else
              part2_6 <-R nonce_t;
              part1_6 <-R key_t;
 {384}        let injbot(pt_6: bitstring) = (y_6: bitstring <- c; c_d_6: bitstring <- aad_9; bottom) in
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
          else
            find u_20 = ri_16 <= Qdperuser suchthat defined(part1_3[ri_16], info_6[ri_16], enc_7[ri_16], pk_3[ri_16]) && (pk_3[ri_16] = pk_3) && (enc_7[ri_16] = enc_7) then
              find [unique]  suchthat info_6 = info_6[u_20] then
 {441}          let injbot(pt_6: bitstring) = (y_2: bitstring <- c; c_d_2: bitstring <- aad_9; bottom) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
              orfind u_31 = ri_33 <= Qdperuser suchthat defined(part1_5[ri_33], info_6[ri_33], u_20[ri_33]) && (u_20[ri_33] = u_20) && (info_6 = info_6[ri_33]) then
 {485}          let injbot(pt_6: bitstring) = (y_3: bitstring <- c; c_d_3: bitstring <- aad_9; bottom) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
              orfind  suchthat defined(part1_1, info_star, i''_1, u_13) && (u_13 = u_20) && (i''_1 = i) && (info_6 = info_star) then
 {523}          let injbot(pt_6: bitstring) = (y_4: bitstring <- c; c_d_4: bitstring <- aad_9; bottom) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
              else
                part2_5 <-R nonce_t;
                part1_5 <-R key_t;
 {548}          let injbot(pt_6: bitstring) = (y_1: bitstring <- c; c_d_1: bitstring <- aad_9; bottom) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
            orfind  suchthat defined(part1, info_star, enc_star, pk_S, i''_1) && (i = i''_1) && (pk_S = pk_3) && (enc_star = enc_7) then
              find [unique] u_33 = ri_37 <= Qdperuser suchthat defined(part2_4[ri_37], part1_4[ri_37], info_6[ri_37]) && (info_6 = info_6[ri_37]) then
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, part1_4[u_33], part2_4[u_33]) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
              orfind  suchthat info_6 = info_star then
 {636}          let injbot(pt_6: bitstring) = (y_5: bitstring <- c; c_d_5: bitstring <- aad_9; bottom) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
              else
                part2_4 <-R nonce_t;
                part1_4 <-R key_t;
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, part1_4, part2_4) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
            else
              find u_22 = ri_18 <= N suchthat defined(s[ri_18]) && (pk_3 = pkgen(s[ri_18])) then
                let AuthDecap_Some(k0: kemkey_t) = AuthDecap(enc_7, skgen(s), pk_3) in
                  part2_3 <-R nonce_t;
                  part1_3 <-R key_t;
 {710}            let injbot(pt_6: bitstring) = (y: bitstring <- c; c_d: bitstring <- aad_9; bottom) in
                    return(OpenAuth_Some(Context_Open_Some(pt_6)))
                  else
                    return(OpenAuth_Some(Context_Open_None))
                else
                  return(OpenAuth_None)
              else
                let AuthDecap_Some(shared_secret_4: kemkey_t) = AuthDecap(enc_7, skgen(s), pk_3) in
                  r_4: keys_t <- KeySchedule_auth(shared_secret_4, info_6);
                  nonce_9: nonce_t <- get2(r_4);
                  key_8: key_t <- get1(r_4);
                  let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                    return(OpenAuth_Some(Context_Open_Some(pt_6)))
                  else
                    return(OpenAuth_Some(Context_Open_None))
                else
                  return(OpenAuth_None)
        ))
      ) | (
        Ochall(pk_S: pkey_t, pk_R: pkey_t, enc_star: kemciph_t, ciph_star: bitstring, aad_star: bitstring, info_star: bitstring) :=
        find i'_1 = i' <= N, i''_1 = i'' <= N suchthat defined(s[i'], s[i'']) && (pkgen(s[i']) = pk_S) && (pkgen(s[i'']) = pk_R) then
          find u = u_2 <= Qeperuser suchthat defined(info_5[u_2, i'_1], aad_8[u_2, i'_1], ct_8[u_2, i'_1], enc_4[u_2, i'_1], pk_2[u_2, i'_1]) && (pk_2[u_2, i'_1] = pk_R) && (enc_4[u_2, i'_1] = enc_star) && (ct_8[u_2, i'_1] = ciph_star) && (aad_8[u_2, i'_1] = aad_star) && (info_5[u_2, i'_1] = info_star) then
            return(bottom)
          else
            find u_4 = ri <= Qeperuser suchthat defined(part1_7[ri, i'_1], info_5[ri, i'_1], ce_2[ri, i'_1], u_8[ri, i'_1]) && (i''_1 = u_8[ri, i'_1]) && (ce_2[ri, i'_1] = enc_star) then
              find [unique]  suchthat info_star = info_5[u_4, i'_1] then
 {885}          let injbot(pt_7: bitstring) = (y_15: bitstring <- ciph_star; c_d_15: bitstring <- aad_star; if defined(x_8[u_4, i'_1], d[u_4, i'_1], r_14[u_4, i'_1]) && (r_14[u_4, i'_1] = y_15) && (d[u_4, i'_1] = c_d_15) then injbot(x_8[u_4, i'_1]) else bottom) in
                  event_abort adv_wins
                else
                  return(bottom)
              orfind u_27 = ri_25 <= Qdperuser, u_28 = ri_26 <= N suchthat defined(part1_6[ri_25, ri_26], info_6[ri_25, ri_26], u_7[ri_25, ri_26], u_6[ri_25, ri_26]) && (u_6[ri_25, ri_26] = u_4) && (u_7[ri_25, ri_26] = i'_1) && (info_star = info_6[ri_25, ri_26]) then
 {943}          let injbot(pt_7: bitstring) = (y_16: bitstring <- ciph_star; c_d_16: bitstring <- aad_star; bottom) in
                  event_abort adv_wins
                else
                  return(bottom)
              else
                part2_2 <-R nonce_t;
                part1_2 <-R key_t;
 {956}          let injbot(pt_7: bitstring) = (y_14: bitstring <- ciph_star; c_d_14: bitstring <- aad_star; bottom) in
                  event_abort adv_wins
                else
                  return(bottom)
            else
              find u_13 = ri_9 <= Qdperuser suchthat defined(part1_3[ri_9, i''_1], info_6[ri_9, i''_1], enc_7[ri_9, i''_1], u_22[ri_9, i''_1]) && (u_22[ri_9, i''_1] = i'_1) && (enc_7[ri_9, i''_1] = enc_star) then
                find [unique]  suchthat info_star = info_6[u_13, i''_1] then
 {993}            let injbot(pt_7: bitstring) = (y_12: bitstring <- ciph_star; c_d_12: bitstring <- aad_star; bottom) in
                    event_abort adv_wins
                  else
                    return(bottom)
                orfind u_25 = ri_21 <= Qdperuser suchthat defined(part1_5[ri_21, i''_1], info_6[ri_21, i''_1], u_20[ri_21, i''_1]) && (u_20[ri_21, i''_1] = u_13) && (info_star = info_6[ri_21, i''_1]) then
{1021}            let injbot(pt_7: bitstring) = (y_13: bitstring <- ciph_star; c_d_13: bitstring <- aad_star; bottom) in
                    event_abort adv_wins
                  else
                    return(bottom)
                else
                  part2_1 <-R nonce_t;
                  part1_1 <-R key_t;
{1034}            let injbot(pt_7: bitstring) = (y_11: bitstring <- ciph_star; c_d_11: bitstring <- aad_star; bottom) in
                    event_abort adv_wins
                  else
                    return(bottom)
              else
                let AuthDecap_Some(k0_1: kemkey_t) = AuthDecap(enc_star, skgen(s[i''_1]), pk_S) in
                  part2 <-R nonce_t;
                  part1 <-R key_t;
{1054}            let injbot(pt_7: bitstring) = (y_10: bitstring <- ciph_star; c_d_10: bitstring <- aad_star; bottom) in
                    event_abort adv_wins
                  else
                    return(bottom)
                else
                  return(bottom)
        else
          return(bottom)
      ))


Applying expand [probability N^2 * P_pk_coll]
  - Expand if/find/let
    - Remove let at 1054
    - Remove let at 1034
    - Remove let at 1021
    - Remove let at 993
    - Remove let at 956
    - Remove let at 943
    - Remove let at 885
    - Simplify pattern injbot(pt_7: bitstring) (tuple expanded) at 885
    - Remove else branch of let at 885
    - Remove let at 710
    - Remove let at 636
    - Remove let at 548
    - Remove let at 523
    - Remove let at 485
    - Remove let at 441
    - Remove let at 384
    - Remove let at 359
    - Remove let at 319
    - Remove let at 215
    - Simplify pattern injbot(pt_6: bitstring) (tuple expanded) at 215
    - Remove else branch of let at 215
yields

Game 47 is
      ((
        foreach i <= N do
        Osetup() :=
        s <-R keypairseed_t;
        return(pkgen(s));
        ((
          foreach iae <= Qeperuser do
          Oaenc(pk_2: pkey_t, m: bitstring, aad_8: bitstring, info_5: bitstring) :=
          find u_8 = ri_4 <= N suchthat defined(s[ri_4]) && (pk_2 = pkgen(s[ri_4])) then
            k_3 <-R kemseed_t;
            sk_2: skey_t <- skgen(s);
            ce_2: kemciph_t <- AuthEncap_enc_r(k_3, pk_2, sk_2);
            enc_4: kemciph_t <- ce_2;
            part2_7 <-R nonce_t;
            part1_7 <-R key_t;
            x_8: bitstring <- m;
            d: bitstring <- aad_8;
            r_14: bitstring <- Seal_inner(x_8, d, part1_7, part2_7);
            ct_8: bitstring <- r_14;
            return(SealAuth_Some(ce_2, ct_8))
          else
            k_2 <-R kemseed_t;
            sk_1: skey_t <- skgen(s);
            ce_1: kemciph_t <- AuthEncap_enc_r(k_2, pk_2, sk_1);
            k_5: kemkey_t <- AuthEncap_key_r(k_2, pk_2, sk_1);
            enc_4: kemciph_t <- ce_1;
            r_3: keys_t <- KeySchedule_auth(k_5, info_5);
            nonce_6: nonce_t <- get2(r_3);
            key_6: key_t <- get1(r_3);
            ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
            return(SealAuth_Some(ce_1, ct_8))
        ) | (
          foreach iad <= Qdperuser do
          Oadec(pk_3: pkey_t, enc_7: kemciph_t, c: bitstring, aad_9: bitstring, info_6: bitstring) :=
          find u_6 = ri_2 <= Qeperuser, u_7 = ri_3 <= N suchthat defined(part1_7[ri_2, ri_3], info_5[ri_2, ri_3], ce_2[ri_2, ri_3], s[ri_3], u_8[ri_2, ri_3]) && (i = u_8[ri_2, ri_3]) && (pkgen(s[ri_3]) = pk_3) && (ce_2[ri_2, ri_3] = enc_7) then
            find [unique]  suchthat info_6 = info_5[u_6, u_7] then
              y_7: bitstring <- c;
              c_d_7: bitstring <- aad_9;
              if defined(x_8[u_6, u_7], d[u_6, u_7], r_14[u_6, u_7]) && (r_14[u_6, u_7] = y_7) && (d[u_6, u_7] = c_d_7) then
                pt_6: bitstring <- x_8[u_6, u_7];
                return(OpenAuth_Some(Context_Open_Some(pt_6)))
              else
                return(OpenAuth_Some(Context_Open_None))
            orfind u_35 = ri_39 <= Qdperuser suchthat defined(part1_6[ri_39], info_6[ri_39], u_7[ri_39], u_6[ri_39]) && (u_6[ri_39] = u_6) && (u_7[ri_39] = u_7) && (info_6 = info_6[ri_39]) then
              y_8: bitstring <- c;
              c_d_8: bitstring <- aad_9;
              return(OpenAuth_Some(Context_Open_None))
            orfind  suchthat defined(part1_2, info_star, i'_1, u_4) && (u_4 = u_6) && (i'_1 = u_7) && (info_6 = info_star) then
              y_9: bitstring <- c;
              c_d_9: bitstring <- aad_9;
              return(OpenAuth_Some(Context_Open_None))
            else
              part2_6 <-R nonce_t;
              part1_6 <-R key_t;
              y_6: bitstring <- c;
              c_d_6: bitstring <- aad_9;
              return(OpenAuth_Some(Context_Open_None))
          else
            find u_20 = ri_16 <= Qdperuser suchthat defined(part1_3[ri_16], info_6[ri_16], enc_7[ri_16], pk_3[ri_16]) && (pk_3[ri_16] = pk_3) && (enc_7[ri_16] = enc_7) then
              find [unique]  suchthat info_6 = info_6[u_20] then
                y_2: bitstring <- c;
                c_d_2: bitstring <- aad_9;
                return(OpenAuth_Some(Context_Open_None))
              orfind u_31 = ri_33 <= Qdperuser suchthat defined(part1_5[ri_33], info_6[ri_33], u_20[ri_33]) && (u_20[ri_33] = u_20) && (info_6 = info_6[ri_33]) then
                y_3: bitstring <- c;
                c_d_3: bitstring <- aad_9;
                return(OpenAuth_Some(Context_Open_None))
              orfind  suchthat defined(part1_1, info_star, i''_1, u_13) && (u_13 = u_20) && (i''_1 = i) && (info_6 = info_star) then
                y_4: bitstring <- c;
                c_d_4: bitstring <- aad_9;
                return(OpenAuth_Some(Context_Open_None))
              else
                part2_5 <-R nonce_t;
                part1_5 <-R key_t;
                y_1: bitstring <- c;
                c_d_1: bitstring <- aad_9;
                return(OpenAuth_Some(Context_Open_None))
            orfind  suchthat defined(part1, info_star, enc_star, pk_S, i''_1) && (i = i''_1) && (pk_S = pk_3) && (enc_star = enc_7) then
              find [unique] u_33 = ri_37 <= Qdperuser suchthat defined(part2_4[ri_37], part1_4[ri_37], info_6[ri_37]) && (info_6 = info_6[ri_37]) then
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, part1_4[u_33], part2_4[u_33]) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
              orfind  suchthat info_6 = info_star then
                y_5: bitstring <- c;
                c_d_5: bitstring <- aad_9;
                return(OpenAuth_Some(Context_Open_None))
              else
                part2_4 <-R nonce_t;
                part1_4 <-R key_t;
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, part1_4, part2_4) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
            else
              find u_22 = ri_18 <= N suchthat defined(s[ri_18]) && (pk_3 = pkgen(s[ri_18])) then
                let AuthDecap_Some(k0: kemkey_t) = AuthDecap(enc_7, skgen(s), pk_3) in
                  part2_3 <-R nonce_t;
                  part1_3 <-R key_t;
                  y: bitstring <- c;
                  c_d: bitstring <- aad_9;
                  return(OpenAuth_Some(Context_Open_None))
                else
                  return(OpenAuth_None)
              else
                let AuthDecap_Some(shared_secret_4: kemkey_t) = AuthDecap(enc_7, skgen(s), pk_3) in
                  r_4: keys_t <- KeySchedule_auth(shared_secret_4, info_6);
                  nonce_9: nonce_t <- get2(r_4);
                  key_8: key_t <- get1(r_4);
                  let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                    return(OpenAuth_Some(Context_Open_Some(pt_6)))
                  else
                    return(OpenAuth_Some(Context_Open_None))
                else
                  return(OpenAuth_None)
        ))
      ) | (
        Ochall(pk_S: pkey_t, pk_R: pkey_t, enc_star: kemciph_t, ciph_star: bitstring, aad_star: bitstring, info_star: bitstring) :=
        find i'_1 = i' <= N, i''_1 = i'' <= N suchthat defined(s[i'], s[i'']) && (pkgen(s[i']) = pk_S) && (pkgen(s[i'']) = pk_R) then
          find u = u_2 <= Qeperuser suchthat defined(info_5[u_2, i'_1], aad_8[u_2, i'_1], ct_8[u_2, i'_1], enc_4[u_2, i'_1], pk_2[u_2, i'_1]) && (pk_2[u_2, i'_1] = pk_R) && (enc_4[u_2, i'_1] = enc_star) && (ct_8[u_2, i'_1] = ciph_star) && (aad_8[u_2, i'_1] = aad_star) && (info_5[u_2, i'_1] = info_star) then
            return(bottom)
          else
            find u_4 = ri <= Qeperuser suchthat defined(part1_7[ri, i'_1], info_5[ri, i'_1], ce_2[ri, i'_1], u_8[ri, i'_1]) && (i''_1 = u_8[ri, i'_1]) && (ce_2[ri, i'_1] = enc_star) then
              find [unique]  suchthat info_star = info_5[u_4, i'_1] then
                y_15: bitstring <- ciph_star;
                c_d_15: bitstring <- aad_star;
                if defined(x_8[u_4, i'_1], d[u_4, i'_1], r_14[u_4, i'_1]) && (r_14[u_4, i'_1] = y_15) && (d[u_4, i'_1] = c_d_15) then
                  pt_7: bitstring <- x_8[u_4, i'_1];
                  event_abort adv_wins
                else
                  return(bottom)
              orfind u_27 = ri_25 <= Qdperuser, u_28 = ri_26 <= N suchthat defined(part1_6[ri_25, ri_26], info_6[ri_25, ri_26], u_7[ri_25, ri_26], u_6[ri_25, ri_26]) && (u_6[ri_25, ri_26] = u_4) && (u_7[ri_25, ri_26] = i'_1) && (info_star = info_6[ri_25, ri_26]) then
                y_16: bitstring <- ciph_star;
                c_d_16: bitstring <- aad_star;
                return(bottom)
              else
                part2_2 <-R nonce_t;
                part1_2 <-R key_t;
                y_14: bitstring <- ciph_star;
                c_d_14: bitstring <- aad_star;
                return(bottom)
            else
              find u_13 = ri_9 <= Qdperuser suchthat defined(part1_3[ri_9, i''_1], info_6[ri_9, i''_1], enc_7[ri_9, i''_1], u_22[ri_9, i''_1]) && (u_22[ri_9, i''_1] = i'_1) && (enc_7[ri_9, i''_1] = enc_star) then
                find [unique]  suchthat info_star = info_6[u_13, i''_1] then
                  y_12: bitstring <- ciph_star;
                  c_d_12: bitstring <- aad_star;
                  return(bottom)
                orfind u_25 = ri_21 <= Qdperuser suchthat defined(part1_5[ri_21, i''_1], info_6[ri_21, i''_1], u_20[ri_21, i''_1]) && (u_20[ri_21, i''_1] = u_13) && (info_star = info_6[ri_21, i''_1]) then
                  y_13: bitstring <- ciph_star;
                  c_d_13: bitstring <- aad_star;
                  return(bottom)
                else
                  part2_1 <-R nonce_t;
                  part1_1 <-R key_t;
                  y_11: bitstring <- ciph_star;
                  c_d_11: bitstring <- aad_star;
                  return(bottom)
              else
                let AuthDecap_Some(k0_1: kemkey_t) = AuthDecap(enc_star, skgen(s[i''_1]), pk_S) in
                  part2 <-R nonce_t;
                  part1 <-R key_t;
                  y_10: bitstring <- ciph_star;
                  c_d_10: bitstring <- aad_star;
                  return(bottom)
                else
                  return(bottom)
        else
          return(bottom)
      ))


Applying remove assignments of findcond
  - Remove assignments on y_10 (definition removed, all usages removed)
  - Remove assignments on c_d_10 (definition removed, all usages removed)
  - Remove assignments on y_11 (definition removed, all usages removed)
  - Remove assignments on c_d_11 (definition removed, all usages removed)
  - Remove assignments on y_12 (definition removed, all usages removed)
  - Remove assignments on c_d_12 (definition removed, all usages removed)
  - Remove assignments on y_13 (definition removed, all usages removed)
  - Remove assignments on c_d_13 (definition removed, all usages removed)
  - Remove assignments on y_14 (definition removed, all usages removed)
  - Remove assignments on c_d_14 (definition removed, all usages removed)
  - Remove assignments on y_15 (definition removed, all usages removed)
  - Remove assignments on c_d_15 (definition removed, all usages removed)
  - Remove assignments on pt_7 (definition removed, all usages removed)
  - Remove assignments on y_16 (definition removed, all usages removed)
  - Remove assignments on c_d_16 (definition removed, all usages removed)
  - Remove assignments on y (definition removed, all usages removed)
  - Remove assignments on c_d (definition removed, all usages removed)
  - Remove assignments on y_1 (definition removed, all usages removed)
  - Remove assignments on c_d_1 (definition removed, all usages removed)
  - Remove assignments on y_2 (definition removed, all usages removed)
  - Remove assignments on c_d_2 (definition removed, all usages removed)
  - Remove assignments on y_3 (definition removed, all usages removed)
  - Remove assignments on c_d_3 (definition removed, all usages removed)
  - Remove assignments on y_4 (definition removed, all usages removed)
  - Remove assignments on c_d_4 (definition removed, all usages removed)
  - Remove assignments on y_5 (definition removed, all usages removed)
  - Remove assignments on c_d_5 (definition removed, all usages removed)
  - Remove assignments on y_6 (definition removed, all usages removed)
  - Remove assignments on c_d_6 (definition removed, all usages removed)
  - Remove assignments on y_7 (definition removed, all usages removed)
  - Remove assignments on c_d_7 (definition removed, all usages removed)
  - Remove assignments on pt_6 (definition removed, all usages removed)
  - Remove assignments on y_8 (definition removed, all usages removed)
  - Remove assignments on c_d_8 (definition removed, all usages removed)
  - Remove assignments on y_9 (definition removed, all usages removed)
  - Remove assignments on c_d_9 (definition removed, all usages removed)
  - Remove assignments on x_8 (definition removed, all usages removed)
  - Remove assignments on d (definition removed, all usages removed)
  - Remove assignments on ct_8 (definition kept, array references kept)
yields

Game 48 is
      ((
        foreach i <= N do
        Osetup() :=
        s <-R keypairseed_t;
        return(pkgen(s));
        ((
          foreach iae <= Qeperuser do
          Oaenc(pk_2: pkey_t, m: bitstring, aad_8: bitstring, info_5: bitstring) :=
          find u_8 = ri_4 <= N suchthat defined(s[ri_4]) && (pk_2 = pkgen(s[ri_4])) then
            k_3 <-R kemseed_t;
            sk_2: skey_t <- skgen(s);
            ce_2: kemciph_t <- AuthEncap_enc_r(k_3, pk_2, sk_2);
            enc_4: kemciph_t <- ce_2;
            part2_7 <-R nonce_t;
            part1_7 <-R key_t;
            r_14: bitstring <- Seal_inner(m, aad_8, part1_7, part2_7);
            ct_8: bitstring <- r_14;
            return(SealAuth_Some(ce_2, r_14))
          else
            k_2 <-R kemseed_t;
            sk_1: skey_t <- skgen(s);
            ce_1: kemciph_t <- AuthEncap_enc_r(k_2, pk_2, sk_1);
            k_5: kemkey_t <- AuthEncap_key_r(k_2, pk_2, sk_1);
            enc_4: kemciph_t <- ce_1;
            r_3: keys_t <- KeySchedule_auth(k_5, info_5);
            nonce_6: nonce_t <- get2(r_3);
            key_6: key_t <- get1(r_3);
            ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
            return(SealAuth_Some(ce_1, ct_8))
        ) | (
          foreach iad <= Qdperuser do
          Oadec(pk_3: pkey_t, enc_7: kemciph_t, c: bitstring, aad_9: bitstring, info_6: bitstring) :=
          find u_6 = ri_2 <= Qeperuser, u_7 = ri_3 <= N suchthat defined(part1_7[ri_2, ri_3], info_5[ri_2, ri_3], ce_2[ri_2, ri_3], s[ri_3], u_8[ri_2, ri_3]) && (i = u_8[ri_2, ri_3]) && (pkgen(s[ri_3]) = pk_3) && (ce_2[ri_2, ri_3] = enc_7) then
 {196}      find [unique]  suchthat info_6 = info_5[u_6, u_7] then
 {208}        if defined(m[u_6, u_7], aad_8[u_6, u_7], part1_7[u_6, u_7], r_14[u_6, u_7]) && (r_14[u_6, u_7] = c) && (aad_8[u_6, u_7] = aad_9) then
                return(OpenAuth_Some(Context_Open_Some(m[u_6, u_7])))
              else
                return(OpenAuth_Some(Context_Open_None))
            orfind u_35 = ri_39 <= Qdperuser suchthat defined(part1_6[ri_39], info_6[ri_39], u_7[ri_39], u_6[ri_39]) && (u_6[ri_39] = u_6) && (u_7[ri_39] = u_7) && (info_6 = info_6[ri_39]) then
              return(OpenAuth_Some(Context_Open_None))
            orfind  suchthat defined(part1_2, info_star, i'_1, u_4) && (u_4 = u_6) && (i'_1 = u_7) && (info_6 = info_star) then
              return(OpenAuth_Some(Context_Open_None))
            else
              part2_6 <-R nonce_t;
              part1_6 <-R key_t;
              return(OpenAuth_Some(Context_Open_None))
          else
            find u_20 = ri_16 <= Qdperuser suchthat defined(part1_3[ri_16], info_6[ri_16], enc_7[ri_16], pk_3[ri_16]) && (pk_3[ri_16] = pk_3) && (enc_7[ri_16] = enc_7) then
              find [unique]  suchthat info_6 = info_6[u_20] then
                return(OpenAuth_Some(Context_Open_None))
              orfind u_31 = ri_33 <= Qdperuser suchthat defined(part1_5[ri_33], info_6[ri_33], u_20[ri_33]) && (u_20[ri_33] = u_20) && (info_6 = info_6[ri_33]) then
                return(OpenAuth_Some(Context_Open_None))
              orfind  suchthat defined(part1_1, info_star, i''_1, u_13) && (u_13 = u_20) && (i''_1 = i) && (info_6 = info_star) then
                return(OpenAuth_Some(Context_Open_None))
              else
 {423}          part2_5 <-R nonce_t;
 {424}          part1_5 <-R key_t;
                return(OpenAuth_Some(Context_Open_None))
            orfind  suchthat defined(part1, info_star, enc_star, pk_S, i''_1) && (i = i''_1) && (pk_S = pk_3) && (enc_star = enc_7) then
              find [unique] u_33 = ri_37 <= Qdperuser suchthat defined(part2_4[ri_37], part1_4[ri_37], info_6[ri_37]) && (info_6 = info_6[ri_37]) then
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, part1_4[u_33], part2_4[u_33]) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
              orfind  suchthat info_6 = info_star then
                return(OpenAuth_Some(Context_Open_None))
              else
                part2_4 <-R nonce_t;
                part1_4 <-R key_t;
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, part1_4, part2_4) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
            else
              find u_22 = ri_18 <= N suchthat defined(s[ri_18]) && (pk_3 = pkgen(s[ri_18])) then
                let AuthDecap_Some(k0: kemkey_t) = AuthDecap(enc_7, skgen(s), pk_3) in
 {549}            part2_3 <-R nonce_t;
 {550}            part1_3 <-R key_t;
                  return(OpenAuth_Some(Context_Open_None))
                else
                  return(OpenAuth_None)
              else
                let AuthDecap_Some(shared_secret_4: kemkey_t) = AuthDecap(enc_7, skgen(s), pk_3) in
                  r_4: keys_t <- KeySchedule_auth(shared_secret_4, info_6);
                  nonce_9: nonce_t <- get2(r_4);
                  key_8: key_t <- get1(r_4);
                  let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                    return(OpenAuth_Some(Context_Open_Some(pt_6)))
                  else
                    return(OpenAuth_Some(Context_Open_None))
                else
                  return(OpenAuth_None)
        ))
      ) | (
        Ochall(pk_S: pkey_t, pk_R: pkey_t, enc_star: kemciph_t, ciph_star: bitstring, aad_star: bitstring, info_star: bitstring) :=
        find i'_1 = i' <= N, i''_1 = i'' <= N suchthat defined(s[i'], s[i'']) && (pkgen(s[i']) = pk_S) && (pkgen(s[i'']) = pk_R) then
          find u = u_2 <= Qeperuser suchthat defined(info_5[u_2, i'_1], aad_8[u_2, i'_1], ct_8[u_2, i'_1], enc_4[u_2, i'_1], pk_2[u_2, i'_1]) && (pk_2[u_2, i'_1] = pk_R) && (enc_4[u_2, i'_1] = enc_star) && (ct_8[u_2, i'_1] = ciph_star) && (aad_8[u_2, i'_1] = aad_star) && (info_5[u_2, i'_1] = info_star) then
            return(bottom)
          else
            find u_4 = ri <= Qeperuser suchthat defined(part1_7[ri, i'_1], info_5[ri, i'_1], ce_2[ri, i'_1], u_8[ri, i'_1]) && (i''_1 = u_8[ri, i'_1]) && (ce_2[ri, i'_1] = enc_star) then
 {702}        find [unique]  suchthat info_star = info_5[u_4, i'_1] then
 {708}          if defined(m[u_4, i'_1], aad_8[u_4, i'_1], part1_7[u_4, i'_1], r_14[u_4, i'_1]) && (r_14[u_4, i'_1] = ciph_star) && (aad_8[u_4, i'_1] = aad_star) then
                  event_abort adv_wins
                else
                  return(bottom)
              orfind u_27 = ri_25 <= Qdperuser, u_28 = ri_26 <= N suchthat defined(part1_6[ri_25, ri_26], info_6[ri_25, ri_26], u_7[ri_25, ri_26], u_6[ri_25, ri_26]) && (u_6[ri_25, ri_26] = u_4) && (u_7[ri_25, ri_26] = i'_1) && (info_star = info_6[ri_25, ri_26]) then
                return(bottom)
              else
                part2_2 <-R nonce_t;
                part1_2 <-R key_t;
                return(bottom)
            else
              find u_13 = ri_9 <= Qdperuser suchthat defined(part1_3[ri_9, i''_1], info_6[ri_9, i''_1], enc_7[ri_9, i''_1], u_22[ri_9, i''_1]) && (u_22[ri_9, i''_1] = i'_1) && (enc_7[ri_9, i''_1] = enc_star) then
                find [unique]  suchthat info_star = info_6[u_13, i''_1] then
                  return(bottom)
                orfind u_25 = ri_21 <= Qdperuser suchthat defined(part1_5[ri_21, i''_1], info_6[ri_21, i''_1], u_20[ri_21, i''_1]) && (u_20[ri_21, i''_1] = u_13) && (info_star = info_6[ri_21, i''_1]) then
                  return(bottom)
                else
 {819}            part2_1 <-R nonce_t;
 {820}            part1_1 <-R key_t;
                  return(bottom)
              else
                let AuthDecap_Some(k0_1: kemkey_t) = AuthDecap(enc_star, skgen(s[i''_1]), pk_S) in
 {832}            part2 <-R nonce_t;
 {833}            part1 <-R key_t;
                  return(bottom)
                else
                  return(bottom)
        else
          return(bottom)
      ))


Applying simplify [probability N^2 * P_pk_coll]
  - Simplification pass
    - Transform unused random number generation at 833 into constant assignment
    - Remove random number generation at 832
    - Transform unused random number generation at 820 into constant assignment
    - Remove random number generation at 819
    - Simplified find at 708 in branch of find at 702
    - Transform unused random number generation at 550 into constant assignment
    - Remove random number generation at 549
    - Transform unused random number generation at 424 into constant assignment
    - Remove random number generation at 423
    - Simplified find at 208 in branch of find at 196
yields

Game 49 is
      ((
        foreach i <= N do
        Osetup() :=
        s <-R keypairseed_t;
        return(pkgen(s));
        ((
          foreach iae <= Qeperuser do
          Oaenc(pk_2: pkey_t, m: bitstring, aad_8: bitstring, info_5: bitstring) :=
          find u_8 = ri_4 <= N suchthat defined(s[ri_4]) && (pk_2 = pkgen(s[ri_4])) then
            k_3 <-R kemseed_t;
            sk_2: skey_t <- skgen(s);
            ce_2: kemciph_t <- AuthEncap_enc_r(k_3, pk_2, sk_2);
            enc_4: kemciph_t <- ce_2;
            part2_7 <-R nonce_t;
            part1_7 <-R key_t;
            r_14: bitstring <- Seal_inner(m, aad_8, part1_7, part2_7);
            ct_8: bitstring <- r_14;
            return(SealAuth_Some(ce_2, r_14))
          else
            k_2 <-R kemseed_t;
            sk_1: skey_t <- skgen(s);
            ce_1: kemciph_t <- AuthEncap_enc_r(k_2, pk_2, sk_1);
            k_5: kemkey_t <- AuthEncap_key_r(k_2, pk_2, sk_1);
            enc_4: kemciph_t <- ce_1;
            r_3: keys_t <- KeySchedule_auth(k_5, info_5);
            nonce_6: nonce_t <- get2(r_3);
            key_6: key_t <- get1(r_3);
            ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
            return(SealAuth_Some(ce_1, ct_8))
        ) | (
          foreach iad <= Qdperuser do
          Oadec(pk_3: pkey_t, enc_7: kemciph_t, c: bitstring, aad_9: bitstring, info_6: bitstring) :=
 {165}    find u_6 = ri_2 <= Qeperuser, u_7 = ri_3 <= N suchthat defined(part1_7[ri_2, ri_3], info_5[ri_2, ri_3], ce_2[ri_2, ri_3], s[ri_3], u_8[ri_2, ri_3]) && (i = u_8[ri_2, ri_3]) && (pkgen(s[ri_3]) = pk_3) && (ce_2[ri_2, ri_3] = enc_7) then
 {196}      find [unique]  suchthat defined(m[u_6, u_7], aad_8[u_6, u_7], part1_7[u_6, u_7], r_14[u_6, u_7]) && (info_6 = info_5[u_6, u_7]) && (r_14[u_6, u_7] = c) && (aad_8[u_6, u_7] = aad_9) then
              return(OpenAuth_Some(Context_Open_Some(m[u_6, u_7])))
            orfind u_35 = ri_39 <= Qdperuser suchthat defined(part1_6[ri_39], info_6[ri_39], u_7[ri_39], u_6[ri_39]) && (u_6[ri_39] = u_6) && (u_7[ri_39] = u_7) && (info_6 = info_6[ri_39]) then
              return(OpenAuth_Some(Context_Open_None))
            orfind  suchthat defined(part1_2, info_star, i'_1, u_4) && (u_4 = u_6) && (i'_1 = u_7) && (info_6 = info_star) then
              return(OpenAuth_Some(Context_Open_None))
            else
 {326}        if info_6 = info_5[u_6, u_7] then
                return(OpenAuth_Some(Context_Open_None))
              else
 {343}          part2_6 <-R nonce_t;
 {344}          part1_6 <-R key_t;
                return(OpenAuth_Some(Context_Open_None))
          else
            find u_20 = ri_16 <= Qdperuser suchthat defined(part1_3[ri_16], info_6[ri_16], enc_7[ri_16], pk_3[ri_16]) && (pk_3[ri_16] = pk_3) && (enc_7[ri_16] = enc_7) then
              find [unique]  suchthat info_6 = info_6[u_20] then
                return(OpenAuth_Some(Context_Open_None))
              orfind u_31 = ri_33 <= Qdperuser suchthat defined(part1_5[ri_33], info_6[ri_33], u_20[ri_33]) && (u_20[ri_33] = u_20) && (info_6 = info_6[ri_33]) then
                return(OpenAuth_Some(Context_Open_None))
              orfind  suchthat defined(part1_1, info_star, i''_1, u_13) && (u_13 = u_20) && (i''_1 = i) && (info_6 = info_star) then
                return(OpenAuth_Some(Context_Open_None))
              else
                part1_5: key_t <- cst_key_t;
                return(OpenAuth_Some(Context_Open_None))
            orfind  suchthat defined(part1, info_star, enc_star, pk_S, i''_1) && (i = i''_1) && (pk_S = pk_3) && (enc_star = enc_7) then
              find [unique] u_33 = ri_37 <= Qdperuser suchthat defined(part2_4[ri_37], part1_4[ri_37], info_6[ri_37]) && (info_6 = info_6[ri_37]) then
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, part1_4[u_33], part2_4[u_33]) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
              orfind  suchthat info_6 = info_star then
                return(OpenAuth_Some(Context_Open_None))
              else
                part2_4 <-R nonce_t;
                part1_4 <-R key_t;
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, part1_4, part2_4) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
            else
              find u_22 = ri_18 <= N suchthat defined(s[ri_18]) && (pk_3 = pkgen(s[ri_18])) then
                let AuthDecap_Some(k0: kemkey_t) = AuthDecap(enc_7, skgen(s), pk_3) in
                  part1_3: key_t <- cst_key_t;
                  return(OpenAuth_Some(Context_Open_None))
                else
                  return(OpenAuth_None)
              else
                let AuthDecap_Some(shared_secret_4: kemkey_t) = AuthDecap(enc_7, skgen(s), pk_3) in
                  r_4: keys_t <- KeySchedule_auth(shared_secret_4, info_6);
                  nonce_9: nonce_t <- get2(r_4);
                  key_8: key_t <- get1(r_4);
                  let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                    return(OpenAuth_Some(Context_Open_Some(pt_6)))
                  else
                    return(OpenAuth_Some(Context_Open_None))
                else
                  return(OpenAuth_None)
        ))
      ) | (
        Ochall(pk_S: pkey_t, pk_R: pkey_t, enc_star: kemciph_t, ciph_star: bitstring, aad_star: bitstring, info_star: bitstring) :=
        find i'_1 = i' <= N, i''_1 = i'' <= N suchthat defined(s[i'], s[i'']) && (pkgen(s[i']) = pk_S) && (pkgen(s[i'']) = pk_R) then
          find u = u_2 <= Qeperuser suchthat defined(info_5[u_2, i'_1], aad_8[u_2, i'_1], ct_8[u_2, i'_1], enc_4[u_2, i'_1], pk_2[u_2, i'_1]) && (pk_2[u_2, i'_1] = pk_R) && (enc_4[u_2, i'_1] = enc_star) && (ct_8[u_2, i'_1] = ciph_star) && (aad_8[u_2, i'_1] = aad_star) && (info_5[u_2, i'_1] = info_star) then
            return(bottom)
          else
            find u_4 = ri <= Qeperuser suchthat defined(part1_7[ri, i'_1], info_5[ri, i'_1], ce_2[ri, i'_1], u_8[ri, i'_1]) && (i''_1 = u_8[ri, i'_1]) && (ce_2[ri, i'_1] = enc_star) then
 {716}        find [unique]  suchthat defined(m[u_4, i'_1], aad_8[u_4, i'_1], part1_7[u_4, i'_1], r_14[u_4, i'_1]) && {725}((info_star = info_5[u_4, i'_1]) && (r_14[u_4, i'_1] = ciph_star) && (aad_8[u_4, i'_1] = aad_star)) then
                event_abort adv_wins
              orfind u_27 = ri_25 <= Qdperuser, u_28 = ri_26 <= N suchthat defined(part1_6[ri_25, ri_26], info_6[ri_25, ri_26], u_7[ri_25, ri_26], u_6[ri_25, ri_26]) && (u_6[ri_25, ri_26] = u_4) && (u_7[ri_25, ri_26] = i'_1) && (info_star = info_6[ri_25, ri_26]) then
                return(bottom)
              else
 {772}          if info_star = info_5[u_4, i'_1] then
                  return(bottom)
                else
 {782}            part2_2 <-R nonce_t;
 {783}            part1_2 <-R key_t;
                  return(bottom)
            else
              find u_13 = ri_9 <= Qdperuser suchthat defined(part1_3[ri_9, i''_1], info_6[ri_9, i''_1], enc_7[ri_9, i''_1], u_22[ri_9, i''_1]) && (u_22[ri_9, i''_1] = i'_1) && (enc_7[ri_9, i''_1] = enc_star) then
                find [unique]  suchthat info_star = info_6[u_13, i''_1] then
                  return(bottom)
                orfind u_25 = ri_21 <= Qdperuser suchthat defined(part1_5[ri_21, i''_1], info_6[ri_21, i''_1], u_20[ri_21, i''_1]) && (u_20[ri_21, i''_1] = u_13) && (info_star = info_6[ri_21, i''_1]) then
                  return(bottom)
                else
                  part1_1: key_t <- cst_key_t;
                  return(bottom)
              else
                let AuthDecap_Some(k0_1: kemkey_t) = AuthDecap(enc_star, skgen(s[i''_1]), pk_S) in
                  part1: key_t <- cst_key_t;
                  return(bottom)
                else
                  return(bottom)
        else
          return(bottom)
      ))


Applying simplify [probability N^2 * P_pk_coll]
  - Simplification pass
    - Transformed find at 772 into a test
    - Transform unused random number generation at 783 into constant assignment
    - Remove random number generation at 782
    - Replaced ((info_star = info_5[u_4, i'_1]) && (r_14[u_4, i'_1] = ciph_star) && (aad_8[u_4, i'_1] = aad_star)) with false at 725
    - Remove branch 1 in find at 716
    - Transformed find at 326 into a test
    - Transform unused random number generation at 344 into constant assignment
    - Remove random number generation at 343
    - Replaced defined condition m[u_6, u_7], aad_8[u_6, u_7], part1_7[u_6, u_7], r_14[u_6, u_7] with an empty condition in find at 196
    - Replaced defined condition part1_7[ri_2, ri_3], info_5[ri_2, ri_3], ce_2[ri_2, ri_3], s[ri_3], u_8[ri_2, ri_3] with m[ri_2, ri_3], aad_8[ri_2, ri_3], r_14[ri_2, ri_3], info_5[ri_2, ri_3], ce_2[ri_2, ri_3], s[ri_3], u_8[ri_2, ri_3] in find at 165
yields

Game 50 is
      ((
        foreach i <= N do
        Osetup() :=
        s <-R keypairseed_t;
        return(pkgen(s));
        ((
          foreach iae <= Qeperuser do
          Oaenc(pk_2: pkey_t, m: bitstring, aad_8: bitstring, info_5: bitstring) :=
          find u_8 = ri_4 <= N suchthat defined(s[ri_4]) && (pk_2 = pkgen(s[ri_4])) then
            k_3 <-R kemseed_t;
            sk_2: skey_t <- skgen(s);
            ce_2: kemciph_t <- AuthEncap_enc_r(k_3, pk_2, sk_2);
            enc_4: kemciph_t <- ce_2;
            part2_7 <-R nonce_t;
            part1_7 <-R key_t;
            r_14: bitstring <- Seal_inner(m, aad_8, part1_7, part2_7);
            ct_8: bitstring <- r_14;
            return(SealAuth_Some(ce_2, r_14))
          else
            k_2 <-R kemseed_t;
            sk_1: skey_t <- skgen(s);
            ce_1: kemciph_t <- AuthEncap_enc_r(k_2, pk_2, sk_1);
            k_5: kemkey_t <- AuthEncap_key_r(k_2, pk_2, sk_1);
            enc_4: kemciph_t <- ce_1;
            r_3: keys_t <- KeySchedule_auth(k_5, info_5);
            nonce_6: nonce_t <- get2(r_3);
            key_6: key_t <- get1(r_3);
            ct_8: bitstring <- Seal_inner(m, aad_8, key_6, nonce_6);
            return(SealAuth_Some(ce_1, ct_8))
        ) | (
          foreach iad <= Qdperuser do
          Oadec(pk_3: pkey_t, enc_7: kemciph_t, c: bitstring, aad_9: bitstring, info_6: bitstring) :=
          find u_6 = ri_2 <= Qeperuser, u_7 = ri_3 <= N suchthat defined(m[ri_2, ri_3], aad_8[ri_2, ri_3], r_14[ri_2, ri_3], info_5[ri_2, ri_3], ce_2[ri_2, ri_3], s[ri_3], u_8[ri_2, ri_3]) && (i = u_8[ri_2, ri_3]) && (pkgen(s[ri_3]) = pk_3) && (ce_2[ri_2, ri_3] = enc_7) then
            find [unique]  suchthat (info_6 = info_5[u_6, u_7]) && (r_14[u_6, u_7] = c) && (aad_8[u_6, u_7] = aad_9) then
              return(OpenAuth_Some(Context_Open_Some(m[u_6, u_7])))
            orfind u_35 = ri_39 <= Qdperuser suchthat defined(part1_6[ri_39], info_6[ri_39], u_7[ri_39], u_6[ri_39]) && (u_6[ri_39] = u_6) && (u_7[ri_39] = u_7) && (info_6 = info_6[ri_39]) then
              return(OpenAuth_Some(Context_Open_None))
            orfind  suchthat defined(part1_2, info_star, i'_1, u_4) && (u_4 = u_6) && (i'_1 = u_7) && (info_6 = info_star) then
              return(OpenAuth_Some(Context_Open_None))
            else
              if info_6 = info_5[u_6, u_7] then
                return(OpenAuth_Some(Context_Open_None))
              else
                part1_6: key_t <- cst_key_t;
                return(OpenAuth_Some(Context_Open_None))
          else
            find u_20 = ri_16 <= Qdperuser suchthat defined(part1_3[ri_16], info_6[ri_16], enc_7[ri_16], pk_3[ri_16]) && (pk_3[ri_16] = pk_3) && (enc_7[ri_16] = enc_7) then
              find [unique]  suchthat info_6 = info_6[u_20] then
                return(OpenAuth_Some(Context_Open_None))
              orfind u_31 = ri_33 <= Qdperuser suchthat defined(part1_5[ri_33], info_6[ri_33], u_20[ri_33]) && (u_20[ri_33] = u_20) && (info_6 = info_6[ri_33]) then
                return(OpenAuth_Some(Context_Open_None))
              orfind  suchthat defined(part1_1, info_star, i''_1, u_13) && (u_13 = u_20) && (i''_1 = i) && (info_6 = info_star) then
                return(OpenAuth_Some(Context_Open_None))
              else
                part1_5: key_t <- cst_key_t;
                return(OpenAuth_Some(Context_Open_None))
            orfind  suchthat defined(part1, info_star, enc_star, pk_S, i''_1) && (i = i''_1) && (pk_S = pk_3) && (enc_star = enc_7) then
              find [unique] u_33 = ri_37 <= Qdperuser suchthat defined(part2_4[ri_37], part1_4[ri_37], info_6[ri_37]) && (info_6 = info_6[ri_37]) then
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, part1_4[u_33], part2_4[u_33]) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
              orfind  suchthat info_6 = info_star then
                return(OpenAuth_Some(Context_Open_None))
              else
                part2_4 <-R nonce_t;
                part1_4 <-R key_t;
                let injbot(pt_6: bitstring) = Open_inner(c, aad_9, part1_4, part2_4) in
                  return(OpenAuth_Some(Context_Open_Some(pt_6)))
                else
                  return(OpenAuth_Some(Context_Open_None))
            else
              find u_22 = ri_18 <= N suchthat defined(s[ri_18]) && (pk_3 = pkgen(s[ri_18])) then
                let AuthDecap_Some(k0: kemkey_t) = AuthDecap(enc_7, skgen(s), pk_3) in
                  part1_3: key_t <- cst_key_t;
                  return(OpenAuth_Some(Context_Open_None))
                else
                  return(OpenAuth_None)
              else
                let AuthDecap_Some(shared_secret_4: kemkey_t) = AuthDecap(enc_7, skgen(s), pk_3) in
                  r_4: keys_t <- KeySchedule_auth(shared_secret_4, info_6);
                  nonce_9: nonce_t <- get2(r_4);
                  key_8: key_t <- get1(r_4);
                  let injbot(pt_6: bitstring) = Open_inner(c, aad_9, key_8, nonce_9) in
                    return(OpenAuth_Some(Context_Open_Some(pt_6)))
                  else
                    return(OpenAuth_Some(Context_Open_None))
                else
                  return(OpenAuth_None)
        ))
      ) | (
        Ochall(pk_S: pkey_t, pk_R: pkey_t, enc_star: kemciph_t, ciph_star: bitstring, aad_star: bitstring, info_star: bitstring) :=
        find i'_1 = i' <= N, i''_1 = i'' <= N suchthat defined(s[i'], s[i'']) && (pkgen(s[i']) = pk_S) && (pkgen(s[i'']) = pk_R) then
          find u = u_2 <= Qeperuser suchthat defined(info_5[u_2, i'_1], aad_8[u_2, i'_1], ct_8[u_2, i'_1], enc_4[u_2, i'_1], pk_2[u_2, i'_1]) && (pk_2[u_2, i'_1] = pk_R) && (enc_4[u_2, i'_1] = enc_star) && (ct_8[u_2, i'_1] = ciph_star) && (aad_8[u_2, i'_1] = aad_star) && (info_5[u_2, i'_1] = info_star) then
            return(bottom)
          else
            find u_4 = ri <= Qeperuser suchthat defined(part1_7[ri, i'_1], info_5[ri, i'_1], ce_2[ri, i'_1], u_8[ri, i'_1]) && (i''_1 = u_8[ri, i'_1]) && (ce_2[ri, i'_1] = enc_star) then
              find [unique] u_27 = ri_25 <= Qdperuser, u_28 = ri_26 <= N suchthat defined(part1_6[ri_25, ri_26], info_6[ri_25, ri_26], u_7[ri_25, ri_26], u_6[ri_25, ri_26]) && (u_6[ri_25, ri_26] = u_4) && (u_7[ri_25, ri_26] = i'_1) && (info_star = info_6[ri_25, ri_26]) then
                return(bottom)
              else
                if info_star = info_5[u_4, i'_1] then
                  return(bottom)
                else
                  part1_2: key_t <- cst_key_t;
                  return(bottom)
            else
              find u_13 = ri_9 <= Qdperuser suchthat defined(part1_3[ri_9, i''_1], info_6[ri_9, i''_1], enc_7[ri_9, i''_1], u_22[ri_9, i''_1]) && (u_22[ri_9, i''_1] = i'_1) && (enc_7[ri_9, i''_1] = enc_star) then
                find [unique]  suchthat info_star = info_6[u_13, i''_1] then
                  return(bottom)
                orfind u_25 = ri_21 <= Qdperuser suchthat defined(part1_5[ri_21, i''_1], info_6[ri_21, i''_1], u_20[ri_21, i''_1]) && (u_20[ri_21, i''_1] = u_13) && (info_star = info_6[ri_21, i''_1]) then
                  return(bottom)
                else
                  part1_1: key_t <- cst_key_t;
                  return(bottom)
              else
                let AuthDecap_Some(k0_1: kemkey_t) = AuthDecap(enc_star, skgen(s[i''_1]), pk_S) in
                  part1: key_t <- cst_key_t;
                  return(bottom)
                else
                  return(bottom)
        else
          return(bottom)
      ))


Proved event(adv_wins) ==> false in game 50
Adv[Game 1: event(adv_wins) ==> false] <= Adv_ctxt(time_4, 1 + #Oadec + #Oaenc, 1 + Qdperuser + #Oadec) + Adv_PRF_KeySchedule(time_3, 1 + #Oadec + #Oaenc, 1 + Qdperuser + #Oadec + #Oaenc) + (#Oaenc * N + 11 * N^2) * P_pk_coll + Adv_Outsider_Auth(time_2, N, #Oaenc, 1 + #Oadec) + Adv_Outsider_CCA(time_1, N, #Oaenc, 1 + #Oadec) + Adv[Game 50: event(adv_wins) ==> false]
Adv[Game 50: event(adv_wins) ==> false] <= 0
RESULT Proved event(adv_wins) ==> false up to probability Adv_ctxt(time_4, 1 + #Oadec + #Oaenc, 1 + Qdperuser + #Oadec) + Adv_PRF_KeySchedule(time_3, 1 + #Oadec + #Oaenc, 1 + Qdperuser + #Oadec + #Oaenc) + (#Oaenc * N + 11 * N^2) * P_pk_coll + Adv_Outsider_Auth(time_2, N, #Oaenc, 1 + #Oadec) + Adv_Outsider_CCA(time_1, N, #Oaenc, 1 + #Oadec)
RESULT time_1 = time + time(context for game 10) = #Oaenc * time(let AuthEncap_tuple) + #Oaenc * time(KeySchedule_auth, maxlength(game 10: info_5)) + (#Oaenc + #Oadec + 1) * time(get2) + (#Oaenc + #Oadec + 1) * time(get1) + #Oaenc * time(Seal_inner, maxlength(game 10: m), maxlength(game 10: aad_8)) + #Oaenc * time(SealAuth_Some, maxlength(game 10: ct_8)) + (#Oadec + 1) * time(let AuthDecap_Some) + #Oadec * time(KeySchedule_auth, maxlength(game 10: info_6)) + #Oadec * time(Open_inner, maxlength(game 10: c), maxlength(game 10: aad_9)) + #Oadec * time(let injbot, maxlength(game 10: pt_6)) + #Oadec * time(OpenAuth_Some, length(Context_Open_Some, maxlength(game 10: pt_6))) + #Oadec * time(Context_Open_Some, maxlength(game 10: pt_6)) + #Oadec * time(OpenAuth_Some, length(Context_Open_None)) + Qeperuser * time(= bitstring, maxlength(game 10: ct_8), maxlength(game 10: ciph_star)) + Qeperuser * time(= bitstring, maxlength(game 10: aad_8), maxlength(game 10: aad_star)) + Qeperuser * time(= bitstring, maxlength(game 10: info_5), maxlength(game 10: info_star)) + time(KeySchedule_auth, maxlength(game 10: info_star)) + time(Open_inner, maxlength(game 10: ciph_star), maxlength(game 10: aad_star)) + time(let injbot, maxlength(game 10: pt_7)) + time
RESULT time_2 = time + time(context for game 17) = 2 * #Oaenc * time(let AuthEncap_tuple) + #Oaenc * time(KeySchedule_auth, maxlength(game 17: info_5)) + (#Oaenc + #Oadec + 1) * time(get2) + (#Oaenc + #Oadec + 1) * time(get1) + #Oaenc * time(Seal_inner, maxlength(game 17: m), maxlength(game 17: aad_8)) + #Oaenc * time(SealAuth_Some, maxlength(game 17: ct_8)) + (#Oadec + 1) * time(let AuthDecap_Some) + #Oadec * time(KeySchedule_auth, maxlength(game 17: info_6)) + #Oadec * time(Open_inner, maxlength(game 17: c), maxlength(game 17: aad_9)) + #Oadec * time(let injbot, maxlength(game 17: pt_6)) + #Oadec * time(OpenAuth_Some, length(Context_Open_Some, maxlength(game 17: pt_6))) + #Oadec * time(Context_Open_Some, maxlength(game 17: pt_6)) + #Oadec * time(OpenAuth_Some, length(Context_Open_None)) + Qeperuser * time(= bitstring, maxlength(game 17: ct_8), maxlength(game 17: ciph_star)) + Qeperuser * time(= bitstring, maxlength(game 17: aad_8), maxlength(game 17: aad_star)) + Qeperuser * time(= bitstring, maxlength(game 17: info_5), maxlength(game 17: info_star)) + time(KeySchedule_auth, maxlength(game 17: info_star)) + time(Open_inner, maxlength(game 17: ciph_star), maxlength(game 17: aad_star)) + time(let injbot, maxlength(game 17: pt_7)) + time
RESULT time_3 = time + time(context for game 27) = (N + #Oaenc * N + #Oadec * #Oaenc + #Oadec * N + 2 * N^2) * time(pkgen) + (#Oaenc + #Oadec + 1) * time(skgen) + #Oaenc * time(AuthEncap_enc_r) + #Oaenc * time(AuthEncap_key_r) + #Oaenc * time(KeySchedule_auth, maxlength(game 27: info_5)) + (#Oaenc + #Oadec + 1) * time(get2) + (#Oaenc + #Oadec + 1) * time(get1) + #Oaenc * time(Seal_inner, maxlength(game 27: m), maxlength(game 27: aad_8)) + #Oaenc * time(SealAuth_Some, maxlength(game 27: ct_8)) + (#Oadec + 1) * time(AuthDecap) + (#Oadec + 1) * time(let AuthDecap_Some) + #Oadec * time(KeySchedule_auth, maxlength(game 27: info_6)) + #Oadec * time(Open_inner, maxlength(game 27: c), maxlength(game 27: aad_9)) + #Oadec * time(let injbot, maxlength(game 27: pt_6)) + #Oadec * time(OpenAuth_Some, length(Context_Open_Some, maxlength(game 27: pt_6))) + #Oadec * time(Context_Open_Some, maxlength(game 27: pt_6)) + #Oadec * time(OpenAuth_Some, length(Context_Open_None)) + Qeperuser * time(= bitstring, maxlength(game 27: ct_8), maxlength(game 27: ciph_star)) + Qeperuser * time(= bitstring, maxlength(game 27: aad_8), maxlength(game 27: aad_star)) + Qeperuser * time(= bitstring, maxlength(game 27: info_5), maxlength(game 27: info_star)) + time(Open_inner, maxlength(game 27: ciph_star), maxlength(game 27: aad_star)) + time(let injbot, maxlength(game 27: pt_7)) + time
RESULT time_4 = time + time(context for game 44) = (N + #Oaenc * N + #Oadec * #Oaenc + #Oadec * N + 2 * N^2) * time(pkgen) + (#Oaenc + #Oadec + 1) * time(skgen) + #Oaenc * time(AuthEncap_enc_r) + #Oaenc * time(AuthEncap_key_r) + #Oaenc * time(KeySchedule_auth, maxlength(game 44: info_5)) + (#Oaenc + #Oadec) * time(get2) + (#Oaenc + #Oadec) * time(get1) + #Oaenc * time(Seal_inner, maxlength(game 44: m), maxlength(game 44: aad_8)) + #Oaenc * time(SealAuth_Some, maxlength(game 44: ct_8)) + #Oadec * time(= bitstring, maxlength(game 44: info_6), maxlength(game 44: info_5)) + (#Oadec + #Oadec * Qdperuser) * time(= bitstring, maxlength(game 44: info_6), maxlength(game 44: info_6)) + #Oadec * time(= bitstring, maxlength(game 44: info_6), maxlength(game 44: info_star)) + (#Oadec + 1) * time(AuthDecap) + (#Oadec + 1) * time(let AuthDecap_Some) + #Oadec * time(KeySchedule_auth, maxlength(game 44: info_6)) + #Oadec * time(Open_inner, maxlength(game 44: c), maxlength(game 44: aad_9)) + #Oadec * time(let injbot, maxlength(game 44: pt_6)) + #Oadec * time(OpenAuth_Some, length(Context_Open_Some, maxlength(game 44: pt_6))) + #Oadec * time(Context_Open_Some, maxlength(game 44: pt_6)) + #Oadec * time(OpenAuth_Some, length(Context_Open_None)) + Qeperuser * time(= bitstring, maxlength(game 44: ct_8), maxlength(game 44: ciph_star)) + Qeperuser * time(= bitstring, maxlength(game 44: aad_8), maxlength(game 44: aad_star)) + Qeperuser * time(= bitstring, maxlength(game 44: info_5), maxlength(game 44: info_star)) + time(= bitstring, maxlength(game 44: info_star), maxlength(game 44: info_5)) + (#Oadec + 1 + Qdperuser) * time(= bitstring, maxlength(game 44: info_star), maxlength(game 44: info_6)) + time(let injbot, maxlength(game 44: pt_7)) + time
All queries proved.
